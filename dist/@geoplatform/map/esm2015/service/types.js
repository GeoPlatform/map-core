/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import * as jquery from "jquery";
/** @type {?} */
const jQuery = jquery;
import { ItemService, JQueryHttpClient, QueryFactory, Config } from 'geoplatform.client';
/** @type {?} */
const ogcExpr = /OGC.+\(([A-Z\-]+)\)/;
/** @type {?} */
const esriExpr = /Esri REST ([A-Za-z]+) Service/;
/** @type {?} */
const keyFn = (expr, str) => {
    /** @type {?} */
    let m = expr.exec(str);
    return (m && m.length) ? m[1] : null;
};
const ɵ0 = keyFn;
/** @type {?} */
var types = {
    ESRI_FEATURE_SERVER: {
        "id": "48980c5bad0c8d4666b393874eb5279a",
        "uri": "http://www.geoplatform.gov/spec/esri-feature-rest",
        "type": "dct:Standard",
        "description": "Esri ArcGIS Feature Server REST API",
        "label": "Esri REST Feature Service"
    },
    ESRI_IMAGE_SERVER: {
        "id": "bcdf764e52064c84323f3f1baea7e245",
        "uri": "http://www.geoplatform.gov/spec/esri-image-rest",
        "type": "dct:Standard",
        "description": "Esri ArcGIS Image Server REST API",
        "label": "Esri REST Image Service"
    },
    ESRI_MAP_SERVER: {
        "id": "370cf6ca5d91c07b63329b8384fe76c7",
        "uri": "http://www.geoplatform.gov/spec/esri-map-rest",
        "type": "dct:Standard",
        "description": "Esri ArcGIS Map Server REST API",
        "label": "Esri REST Map Service"
    },
    ESRI_TILE_SERVER: {
        "id": "c75570ff2523b1a1631afe7ddac27beb",
        "uri": "http://www.geoplatform.gov/spec/esri-tile-rest",
        "type": "dct:Standard",
        "description": "Esri ArcGIS Tile Server REST API",
        "label": "Esri REST Tile Service"
    },
    KML: {
        "id": "c0b39ca2049ba2184472ff27408ffd7e",
        "uri": "http://opengis.net/spec/kml",
        "type": "dct:Standard",
        "description": "OGC Keyhole Markup Language (KML)",
        "label": "OGC Keyhole Markup Language (KML)"
    },
    CSW: {
        "id": "60de6a422475493b7901ae453d6f4562",
        "uri": "http://opengis.net/spec/csw",
        "type": "dct:Standard",
        "description": "OGC Web Catalog Service (CSW)",
        "label": "OGC Web Catalog Service (CSW)"
    },
    WCS: {
        "id": "a7e5a2d81a83d4eae9bf9138f24d0a32",
        "uri": "http://opengis.net/spec/wcs",
        "type": "dct:Standard",
        "description": "OGC Web Coverage Service (WCS)",
        "label": "OGC Web Coverage Service (WCS)"
    },
    WFS: {
        "id": "e70e43ed52f83634285a09e959734bff",
        "uri": "http://opengis.net/spec/wfs",
        "type": "dct:Standard",
        "description": "OGC Web Feature Service (WFS)",
        "label": "OGC Web Feature Service (WFS)"
    },
    WMS: {
        "id": "abed5a00c536fb2d7019092c37ed634c",
        "uri": "http://opengis.net/spec/wms",
        "type": "dct:Standard",
        "description": "OGC Web Map Service (WMS)",
        "label": "OGC Web Map Service (WMS)"
    },
    WMTS: {
        "id": "757858ae77cf8c602b39294c27632dd7",
        "uri": "http://opengis.net/spec/wmts",
        "type": "dct:Standard",
        "description": "OGC Web Map Tile Service (WMTS)",
        "label": "OGC Web Map Tile Service (WMTS)"
    },
    WMST: {
        "id": "faae5bff49b1144d500380cbc055c1e5",
        "uri": "http://www.geoplatform.gov/spec/ogc-wms-t",
        "type": "dct:Standard",
        "description": "OGC WMS support for temporal according to OGC Best Practice guidance",
        "label": "OGC WMS-T Service"
    },
    FEED: {
        "id": "8edc61870e534a1f23dc967753da3b72",
        "uri": "http://www.geoplatform.gov/spec/feed",
        "type": "dct:Standard",
        "description": "GeoPlatform GeoJSON Feed Service converts an Atom/RSS feed (including GeoRSS and CAP extensions) to GeoJSON",
        "label": "GeoPlatform GeoJSON Feed Service"
    },
    //
    //method to allow refreshing list later
    refresh: updateList
};
/**
 * @param {?} service
 * @return {?}
 */
function updateList(service) {
    /** @type {?} */
    let url = Config.ualUrl;
    if (!url) {
        console.log("WARN : ServiceTypes - no GeoPlatform API URL configured, unable to load service types");
    }
    else {
        /** @type {?} */
        let query = QueryFactory()
            .types('dct:Standard')
            .resourceTypes('ServiceType')
            .pageSize(50);
        /** @type {?} */
        let svc = null;
        //if a service was provided to be used, use it
        if (service && typeof (service.search) !== 'undefined') {
            svc = service;
        }
        else { // otherwise, use defaults
            // otherwise, use defaults
            svc = new ItemService(url, new JQueryHttpClient());
        }
        svc.search(query).then(data => {
            for (let i = 0; i < data.results.length; ++i) {
                /** @type {?} */
                let type = data.results[i];
                /** @type {?} */
                let key = null;
                /** @type {?} */
                let label = type.label;
                if (~label.indexOf("WMS-T")) {
                    key = 'WMST';
                    type.supported = true;
                }
                else if (~label.indexOf('OGC')) {
                    key = keyFn(ogcExpr, label);
                    type.supported = 'WMS' === key || 'WMTS' === key;
                }
                else if (~label.indexOf('Esri')) {
                    key = keyFn(esriExpr, label);
                    type.supported = true;
                    key = 'ESRI_' + key.toUpperCase() + '_SERVER';
                }
                else if (~label.indexOf("Feed")) {
                    key = "FEED";
                    type.supported = true;
                }
                else {
                    key = label;
                }
                types[key] = type;
            }
            // console.log(types);
        })
            .catch(error => {
            console.log("Error loading supported service types: " + error.message);
        });
    }
}
export default types;
export { ɵ0 };

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZXMuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZ2VvcGxhdGZvcm0vbWFwLyIsInNvdXJjZXMiOlsic2VydmljZS90eXBlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsT0FBTyxLQUFLLE1BQU0sTUFBTSxRQUFRLENBQUM7O0FBQ2pDLE1BQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQztBQUd0QixPQUFPLEVBQ0gsV0FBVyxFQUFFLGdCQUFnQixFQUFFLFlBQVksRUFBRSxNQUFNLEVBQ3RELE1BQU0sb0JBQW9CLENBQUM7O0FBSTVCLE1BQU0sT0FBTyxHQUFHLHFCQUFxQixDQUFDOztBQUN0QyxNQUFNLFFBQVEsR0FBRywrQkFBK0IsQ0FBQzs7QUFDakQsTUFBTSxLQUFLLEdBQUcsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLEVBQUU7O0lBQ3hCLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDdkIsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0NBQ3hDLENBQUM7OztBQUVGLElBQUksS0FBSyxHQUFHO0lBRVIsbUJBQW1CLEVBQUU7UUFDakIsSUFBSSxFQUFDLGtDQUFrQztRQUN2QyxLQUFLLEVBQUMsbURBQW1EO1FBQ3pELE1BQU0sRUFBQyxjQUFjO1FBQ3JCLGFBQWEsRUFBQyxxQ0FBcUM7UUFDbkQsT0FBTyxFQUFDLDJCQUEyQjtLQUN0QztJQUVELGlCQUFpQixFQUFFO1FBQ2YsSUFBSSxFQUFDLGtDQUFrQztRQUN2QyxLQUFLLEVBQUMsaURBQWlEO1FBQ3ZELE1BQU0sRUFBQyxjQUFjO1FBQ3JCLGFBQWEsRUFBQyxtQ0FBbUM7UUFDakQsT0FBTyxFQUFDLHlCQUF5QjtLQUNwQztJQUVELGVBQWUsRUFBRTtRQUNiLElBQUksRUFBQyxrQ0FBa0M7UUFDdkMsS0FBSyxFQUFDLCtDQUErQztRQUNyRCxNQUFNLEVBQUMsY0FBYztRQUNyQixhQUFhLEVBQUMsaUNBQWlDO1FBQy9DLE9BQU8sRUFBQyx1QkFBdUI7S0FDbEM7SUFFRCxnQkFBZ0IsRUFBRTtRQUNkLElBQUksRUFBRSxrQ0FBa0M7UUFDeEMsS0FBSyxFQUFFLGdEQUFnRDtRQUN2RCxNQUFNLEVBQUUsY0FBYztRQUN0QixhQUFhLEVBQUUsa0NBQWtDO1FBQ2pELE9BQU8sRUFBRSx3QkFBd0I7S0FDcEM7SUFFRCxHQUFHLEVBQUU7UUFDRCxJQUFJLEVBQUMsa0NBQWtDO1FBQ3ZDLEtBQUssRUFBQyw2QkFBNkI7UUFDbkMsTUFBTSxFQUFDLGNBQWM7UUFDckIsYUFBYSxFQUFDLG1DQUFtQztRQUNqRCxPQUFPLEVBQUMsbUNBQW1DO0tBQzlDO0lBRUQsR0FBRyxFQUFFO1FBQ0QsSUFBSSxFQUFDLGtDQUFrQztRQUN2QyxLQUFLLEVBQUMsNkJBQTZCO1FBQ25DLE1BQU0sRUFBQyxjQUFjO1FBQ3JCLGFBQWEsRUFBQywrQkFBK0I7UUFDN0MsT0FBTyxFQUFDLCtCQUErQjtLQUMxQztJQUVELEdBQUcsRUFBRTtRQUNELElBQUksRUFBQyxrQ0FBa0M7UUFDdkMsS0FBSyxFQUFDLDZCQUE2QjtRQUNuQyxNQUFNLEVBQUMsY0FBYztRQUNyQixhQUFhLEVBQUMsZ0NBQWdDO1FBQzlDLE9BQU8sRUFBQyxnQ0FBZ0M7S0FDM0M7SUFFRCxHQUFHLEVBQUU7UUFDRCxJQUFJLEVBQUMsa0NBQWtDO1FBQ3ZDLEtBQUssRUFBQyw2QkFBNkI7UUFDbkMsTUFBTSxFQUFDLGNBQWM7UUFDckIsYUFBYSxFQUFDLCtCQUErQjtRQUM3QyxPQUFPLEVBQUMsK0JBQStCO0tBQzFDO0lBRUQsR0FBRyxFQUFFO1FBQ0QsSUFBSSxFQUFDLGtDQUFrQztRQUN2QyxLQUFLLEVBQUMsNkJBQTZCO1FBQ25DLE1BQU0sRUFBQyxjQUFjO1FBQ3JCLGFBQWEsRUFBQywyQkFBMkI7UUFDekMsT0FBTyxFQUFDLDJCQUEyQjtLQUN0QztJQUVELElBQUksRUFBRTtRQUNGLElBQUksRUFBQyxrQ0FBa0M7UUFDdkMsS0FBSyxFQUFDLDhCQUE4QjtRQUNwQyxNQUFNLEVBQUMsY0FBYztRQUNyQixhQUFhLEVBQUMsaUNBQWlDO1FBQy9DLE9BQU8sRUFBQyxpQ0FBaUM7S0FDNUM7SUFFRCxJQUFJLEVBQUU7UUFDRixJQUFJLEVBQUUsa0NBQWtDO1FBQ3hDLEtBQUssRUFBRSwyQ0FBMkM7UUFDbEQsTUFBTSxFQUFFLGNBQWM7UUFDdEIsYUFBYSxFQUFFLHNFQUFzRTtRQUNyRixPQUFPLEVBQUUsbUJBQW1CO0tBQy9CO0lBRUQsSUFBSSxFQUFFO1FBQ0YsSUFBSSxFQUFFLGtDQUFrQztRQUN4QyxLQUFLLEVBQUUsc0NBQXNDO1FBQzdDLE1BQU0sRUFBRSxjQUFjO1FBQ3RCLGFBQWEsRUFBRSw2R0FBNkc7UUFDNUgsT0FBTyxFQUFFLGtDQUFrQztLQUM5Qzs7O0lBSUQsT0FBTyxFQUFFLFVBQVU7Q0FDdEIsQ0FBQzs7Ozs7QUFFRixvQkFBb0IsT0FBcUI7O0lBRXJDLElBQUksR0FBRyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7SUFDeEIsSUFBRyxDQUFDLEdBQUcsRUFBRTtRQUNMLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUZBQXVGLENBQUMsQ0FBQztLQUN4RztTQUFNOztRQUVILElBQUksS0FBSyxHQUFHLFlBQVksRUFBRTthQUNyQixLQUFLLENBQUMsY0FBYyxDQUFDO2FBQ3JCLGFBQWEsQ0FBQyxhQUFhLENBQUM7YUFDNUIsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDOztRQUdsQixJQUFJLEdBQUcsR0FBRyxJQUFJLENBQUM7O1FBRWYsSUFBRyxPQUFPLElBQUksT0FBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxXQUFXLEVBQUU7WUFDbEQsR0FBRyxHQUFHLE9BQU8sQ0FBQztTQUNqQjthQUFNLEVBQUUsMEJBQTBCOztZQUMvQixHQUFHLEdBQUcsSUFBSSxXQUFXLENBQUMsR0FBRyxFQUFFLElBQUksZ0JBQWdCLEVBQUUsQ0FBQyxDQUFDO1NBQ3REO1FBRUQsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUUsSUFBSSxDQUFDLEVBQUU7WUFFM0IsS0FBSSxJQUFJLENBQUMsR0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxFQUFFOztnQkFFckMsSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FFSDs7Z0JBRnZCLElBQ0ksR0FBRyxHQUFHLElBQUksQ0FDUzs7Z0JBRnZCLElBRUksS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7Z0JBRXZCLElBQUcsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFO29CQUN4QixHQUFHLEdBQUcsTUFBTSxDQUFDO29CQUNiLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO2lCQUV6QjtxQkFBTSxJQUFHLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtvQkFDN0IsR0FBRyxHQUFHLEtBQUssQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUM7b0JBQzVCLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxLQUFLLEdBQUcsSUFBSSxNQUFNLEtBQUssR0FBRyxDQUFDO2lCQUVwRDtxQkFBTSxJQUFHLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRTtvQkFDOUIsR0FBRyxHQUFHLEtBQUssQ0FBQyxRQUFRLEVBQUUsS0FBSyxDQUFDLENBQUM7b0JBQzdCLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO29CQUN0QixHQUFHLEdBQUcsT0FBTyxHQUFHLEdBQUcsQ0FBQyxXQUFXLEVBQUUsR0FBRyxTQUFTLENBQUM7aUJBRWpEO3FCQUFNLElBQUcsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFO29CQUM5QixHQUFHLEdBQUcsTUFBTSxDQUFDO29CQUNiLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO2lCQUV6QjtxQkFBTTtvQkFDSCxHQUFHLEdBQUcsS0FBSyxDQUFDO2lCQUVmO2dCQUVELEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxJQUFJLENBQUM7YUFDckI7O1NBRUosQ0FBQzthQUNELEtBQUssQ0FBRSxLQUFLLENBQUMsRUFBRTtZQUNaLE9BQU8sQ0FBQyxHQUFHLENBQUMseUNBQXlDLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzFFLENBQUMsQ0FBQztLQUNOO0NBQ0o7QUFFRCxlQUFlLEtBQUssQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0ICogYXMganF1ZXJ5IGZyb20gXCJqcXVlcnlcIjtcbmNvbnN0IGpRdWVyeSA9IGpxdWVyeTtcblxuaW1wb3J0ICogYXMgUSBmcm9tIFwicVwiO1xuaW1wb3J0IHtcbiAgICBJdGVtU2VydmljZSwgSlF1ZXJ5SHR0cENsaWVudCwgUXVlcnlGYWN0b3J5LCBDb25maWdcbn0gZnJvbSAnZ2VvcGxhdGZvcm0uY2xpZW50JztcblxuXG5cbmNvbnN0IG9nY0V4cHIgPSAvT0dDLitcXCgoW0EtWlxcLV0rKVxcKS87XG5jb25zdCBlc3JpRXhwciA9IC9Fc3JpIFJFU1QgKFtBLVphLXpdKykgU2VydmljZS87XG5jb25zdCBrZXlGbiA9IChleHByLCBzdHIpID0+IHtcbiAgICBsZXQgbSA9IGV4cHIuZXhlYyhzdHIpO1xuICAgIHJldHVybiAobSAmJiBtLmxlbmd0aCkgPyBtWzFdIDogbnVsbDtcbn07XG5cbnZhciB0eXBlcyA9IHtcblxuICAgIEVTUklfRkVBVFVSRV9TRVJWRVI6IHtcbiAgICAgICAgXCJpZFwiOlwiNDg5ODBjNWJhZDBjOGQ0NjY2YjM5Mzg3NGViNTI3OWFcIixcbiAgICAgICAgXCJ1cmlcIjpcImh0dHA6Ly93d3cuZ2VvcGxhdGZvcm0uZ292L3NwZWMvZXNyaS1mZWF0dXJlLXJlc3RcIixcbiAgICAgICAgXCJ0eXBlXCI6XCJkY3Q6U3RhbmRhcmRcIixcbiAgICAgICAgXCJkZXNjcmlwdGlvblwiOlwiRXNyaSBBcmNHSVMgRmVhdHVyZSBTZXJ2ZXIgUkVTVCBBUElcIixcbiAgICAgICAgXCJsYWJlbFwiOlwiRXNyaSBSRVNUIEZlYXR1cmUgU2VydmljZVwiXG4gICAgfSxcblxuICAgIEVTUklfSU1BR0VfU0VSVkVSOiB7XG4gICAgICAgIFwiaWRcIjpcImJjZGY3NjRlNTIwNjRjODQzMjNmM2YxYmFlYTdlMjQ1XCIsXG4gICAgICAgIFwidXJpXCI6XCJodHRwOi8vd3d3Lmdlb3BsYXRmb3JtLmdvdi9zcGVjL2VzcmktaW1hZ2UtcmVzdFwiLFxuICAgICAgICBcInR5cGVcIjpcImRjdDpTdGFuZGFyZFwiLFxuICAgICAgICBcImRlc2NyaXB0aW9uXCI6XCJFc3JpIEFyY0dJUyBJbWFnZSBTZXJ2ZXIgUkVTVCBBUElcIixcbiAgICAgICAgXCJsYWJlbFwiOlwiRXNyaSBSRVNUIEltYWdlIFNlcnZpY2VcIlxuICAgIH0sXG5cbiAgICBFU1JJX01BUF9TRVJWRVI6IHtcbiAgICAgICAgXCJpZFwiOlwiMzcwY2Y2Y2E1ZDkxYzA3YjYzMzI5YjgzODRmZTc2YzdcIixcbiAgICAgICAgXCJ1cmlcIjpcImh0dHA6Ly93d3cuZ2VvcGxhdGZvcm0uZ292L3NwZWMvZXNyaS1tYXAtcmVzdFwiLFxuICAgICAgICBcInR5cGVcIjpcImRjdDpTdGFuZGFyZFwiLFxuICAgICAgICBcImRlc2NyaXB0aW9uXCI6XCJFc3JpIEFyY0dJUyBNYXAgU2VydmVyIFJFU1QgQVBJXCIsXG4gICAgICAgIFwibGFiZWxcIjpcIkVzcmkgUkVTVCBNYXAgU2VydmljZVwiXG4gICAgfSxcblxuICAgIEVTUklfVElMRV9TRVJWRVI6IHtcbiAgICAgICAgXCJpZFwiOiBcImM3NTU3MGZmMjUyM2IxYTE2MzFhZmU3ZGRhYzI3YmViXCIsXG4gICAgICAgIFwidXJpXCI6IFwiaHR0cDovL3d3dy5nZW9wbGF0Zm9ybS5nb3Yvc3BlYy9lc3JpLXRpbGUtcmVzdFwiLFxuICAgICAgICBcInR5cGVcIjogXCJkY3Q6U3RhbmRhcmRcIixcbiAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcIkVzcmkgQXJjR0lTIFRpbGUgU2VydmVyIFJFU1QgQVBJXCIsXG4gICAgICAgIFwibGFiZWxcIjogXCJFc3JpIFJFU1QgVGlsZSBTZXJ2aWNlXCJcbiAgICB9LFxuXG4gICAgS01MOiB7XG4gICAgICAgIFwiaWRcIjpcImMwYjM5Y2EyMDQ5YmEyMTg0NDcyZmYyNzQwOGZmZDdlXCIsXG4gICAgICAgIFwidXJpXCI6XCJodHRwOi8vb3Blbmdpcy5uZXQvc3BlYy9rbWxcIixcbiAgICAgICAgXCJ0eXBlXCI6XCJkY3Q6U3RhbmRhcmRcIixcbiAgICAgICAgXCJkZXNjcmlwdGlvblwiOlwiT0dDIEtleWhvbGUgTWFya3VwIExhbmd1YWdlIChLTUwpXCIsXG4gICAgICAgIFwibGFiZWxcIjpcIk9HQyBLZXlob2xlIE1hcmt1cCBMYW5ndWFnZSAoS01MKVwiXG4gICAgfSxcblxuICAgIENTVzoge1xuICAgICAgICBcImlkXCI6XCI2MGRlNmE0MjI0NzU0OTNiNzkwMWFlNDUzZDZmNDU2MlwiLFxuICAgICAgICBcInVyaVwiOlwiaHR0cDovL29wZW5naXMubmV0L3NwZWMvY3N3XCIsXG4gICAgICAgIFwidHlwZVwiOlwiZGN0OlN0YW5kYXJkXCIsXG4gICAgICAgIFwiZGVzY3JpcHRpb25cIjpcIk9HQyBXZWIgQ2F0YWxvZyBTZXJ2aWNlIChDU1cpXCIsXG4gICAgICAgIFwibGFiZWxcIjpcIk9HQyBXZWIgQ2F0YWxvZyBTZXJ2aWNlIChDU1cpXCJcbiAgICB9LFxuXG4gICAgV0NTOiB7XG4gICAgICAgIFwiaWRcIjpcImE3ZTVhMmQ4MWE4M2Q0ZWFlOWJmOTEzOGYyNGQwYTMyXCIsXG4gICAgICAgIFwidXJpXCI6XCJodHRwOi8vb3Blbmdpcy5uZXQvc3BlYy93Y3NcIixcbiAgICAgICAgXCJ0eXBlXCI6XCJkY3Q6U3RhbmRhcmRcIixcbiAgICAgICAgXCJkZXNjcmlwdGlvblwiOlwiT0dDIFdlYiBDb3ZlcmFnZSBTZXJ2aWNlIChXQ1MpXCIsXG4gICAgICAgIFwibGFiZWxcIjpcIk9HQyBXZWIgQ292ZXJhZ2UgU2VydmljZSAoV0NTKVwiXG4gICAgfSxcblxuICAgIFdGUzoge1xuICAgICAgICBcImlkXCI6XCJlNzBlNDNlZDUyZjgzNjM0Mjg1YTA5ZTk1OTczNGJmZlwiLFxuICAgICAgICBcInVyaVwiOlwiaHR0cDovL29wZW5naXMubmV0L3NwZWMvd2ZzXCIsXG4gICAgICAgIFwidHlwZVwiOlwiZGN0OlN0YW5kYXJkXCIsXG4gICAgICAgIFwiZGVzY3JpcHRpb25cIjpcIk9HQyBXZWIgRmVhdHVyZSBTZXJ2aWNlIChXRlMpXCIsXG4gICAgICAgIFwibGFiZWxcIjpcIk9HQyBXZWIgRmVhdHVyZSBTZXJ2aWNlIChXRlMpXCJcbiAgICB9LFxuXG4gICAgV01TOiB7XG4gICAgICAgIFwiaWRcIjpcImFiZWQ1YTAwYzUzNmZiMmQ3MDE5MDkyYzM3ZWQ2MzRjXCIsXG4gICAgICAgIFwidXJpXCI6XCJodHRwOi8vb3Blbmdpcy5uZXQvc3BlYy93bXNcIixcbiAgICAgICAgXCJ0eXBlXCI6XCJkY3Q6U3RhbmRhcmRcIixcbiAgICAgICAgXCJkZXNjcmlwdGlvblwiOlwiT0dDIFdlYiBNYXAgU2VydmljZSAoV01TKVwiLFxuICAgICAgICBcImxhYmVsXCI6XCJPR0MgV2ViIE1hcCBTZXJ2aWNlIChXTVMpXCJcbiAgICB9LFxuXG4gICAgV01UUzoge1xuICAgICAgICBcImlkXCI6XCI3NTc4NThhZTc3Y2Y4YzYwMmIzOTI5NGMyNzYzMmRkN1wiLFxuICAgICAgICBcInVyaVwiOlwiaHR0cDovL29wZW5naXMubmV0L3NwZWMvd210c1wiLFxuICAgICAgICBcInR5cGVcIjpcImRjdDpTdGFuZGFyZFwiLFxuICAgICAgICBcImRlc2NyaXB0aW9uXCI6XCJPR0MgV2ViIE1hcCBUaWxlIFNlcnZpY2UgKFdNVFMpXCIsXG4gICAgICAgIFwibGFiZWxcIjpcIk9HQyBXZWIgTWFwIFRpbGUgU2VydmljZSAoV01UUylcIlxuICAgIH0sXG5cbiAgICBXTVNUOiB7XG4gICAgICAgIFwiaWRcIjogXCJmYWFlNWJmZjQ5YjExNDRkNTAwMzgwY2JjMDU1YzFlNVwiLFxuICAgICAgICBcInVyaVwiOiBcImh0dHA6Ly93d3cuZ2VvcGxhdGZvcm0uZ292L3NwZWMvb2djLXdtcy10XCIsXG4gICAgICAgIFwidHlwZVwiOiBcImRjdDpTdGFuZGFyZFwiLFxuICAgICAgICBcImRlc2NyaXB0aW9uXCI6IFwiT0dDIFdNUyBzdXBwb3J0IGZvciB0ZW1wb3JhbCBhY2NvcmRpbmcgdG8gT0dDIEJlc3QgUHJhY3RpY2UgZ3VpZGFuY2VcIixcbiAgICAgICAgXCJsYWJlbFwiOiBcIk9HQyBXTVMtVCBTZXJ2aWNlXCJcbiAgICB9LFxuXG4gICAgRkVFRDoge1xuICAgICAgICBcImlkXCI6IFwiOGVkYzYxODcwZTUzNGExZjIzZGM5Njc3NTNkYTNiNzJcIixcbiAgICAgICAgXCJ1cmlcIjogXCJodHRwOi8vd3d3Lmdlb3BsYXRmb3JtLmdvdi9zcGVjL2ZlZWRcIixcbiAgICAgICAgXCJ0eXBlXCI6IFwiZGN0OlN0YW5kYXJkXCIsXG4gICAgICAgIFwiZGVzY3JpcHRpb25cIjogXCJHZW9QbGF0Zm9ybSBHZW9KU09OIEZlZWQgU2VydmljZSBjb252ZXJ0cyBhbiBBdG9tL1JTUyBmZWVkIChpbmNsdWRpbmcgR2VvUlNTIGFuZCBDQVAgZXh0ZW5zaW9ucykgdG8gR2VvSlNPTlwiLFxuICAgICAgICBcImxhYmVsXCI6IFwiR2VvUGxhdGZvcm0gR2VvSlNPTiBGZWVkIFNlcnZpY2VcIlxuICAgIH0sXG5cbiAgICAvL1xuICAgIC8vbWV0aG9kIHRvIGFsbG93IHJlZnJlc2hpbmcgbGlzdCBsYXRlclxuICAgIHJlZnJlc2g6IHVwZGF0ZUxpc3Rcbn07XG5cbmZ1bmN0aW9uIHVwZGF0ZUxpc3Qoc2VydmljZSA6IEl0ZW1TZXJ2aWNlKSB7XG5cbiAgICBsZXQgdXJsID0gQ29uZmlnLnVhbFVybDtcbiAgICBpZighdXJsKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiV0FSTiA6IFNlcnZpY2VUeXBlcyAtIG5vIEdlb1BsYXRmb3JtIEFQSSBVUkwgY29uZmlndXJlZCwgdW5hYmxlIHRvIGxvYWQgc2VydmljZSB0eXBlc1wiKTtcbiAgICB9IGVsc2Uge1xuXG4gICAgICAgIGxldCBxdWVyeSA9IFF1ZXJ5RmFjdG9yeSgpXG4gICAgICAgICAgICAudHlwZXMoJ2RjdDpTdGFuZGFyZCcpXG4gICAgICAgICAgICAucmVzb3VyY2VUeXBlcygnU2VydmljZVR5cGUnKVxuICAgICAgICAgICAgLnBhZ2VTaXplKDUwKTtcblxuXG4gICAgICAgIGxldCBzdmMgPSBudWxsO1xuICAgICAgICAvL2lmIGEgc2VydmljZSB3YXMgcHJvdmlkZWQgdG8gYmUgdXNlZCwgdXNlIGl0XG4gICAgICAgIGlmKHNlcnZpY2UgJiYgdHlwZW9mKHNlcnZpY2Uuc2VhcmNoKSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHN2YyA9IHNlcnZpY2U7XG4gICAgICAgIH0gZWxzZSB7IC8vIG90aGVyd2lzZSwgdXNlIGRlZmF1bHRzXG4gICAgICAgICAgICBzdmMgPSBuZXcgSXRlbVNlcnZpY2UodXJsLCBuZXcgSlF1ZXJ5SHR0cENsaWVudCgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN2Yy5zZWFyY2gocXVlcnkpLnRoZW4oIGRhdGEgPT4ge1xuXG4gICAgICAgICAgICBmb3IobGV0IGk9MDsgaTxkYXRhLnJlc3VsdHMubGVuZ3RoOyArK2kpIHtcblxuICAgICAgICAgICAgICAgIGxldCB0eXBlID0gZGF0YS5yZXN1bHRzW2ldLFxuICAgICAgICAgICAgICAgICAgICBrZXkgPSBudWxsLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbCA9IHR5cGUubGFiZWw7XG5cbiAgICAgICAgICAgICAgICBpZih+bGFiZWwuaW5kZXhPZihcIldNUy1UXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleSA9ICdXTVNUJztcbiAgICAgICAgICAgICAgICAgICAgdHlwZS5zdXBwb3J0ZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKH5sYWJlbC5pbmRleE9mKCdPR0MnKSkge1xuICAgICAgICAgICAgICAgICAgICBrZXkgPSBrZXlGbihvZ2NFeHByLCBsYWJlbCk7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUuc3VwcG9ydGVkID0gJ1dNUycgPT09IGtleSB8fCAnV01UUycgPT09IGtleTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZih+bGFiZWwuaW5kZXhPZignRXNyaScpKSB7XG4gICAgICAgICAgICAgICAgICAgIGtleSA9IGtleUZuKGVzcmlFeHByLCBsYWJlbCk7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUuc3VwcG9ydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAga2V5ID0gJ0VTUklfJyArIGtleS50b1VwcGVyQ2FzZSgpICsgJ19TRVJWRVInO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKH5sYWJlbC5pbmRleE9mKFwiRmVlZFwiKSkge1xuICAgICAgICAgICAgICAgICAgICBrZXkgPSBcIkZFRURcIjtcbiAgICAgICAgICAgICAgICAgICAgdHlwZS5zdXBwb3J0ZWQgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAga2V5ID0gbGFiZWw7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0eXBlc1trZXldID0gdHlwZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHR5cGVzKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKCBlcnJvciA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGxvYWRpbmcgc3VwcG9ydGVkIHNlcnZpY2UgdHlwZXM6IFwiICsgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgdHlwZXM7XG4iXX0=