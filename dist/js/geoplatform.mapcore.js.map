{"version":3,"file":"geoplatform.mapcore.js","sources":["../../src/control/L.Control.Loading.js","../../src/control/L.Control.MeasureControl.js","../../src/control/L.Control.MousePosition.js","../../src/layer/osm.js","../../src/layer/baselayer-default.js","../../src/service/types.js","../../src/shared/popup-template.js","../../src/layer/feature.js","../../src/layer/L.esri.Cluster.FeatureLayer.js","../../src/shared/style-resolver.js","../../src/layer/cluster-feature.js","../../src/layer/wms.js","../../node_modules/leaflet-timedimension/dist/leaflet.timedimension.src.js","../../src/layer/wmst.js","../../src/layer/wmts.js","../../src/layer/L.TileLayer.ESRI.js","../../src/layer/osm-factory.js","../../src/layer/factory.js","../../src/map/instance.js","../../src/map/factory.js","../../src/index.js"],"sourcesContent":["\nimport { Control, setOptions, DomUtil, Map } from 'leaflet';\n\nvar loadingControl = Control.extend({\n    options: {\n        position: 'topleft',\n        separate: false,\n        zoomControl: null,\n        spinjs: false,\n        spin: {\n          lines: 7,\n          length: 3,\n          width: 3,\n          radius: 5,\n          rotate: 13,\n          top: \"83%\"\n        }\n    },\n\n    initialize: function(options) {\n        setOptions(this, options);\n        this._dataLoaders = {};\n\n        // Try to set the zoom control this control is attached to from the\n        // options\n        if (this.options.zoomControl !== null) {\n            this.zoomControl = this.options.zoomControl;\n        }\n    },\n\n    onAdd: function(map) {\n        if (this.options.spinjs && (typeof Spinner !== 'function')) {\n            return console.error(\"Leaflet.loading cannot load because you didn't load spin.js (http://fgnass.github.io/spin.js/), even though you set it in options.\");\n        }\n        this._addLayerListeners(map);\n        this._addMapListeners(map);\n\n        // Try to set the zoom control this control is attached to from the map\n        // the control is being added to\n        if (!this.options.separate && !this.zoomControl) {\n            if (map.zoomControl) {\n                this.zoomControl = map.zoomControl;\n            } else if (map.zoomsliderControl) {\n                this.zoomControl = map.zoomsliderControl;\n            }\n        }\n\n        // Create the loading indicator\n        var classes = 'leaflet-control-loading';\n        var container;\n        if (this.zoomControl && !this.options.separate) {\n            // If there is a zoom control, hook into the bottom of it\n            container = this.zoomControl._container;\n            // These classes are no longer used as of Leaflet 0.6\n            classes += ' leaflet-bar-part-bottom leaflet-bar-part last';\n        }\n        else {\n            // Otherwise, create a container for the indicator\n            container = DomUtil.create('div', 'leaflet-control-zoom leaflet-bar');\n        }\n        this._indicator = DomUtil.create('a', classes, container);\n        if (this.options.spinjs) {\n          this._spinner = new Spinner(this.options.spin).spin();\n          this._indicator.appendChild(this._spinner.el);\n        }\n        return container;\n    },\n\n    onRemove: function(map) {\n        this._removeLayerListeners(map);\n        this._removeMapListeners(map);\n    },\n\n    removeFrom: function (map) {\n        if (this.zoomControl && !this.options.separate) {\n            // Override Control.removeFrom() to avoid clobbering the entire\n            // _container, which is the same as zoomControl's\n            this._container.removeChild(this._indicator);\n            this._map = null;\n            this.onRemove(map);\n            return this;\n        }\n        else {\n            // If this control is separate from the zoomControl, call the\n            // parent method so we don't leave behind an empty container\n            return Control.prototype.removeFrom.call(this, map);\n        }\n    },\n\n    addLoader: function(id) {\n        this._dataLoaders[id] = true;\n        this.updateIndicator();\n    },\n\n    removeLoader: function(id) {\n        delete this._dataLoaders[id];\n        this.updateIndicator();\n    },\n\n    updateIndicator: function() {\n        if (this.isLoading()) {\n            this._showIndicator();\n        }\n        else {\n            this._hideIndicator();\n        }\n    },\n\n    isLoading: function() {\n        return this._countLoaders() > 0;\n    },\n\n    _countLoaders: function() {\n        var size = 0, key;\n        for (key in this._dataLoaders) {\n            if (this._dataLoaders.hasOwnProperty(key)) size++;\n        }\n        return size;\n    },\n\n    _showIndicator: function() {\n        // Show loading indicator\n        DomUtil.addClass(this._indicator, 'is-loading');\n\n        // If zoomControl exists, make the zoom-out button not last\n        if (!this.options.separate) {\n            if (this.zoomControl instanceof Control.Zoom) {\n                DomUtil.removeClass(this.zoomControl._zoomOutButton, 'leaflet-bar-part-bottom');\n            }\n            else if (typeof Control.Zoomslider === 'function' && this.zoomControl instanceof Control.Zoomslider) {\n                DomUtil.removeClass(this.zoomControl._ui.zoomOut, 'leaflet-bar-part-bottom');\n            }\n        }\n    },\n\n    _hideIndicator: function() {\n        // Hide loading indicator\n        DomUtil.removeClass(this._indicator, 'is-loading');\n\n        // If zoomControl exists, make the zoom-out button last\n        if (!this.options.separate) {\n            if (this.zoomControl instanceof Control.Zoom) {\n                DomUtil.addClass(this.zoomControl._zoomOutButton, 'leaflet-bar-part-bottom');\n            }\n            else if (typeof Control.Zoomslider === 'function' && this.zoomControl instanceof Control.Zoomslider) {\n                DomUtil.addClass(this.zoomControl._ui.zoomOut, 'leaflet-bar-part-bottom');\n            }\n        }\n    },\n\n    _handleLoading: function(e) {\n        this.addLoader(this.getEventId(e));\n    },\n\n    _handleLoad: function(e) {\n        this.removeLoader(this.getEventId(e));\n    },\n\n    getEventId: function(e) {\n        if (e.id) {\n            return e.id;\n        }\n        else if (e.layer) {\n            return e.layer._leaflet_id;\n        }\n        return e.target._leaflet_id;\n    },\n\n    _layerAdd: function(e) {\n        if (!e.layer || !e.layer.on) return;\n        try {\n            e.layer.on({\n                loading: this._handleLoading,\n                load: this._handleLoad\n            }, this);\n        }\n        catch (exception) {\n            console.warn('L.Control.Loading: Tried and failed to add ' +\n                         ' event handlers to layer', e.layer);\n            console.warn('L.Control.Loading: Full details', exception);\n        }\n    },\n\n    _addLayerListeners: function(map) {\n        // Add listeners for begin and end of load to any layers already on the\n        // map\n        map.eachLayer(function(layer) {\n            if (!layer.on) return;\n            layer.on({\n                loading: this._handleLoading,\n                load: this._handleLoad\n            }, this);\n        }, this);\n\n        // When a layer is added to the map, add listeners for begin and end\n        // of load\n        map.on('layeradd', this._layerAdd, this);\n    },\n\n    _removeLayerListeners: function(map) {\n        // Remove listeners for begin and end of load from all layers\n        map.eachLayer(function(layer) {\n            if (!layer.off) return;\n            layer.off({\n                loading: this._handleLoading,\n                load: this._handleLoad\n            }, this);\n        }, this);\n\n        // Remove layeradd listener from map\n        map.off('layeradd', this._layerAdd, this);\n    },\n\n    _addMapListeners: function(map) {\n        // Add listeners to the map for (custom) dataloading and dataload\n        // events, eg, for AJAX calls that affect the map but will not be\n        // reflected in the above layer events.\n        map.on({\n            dataloading: this._handleLoading,\n            dataload: this._handleLoad,\n            layerremove: this._handleLoad\n        }, this);\n    },\n\n    _removeMapListeners: function(map) {\n        map.off({\n            dataloading: this._handleLoading,\n            dataload: this._handleLoad,\n            layerremove: this._handleLoad\n        }, this);\n    }\n});\n\n\n\nControl.Loading = loadingControl;\nControl.loading = function(options) {\n    return new Control.Loading(options);\n};\nMap.addInitHook(function () {\n    if (this.options.loadingControl) {\n        this.loadingControl = new loadingControl();\n        this.addControl(this.loadingControl);\n    }\n});\n\nexport default loadingControl;\n","\nimport {\n    Control, control,\n    Map,\n    setOptions,\n    DomUtil, DomEvent,\n    layerGroup,\n    polyline, CircleMarker, divIcon, marker\n} from 'leaflet';\n\n\nvar measureControl = Control.extend({\n    options: {\n        position: 'topleft'\n    },\n\n    onAdd: function (map) {\n        var className = 'leaflet-control-zoom leaflet-bar leaflet-control',\n            container = DomUtil.create('div', className);\n\n        this._createButton('&#8674;', 'Measure', 'leaflet-control-measure leaflet-bar-part leaflet-bar-part-top-and-bottom', container, this._toggleMeasure, this);\n\n        return container;\n    },\n\n    _createButton: function (html, title, className, container, fn, context) {\n        var link = DomUtil.create('a', className, container);\n        link.innerHTML = html;\n        link.href = '#';\n        link.title = title;\n\n        DomEvent\n            .on(link, 'click', DomEvent.stopPropagation)\n            .on(link, 'click', DomEvent.preventDefault)\n            .on(link, 'click', fn, context)\n            .on(link, 'dblclick', DomEvent.stopPropagation);\n\n        return link;\n    },\n\n    _toggleMeasure: function () {\n        this._measuring = !this._measuring;\n\n        if(this._measuring) {\n            DomUtil.addClass(this._container, 'leaflet-control-measure-on');\n            this._startMeasuring();\n        } else {\n            DomUtil.removeClass(this._container, 'leaflet-control-measure-on');\n            this._stopMeasuring();\n        }\n    },\n\n    _startMeasuring: function() {\n        this._oldCursor = this._map._container.style.cursor;\n        this._map._container.style.cursor = 'crosshair';\n\n        this._doubleClickZoom = this._map.doubleClickZoom.enabled();\n        this._map.doubleClickZoom.disable();\n\n        DomEvent\n            .on(this._map, 'mousemove', this._mouseMove, this)\n            .on(this._map, 'click', this._mouseClick, this)\n            .on(this._map, 'dblclick', this._finishPath, this)\n            .on(document, 'keydown', this._onKeyDown, this);\n\n        if(!this._layerPaint) {\n            this._layerPaint = layerGroup().addTo(this._map);\n        }\n\n        if(!this._points) {\n            this._points = [];\n        }\n    },\n\n    _stopMeasuring: function() {\n        this._map._container.style.cursor = this._oldCursor;\n\n        DomEvent\n            .off(document, 'keydown', this._onKeyDown, this)\n            .off(this._map, 'mousemove', this._mouseMove, this)\n            .off(this._map, 'click', this._mouseClick, this)\n            .off(this._map, 'dblclick', this._mouseClick, this);\n\n        if(this._doubleClickZoom) {\n            this._map.doubleClickZoom.enable();\n        }\n\n        if(this._layerPaint) {\n            this._layerPaint.clearLayers();\n        }\n\n        this._restartPath();\n    },\n\n    _mouseMove: function(e) {\n        if(!e.latlng || !this._lastPoint) {\n            return;\n        }\n\n        if(!this._layerPaintPathTemp) {\n            this._layerPaintPathTemp = polyline([this._lastPoint, e.latlng], {\n                color: 'black',\n                weight: 1.5,\n                clickable: false,\n                dashArray: '6,3'\n            }).addTo(this._layerPaint);\n        } else {\n            this._layerPaintPathTemp.spliceLatLngs(0, 2, this._lastPoint, e.latlng);\n        }\n\n        if(this._tooltip) {\n            if(!this._distance) {\n                this._distance = 0;\n            }\n\n            this._updateTooltipPosition(e.latlng);\n\n            var distance = e.latlng.distanceTo(this._lastPoint);\n            this._updateTooltipDistance(this._distance + distance, distance);\n        }\n    },\n\n    _mouseClick: function(e) {\n        // Skip if no coordinates\n        if(!e.latlng) {\n            return;\n        }\n\n        // If we have a tooltip, update the distance and create a new tooltip, leaving the old one exactly where it is (i.e. where the user has clicked)\n        if(this._lastPoint && this._tooltip) {\n            if(!this._distance) {\n                this._distance = 0;\n            }\n\n            this._updateTooltipPosition(e.latlng);\n\n            var distance = e.latlng.distanceTo(this._lastPoint);\n            this._updateTooltipDistance(this._distance + distance, distance);\n\n            this._distance += distance;\n        }\n        this._createTooltip(e.latlng);\n\n\n        // If this is already the second click, add the location to the fix path (create one first if we don't have one)\n        if(this._lastPoint && !this._layerPaintPath) {\n            this._layerPaintPath = polyline([this._lastPoint], {\n                color: 'black',\n                weight: 2,\n                clickable: false\n            }).addTo(this._layerPaint);\n        }\n\n        if(this._layerPaintPath) {\n            this._layerPaintPath.addLatLng(e.latlng);\n        }\n\n        // Upate the end marker to the current location\n        if(this._lastCircle) {\n            this._layerPaint.removeLayer(this._lastCircle);\n        }\n\n        this._lastCircle = new CircleMarker(e.latlng, {\n            color: 'black',\n            opacity: 1,\n            weight: 1,\n            fill: true,\n            fillOpacity: 1,\n            radius:2,\n            clickable: this._lastCircle ? true : false\n        }).addTo(this._layerPaint);\n\n        this._lastCircle.on('click', function() { this._finishPath(); }, this);\n\n        // Save current location as last location\n        this._lastPoint = e.latlng;\n    },\n\n    _finishPath: function() {\n        // Remove the last end marker as well as the last (moving tooltip)\n        if(this._lastCircle) {\n            this._layerPaint.removeLayer(this._lastCircle);\n        }\n        if(this._tooltip) {\n            this._layerPaint.removeLayer(this._tooltip);\n        }\n        if(this._layerPaint && this._layerPaintPathTemp) {\n            this._layerPaint.removeLayer(this._layerPaintPathTemp);\n        }\n\n        // Reset everything\n        this._restartPath();\n    },\n\n    _restartPath: function() {\n        this._distance = 0;\n        this._tooltip = undefined;\n        this._lastCircle = undefined;\n        this._lastPoint = undefined;\n        this._layerPaintPath = undefined;\n        this._layerPaintPathTemp = undefined;\n    },\n\n    _createTooltip: function(position) {\n        var icon = divIcon({\n            className: 'leaflet-measure-tooltip',\n            iconAnchor: [-5, -5]\n        });\n        this._tooltip = marker(position, {\n            icon: icon,\n            clickable: false\n        }).addTo(this._layerPaint);\n    },\n\n    _updateTooltipPosition: function(position) {\n        this._tooltip.setLatLng(position);\n    },\n\n    _updateTooltipDistance: function(total, difference) {\n        var totalRound = this._round(total),\n            differenceRound = this._round(difference);\n\n        var text = '<div class=\"leaflet-measure-tooltip-total\">' + totalRound + ' nm</div>';\n        if(differenceRound > 0 && totalRound != differenceRound) {\n            text += '<div class=\"leaflet-measure-tooltip-difference\">(+' + differenceRound + ' nm)</div>';\n        }\n\n        this._tooltip._icon.innerHTML = text;\n    },\n\n    _round: function(val) {\n        return Math.round((val / 1852) * 10) / 10;\n    },\n\n    _onKeyDown: function (e) {\n        if(e.keyCode == 27) {\n            // If not in path exit measuring mode, else just finish path\n            if(!this._lastPoint) {\n                this._toggleMeasure();\n            } else {\n                this._finishPath();\n            }\n        }\n    }\n});\n\nControl.Measure = measureControl;\ncontrol.measure = function (options) {\n    return new Control.Measure(options);\n};\n\nMap.mergeOptions({\n    measureControl: false\n});\n\nMap.addInitHook(function () {\n    if (this.options.measureControl) {\n        this.measureControl = new measureControl();\n        this.addControl(this.measureControl);\n    }\n});\n\n\nexport default measureControl;\n","\nimport { Control, control, setOptions, DomUtil, DomEvent, Util, Map } from 'leaflet';\n\n\nvar positionControl = Control.extend({\n  options: {\n    position: 'bottomleft',\n    separator: ' : ',\n    emptyString: 'Unavailable',\n    lngFirst: false,\n    numDigits: 6,\n    lngFormatter: undefined,\n    latFormatter: undefined,\n    prefix: \"\"\n  },\n\n  onAdd: function (map) {\n    this._container = DomUtil.create('div', 'leaflet-control-mouseposition');\n    DomEvent.disableClickPropagation(this._container);\n    map.on('mousemove', this._onMouseMove, this);\n    this._container.innerHTML=this.options.emptyString;\n    return this._container;\n  },\n\n  onRemove: function (map) {\n    map.off('mousemove', this._onMouseMove);\n  },\n\n  _onMouseMove: function (e) {\n    var lng = this.options.lngFormatter ? this.options.lngFormatter(e.latlng.lng) : Util.formatNum(e.latlng.lng, this.options.numDigits);\n    var lat = this.options.latFormatter ? this.options.latFormatter(e.latlng.lat) : Util.formatNum(e.latlng.lat, this.options.numDigits);\n    var value = this.options.lngFirst ? lng + this.options.separator + lat : lat + this.options.separator + lng;\n    var prefixAndValue = this.options.prefix + ' ' + value;\n    this._container.innerHTML = prefixAndValue;\n  }\n\n});\n\n\nControl.MousePosition =  positionControl;\ncontrol.mousePosition = function (options) {\n    return new Control.MousePosition(options);\n};\n\nMap.mergeOptions({\n    positionControl: false\n});\n\nMap.addInitHook(function () {\n    if (this.options.positionControl) {\n        this.positionControl = new positionControl();\n        this.addControl(this.positionControl);\n    }\n});\n\nexport default positionControl;\n","\nimport Q from \"q\";\nimport GeoPlatformClient from 'geoplatform.client';\n\nconst QueryFactory = GeoPlatformClient.QueryFactory;\nconst LayerService = GeoPlatformClient.LayerService;\nconst HttpClient = GeoPlatformClient.JQueryHttpClient;\nconst Config = GeoPlatformClient.Config;\n\n/**\n * @param {LayerService} layerService - optional, GeoPlatform Layer service to use to fetch the layer\n * @return {Promise} resolving OpenStreet Map GeoPlatform Layer\n */\nexport default {\n\n    /**\n     * @param {Object} layer - GeoPlatform Layer object\n     * @return {boolean} true if is an OSM layer\n     */\n    test : function(layer) {\n        return  layer &&\n                layer.resourceTypes &&\n                layer.resourceTypes.length &&\n                ~layer.resourceTypes.indexOf(\"http://www.geoplatform.gov/ont/openlayer/OSMLayer\");\n    },\n\n    get : function(layerService) {\n        let query = QueryFactory()\n            .fields('*')\n            .resourceTypes(\"http://www.geoplatform.gov/ont/openlayer/OSMLayer\");\n        if(!layerService)\n            layerService = new LayerService(Config.ualUrl, new HttpClient());\n        return layerService.search(query)\n        .then( response => response.results.length ? response.results[0] : null)\n        .catch( e => Q.reject(e));\n    }\n\n};\n","\nimport Q from 'q';\nimport OSM from './osm';\nimport GeoPlatformClient from 'geoplatform.client';\n\nconst LayerService = GeoPlatformClient.LayerService;\nconst HttpClient = GeoPlatformClient.JQueryHttpClient;\n\nconst WORLD_STREET_LAYER = '86a8babde086689e21248669ba4ed579';\n\nvar DefaultBaseLayer = {\n\n    get: function(layerService) {\n        if(!layerService) {\n            layerService = new LayerService(GeoPlatformClient.Config.ualUrl, new HttpClient());\n        }\n        let baseLayerId = GeoPlatformClient.Config.defaultBaseLayerId || WORLD_STREET_LAYER;\n        return layerService.get(baseLayerId).catch(e => Q.resolve( OSM.get() ));\n    },\n\n    set: function(layer) {\n        let id = null;\n        if(layer && layer.id) id = layer.id;\n        else if(layer && typeof(layer) === 'string') id = layer;\n        if(id) {\n            GeoPlatformClient.Config.configure({'defaultBaseLayerId': layer.id});\n        }\n    }\n};\n\nexport default DefaultBaseLayer;\n","\nimport jQuery from \"jquery\";\nimport Q from \"q\";\nimport {\n    ItemService, JQueryHttpClient, QueryFactory, Config\n} from 'geoplatform.client';\n\n\n\nconst ogcExpr = /OGC.+\\(([A-Z\\-]+)\\)/;\nconst esriExpr = /Esri REST ([A-Za-z]+) Service/;\nconst keyFn = (expr, str) => {\n    let m = expr.exec(str);\n    return (m && m.length) ? m[1] : null;\n};\n\nvar types = {\n\n    ESRI_FEATURE_SERVER: {\n        \"id\":\"48980c5bad0c8d4666b393874eb5279a\",\n        \"uri\":\"http://www.geoplatform.gov/spec/esri-feature-rest\",\n        \"type\":\"dct:Standard\",\n        \"description\":\"Esri ArcGIS Feature Server REST API\",\n        \"label\":\"Esri REST Feature Service\"\n    },\n\n    ESRI_IMAGE_SERVER: {\n        \"id\":\"bcdf764e52064c84323f3f1baea7e245\",\n        \"uri\":\"http://www.geoplatform.gov/spec/esri-image-rest\",\n        \"type\":\"dct:Standard\",\n        \"description\":\"Esri ArcGIS Image Server REST API\",\n        \"label\":\"Esri REST Image Service\"\n    },\n\n    ESRI_MAP_SERVER: {\n        \"id\":\"370cf6ca5d91c07b63329b8384fe76c7\",\n        \"uri\":\"http://www.geoplatform.gov/spec/esri-map-rest\",\n        \"type\":\"dct:Standard\",\n        \"description\":\"Esri ArcGIS Map Server REST API\",\n        \"label\":\"Esri REST Map Service\"\n    },\n\n    ESRI_TILE_SERVER: {\n        \"id\": \"c75570ff2523b1a1631afe7ddac27beb\",\n        \"uri\": \"http://www.geoplatform.gov/spec/esri-tile-rest\",\n        \"type\": \"dct:Standard\",\n        \"description\": \"Esri ArcGIS Tile Server REST API\",\n        \"label\": \"Esri REST Tile Service\"\n    },\n\n    KML: {\n        \"id\":\"c0b39ca2049ba2184472ff27408ffd7e\",\n        \"uri\":\"http://opengis.net/spec/kml\",\n        \"type\":\"dct:Standard\",\n        \"description\":\"OGC Keyhole Markup Language (KML)\",\n        \"label\":\"OGC Keyhole Markup Language (KML)\"\n    },\n\n    CSW: {\n        \"id\":\"60de6a422475493b7901ae453d6f4562\",\n        \"uri\":\"http://opengis.net/spec/csw\",\n        \"type\":\"dct:Standard\",\n        \"description\":\"OGC Web Catalog Service (CSW)\",\n        \"label\":\"OGC Web Catalog Service (CSW)\"\n    },\n\n    WCS: {\n        \"id\":\"a7e5a2d81a83d4eae9bf9138f24d0a32\",\n        \"uri\":\"http://opengis.net/spec/wcs\",\n        \"type\":\"dct:Standard\",\n        \"description\":\"OGC Web Coverage Service (WCS)\",\n        \"label\":\"OGC Web Coverage Service (WCS)\"\n    },\n\n    WFS: {\n        \"id\":\"e70e43ed52f83634285a09e959734bff\",\n        \"uri\":\"http://opengis.net/spec/wfs\",\n        \"type\":\"dct:Standard\",\n        \"description\":\"OGC Web Feature Service (WFS)\",\n        \"label\":\"OGC Web Feature Service (WFS)\"\n    },\n\n    WMS: {\n        \"id\":\"abed5a00c536fb2d7019092c37ed634c\",\n        \"uri\":\"http://opengis.net/spec/wms\",\n        \"type\":\"dct:Standard\",\n        \"description\":\"OGC Web Map Service (WMS)\",\n        \"label\":\"OGC Web Map Service (WMS)\"\n    },\n\n    WMTS: {\n        \"id\":\"757858ae77cf8c602b39294c27632dd7\",\n        \"uri\":\"http://opengis.net/spec/wmts\",\n        \"type\":\"dct:Standard\",\n        \"description\":\"OGC Web Map Tile Service (WMTS)\",\n        \"label\":\"OGC Web Map Tile Service (WMTS)\"\n    },\n\n    WMST: {\n        \"id\": \"faae5bff49b1144d500380cbc055c1e5\",\n        \"uri\": \"http://www.geoplatform.gov/spec/ogc-wms-t\",\n        \"type\": \"dct:Standard\",\n        \"description\": \"OGC WMS support for temporal according to OGC Best Practice guidance\",\n        \"label\": \"OGC WMS-T Service\"\n    },\n\n    FEED: {\n        \"id\": \"8edc61870e534a1f23dc967753da3b72\",\n        \"uri\": \"http://www.geoplatform.gov/spec/feed\",\n        \"type\": \"dct:Standard\",\n        \"description\": \"GeoPlatform GeoJSON Feed Service converts an Atom/RSS feed (including GeoRSS and CAP extensions) to GeoJSON\",\n        \"label\": \"GeoPlatform GeoJSON Feed Service\"\n    },\n\n    //\n    //method to allow refreshing list later\n    refresh: updateList\n};\n\nfunction updateList(service) {\n\n    let url = Config.ualUrl;\n    if(!url) {\n        console.log(\"WARN : ServiceTypes - no GeoPlatform API URL configured, unable to load service types\");\n    } else {\n\n        let query = QueryFactory()\n            .types('dct:Standard')\n            .resourceTypes('ServiceType')\n            .pageSize(50);\n\n\n        let svc = null;\n        //if a service was provided to be used, use it\n        if(service && typeof(service.search) !== 'undefined') {\n            svc = service;\n        } else { // otherwise, use defaults\n            svc = new ItemService(url, new JQueryHttpClient());\n        }\n\n        svc.search(query).then( data => {\n\n            for(let i=0; i<data.results.length; ++i) {\n\n                let type = data.results[i],\n                    key = null,\n                    label = type.label;\n\n                if(~label.indexOf(\"WMS-T\")) {\n                    key = 'WMST';\n                    type.supported = true;\n\n                } else if(~label.indexOf('OGC')) {\n                    key = keyFn(ogcExpr, label);\n                    type.supported = 'WMS' === key || 'WMTS' === key;\n\n                } else if(~label.indexOf('Esri')) {\n                    key = keyFn(esriExpr, label);\n                    type.supported = true;\n                    key = 'ESRI_' + key.toUpperCase() + '_SERVER';\n\n                } else if(~label.indexOf(\"Feed\")) {\n                    key = \"FEED\";\n                    type.supported = true;\n\n                } else {\n                    key = label;\n\n                }\n\n                types[key] = type;\n            }\n            // console.log(types);\n        })\n        .catch( error => {\n            console.log(\"Error loading supported service types: \" + error.message);\n        });\n    }\n}\n\nexport default types;\n","\n\nfunction featurePopupTemplate(feature) {\n\n    let props = Object.keys(feature.properties);\n\n    const pFn = function(list, names) {\n        if(!list || !list.find) return null;\n        let match = list.find( name => {\n            let lc = name.toLowerCase();\n            return names.indexOf(lc)>=0;\n        });\n        return match;\n    };\n\n    let titleProp = pFn(props, ['title','name','label']);\n    let title = titleProp ? feature.properties[titleProp] : \"Untitled\";\n\n    let descProp = pFn(props, ['description', 'summary', 'descript']);\n    let description = descProp ? feature.properties[descProp] : \"No description provided\";\n\n    let result = '<div class=\"feature-popup\">' +\n        '<h5>' + title + '</h5>' +\n        '<p>' + description + '</p>';\n\n    if(feature.properties.modified) {\n        let modified = new Date(feature.properties.modified);\n        result += '<div><span class=\"label\">Updated</span><span class=\"value\">' +\n            modified.toDateString() + '</span></div>';\n    }\n\n    if(feature.properties['cap:effective']) {\n        let date = new Date(feature.properties['cap:effective']);\n        result += '<div>' +\n            '<span class=\"label\">Effective</span>' +\n            '<span class=\"value\">' +\n            date.toDateString() + ' ' + date.toTimeString() +\n            '</span>' +\n            '</div>';\n    }\n    if(feature.properties['cap:expires']) {\n        let date = new Date(feature.properties['cap:expires']);\n        result += '<div>' +\n            '<span class=\"label\">Expires</span>' +\n            '<span class=\"value\">' +\n            date.toDateString() + ' ' + date.toTimeString() +\n            '</span>' +\n            '</div>';\n    }\n\n    let linkProp = pFn(props, ['landingpage','link','website']);\n    if(linkProp) {\n        result += '<br>';\n        result += '<a href=\"' + feature.properties[linkProp] + '\" target=\"_blank\">link</a>';\n    }\n\n    result += '<hr>';\n\n    for(let prop in feature.properties) {\n        if(titleProp === prop || descProp === prop ||\n            linkProp === prop || 'modified' === prop)\n            continue;\n        let value = feature.properties[prop];\n        if(typeof(value) === 'object') {\n            for(let p in value) {\n                result += '<div>' +\n                    '<span class=\"label\">' + prop + '.' + p + '</span>' +\n                    '<span class=\"value\">' + value[p] + '</span>' +\n                    '</div>';\n            }\n        } else {\n            result += '<div>' +\n                '<span class=\"label\">' + prop + '</span>' +\n                '<span class=\"value\">' + value + '</span>' +\n                '</div>';\n        }\n    }\n    result += '</div>';\n    return result;\n}\n\nexport default featurePopupTemplate;\n","\nimport jQuery from \"jquery\";\nimport Q from \"q\";\n\nimport {\n    icon as iconFn, marker as markerFn, circleMarker as circleMarkerFn,\n    SVG, svg, Canvas, canvas,\n    bind, Util\n} from 'leaflet';\n\nimport * as esri from \"esri-leaflet\";\n\nimport {Config} from \"geoplatform.client\";\nimport featurePopupTemplate from '../shared/popup-template';\n\n/**\n * Feature Layer\n * Provides custom style loading and point-ilization as well\n * as adding visibility and opacity manipulation methods\n * @extends L.esri.FeatureLayer\n */\nvar FeatureLayer = esri.FeatureLayer.extend({\n\n    _gpStyle : { color: \"#00f\", weight: 2, fillColor: '#00f', fillOpacity: 0.3 },\n\n    /**\n     * @param {object} feature - GeoJSON Point Feature\n     * @param {L.LatLng} latlng\n     * @return {L.Marker}\n     */\n    pointToLayerFn: function (feature, latlng) {\n\n        // console.log(\"Feature: \" + feature.id);\n\n        var style = feature && feature.properties ? feature.properties.style : null;\n        if(!style && typeof this.options.style === 'function') {\n            // console.log(\"Using local style function\");\n            try {\n                style = this.options.style(feature);\n            } catch(e) {\n                console.log(\"error using style function in ClusteredFeatureLayer: \" + e.message);\n            }\n        }\n\n        style = style || this.options.style || {};\n\n        let marker = null;\n        if(style.shape === 'image') {\n            let width = style.width || 16;\n            let height = style.height || 16;\n            var icon = iconFn( {\n                iconUrl: style.content, //base64 encoded string\n                iconSize: [width, height],\n                iconAnchor: [width*0.5, height*0.5],\n                popupAnchor: [0, -11],\n            });\n            let mopts = { icon: icon };\n            if(Config.leafletPane) mopts.pane = Config.leafletPane;\n            marker = markerFn( latlng, mopts);\n\n        } else {\n            style.radius = style.radius || style['stroke-width'] || 4;\n            style.weight = style.weight || style['stroke-width'] || 2;\n            style.color = style.color || style.stroke || '#03f';\n            style.opacity = style.opacity || style['stroke-opacity'] || 0.9;\n            style.fillOpacity = style.opacity || style['fill-opacity'] || 0.3;\n            style.fillColor = style.color || style.fill;\n            style.renderer = this.options.renderer;  //important for pane!\n            marker = circleMarkerFn(latlng, style);\n        }\n\n        let popupTemplate = this.options.popupTemplate || featurePopupTemplate;\n        marker.bindPopup(popupTemplate(feature));\n        return marker;\n    },\n\n    /**\n     * for all non-point features, bind a popup\n     * @param {object} feature - GeoJSON feature\n     * @param {L.Layer} layer - layer representing feature\n     */\n    eachFeatureFn: function(feature, layer) {\n        if(!feature || !feature.geometry || feature.geometry.type === 'Point') {\n            return;\n        }\n        layer.bindPopup(featurePopupTemplate(feature));\n    },\n\n\n\n    initialize: function (options) {\n\n        var self = this;\n        options = options || {};\n\n        if(Config.leafletPane)\n            options.pane = Config.leafletPane;\n\n        let getGPStyle = () => { return this._gpStyle; };\n        options.style = options.style || getGPStyle();\n\n        //in order to put features-based layers into same pane as tile layers,\n        // must specify renderer and set desired pane on that\n        let svgOpts = {};\n        if(Config.leafletPane)\n            svgOpts.pane = Config.leafletPane;\n        var renderer = (SVG && svg(svgOpts)) || (Canvas && canvas());\n        options.renderer = renderer;\n\n        options.pointToLayer = bind(this.pointToLayerFn, this);\n        options.onEachFeature = bind(this.eachFeatureFn, this);\n\n        // options.fields = ['FID', 'type', 'title', 'geometry'];\n\n        FeatureLayer.prototype.initialize.call(this, options);\n\n        this.on('load', function() {\n            if(typeof this.options.zIndex !== 'undefined')\n                this.setZIndex(this.options.zIndex);\n        });\n\n    },\n\n    setZIndex : function (index) {\n        this.options.zIndex = index;\n        for(var id in this._layers)\n            this._layers[id].setZIndex(index);\n    },\n\n    toggleVisibility: function() {\n        for(var id in this._layers) {\n            let layer = this._layers[id];\n            if(layer.toggleVisibility)\n                this._layers[id].toggleVisibility();\n        }\n    },\n\n    setOpacity: function(opacity) {\n        for(var id in this._layers) {\n            let layer = this._layers[id];\n            if(layer.setOpacity)\n                layer.setOpacity(opacity);\n        }\n    },\n\n    loadStyle: function(gpLayerId) {\n        var self = this;\n\n        if(this.options.styleLoader) {\n            this.options.styleLoader(gpLayerId)\n            .then( json => {\n\n                if(!json) return;\n\n                let style = null;\n\n                if(json && json.styles) {\n\n                    let styleFn = Util.bind(function(feature) {\n\n                        let property = this.property || this.field1;\n                        let v = feature[property] || (feature.properties ? feature.properties[property] : null);\n                        let style = null;\n                        if(this.styles) {\n                            let wrapper = this.styles.find( sw => sw.value === v );\n                            if(wrapper) {\n                                style = wrapper.style;\n                                style.radius = style.radius || style['stroke-width'] || 4;\n                                style.weight = style.weight || style['stroke-width'] || 2;\n                                style.color = style.color   || style.stroke || '#03f';\n                                style.opacity = style.opacity || style['stroke-opacity'] || 0.9;\n                                style.fillOpacity = style.opacity || style['fill-opacity'] || 0.3;\n                                style.fillColor = style.color || style.fill;\n                            }\n                        }\n                        // console.log(\"Using style: \" + JSON.stringify(style));\n                        return style;\n                    }, json);\n                    this.options.style = styleFn;\n                    this.setStyle(styleFn);\n                    return;\n\n                } else if(json && typeof(json.push) !== 'undefined') {\n                    //multiple styles returned\n                    style = json[0];  //use first for now\n\n                } else if(json) {\n                    style = json;\n\n                } else {\n                    return; //unrecognizable style\n                }\n\n                if(style.shape) {\n                    var obj = jQuery.extend({}, style);\n                    obj.style = style;\n                    this._gpStyle = style;\n\n                    //setStyle on Cluster.FeatureLayer doesn't appear to work consistently for\n                    // non-clustered features.\n                    // this.setStyle(obj);\n                    //So instead, we manually set it on all features of the layer (that aren't clustered)\n                    for(let id in this._layers)\n                        this._layers[id].setStyle(obj);\n\n                }\n            })\n            .catch( e => {\n                console.log(\"Error fetching feature layer style\");\n                console.log(e);\n            });\n        }\n    }\n\n});\n\n\nexport default FeatureLayer;\n","\n/* jshint ignore:start */\nimport * as MarkerCluster from 'leaflet.markercluster';\nimport { setOptions, markerClusterGroup, GeoJSON } from 'leaflet';\nimport * as esri from \"esri-leaflet\";\n\n/* esri-leaflet-cluster - v2.0.0 - Thu Aug 18 2016 17:12:43 GMT-0700 (PDT)\n * Copyright (c) 2016 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n\nvar version = \"2.0.0\";\n\nvar FeatureLayer = esri.FeatureManager.extend({\n\n  statics: {\n    EVENTS: 'click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose',\n    CLUSTEREVENTS: 'clusterclick clusterdblclick clustermouseover clustermouseout clustermousemove clustercontextmenu'\n  },\n\n  /**\n   * Constructor\n   */\n\n  initialize: function (options) {\n    esri.FeatureManager.prototype.initialize.call(this, options);\n\n    options = setOptions(this, options);\n\n    this._layers = {};\n    this._leafletIds = {};\n\n    this.cluster = new L.markerClusterGroup(options);\n    this._key = 'c' + (Math.random() * 1e9).toString(36).replace('.', '_');\n\n    this.cluster.addEventParent(this);\n  },\n\n  /**\n   * Layer Interface\n   */\n\n  onAdd: function (map) {\n    esri.FeatureManager.prototype.onAdd.call(this, map);\n    this._map.addLayer(this.cluster);\n\n    // NOTE !!!!!!!\n    // Using this type of layer requires map.maxZoom to be set during map creation!\n    // !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n  },\n\n  onRemove: function (map) {\n    esri.FeatureManager.prototype.onRemove.call(this, map);\n    this._map.removeLayer(this.cluster);\n  },\n\n  /**\n   * Feature Management Methods\n   */\n\n  createLayers: function (features) {\n    var markers = [];\n\n    for (var i = features.length - 1; i >= 0; i--) {\n      var geojson = features[i];\n      var layer = this._layers[geojson.id];\n\n      if (!layer) {\n        var newLayer = GeoJSON.geometryToLayer(geojson, this.options);\n        newLayer.feature = GeoJSON.asFeature(geojson);\n        newLayer.defaultOptions = newLayer.options;\n        newLayer._leaflet_id = this._key + '_' + geojson.id;\n\n        this.resetStyle(newLayer.feature.id);\n\n        // cache the layer\n        this._layers[newLayer.feature.id] = newLayer;\n\n        this._leafletIds[newLayer._leaflet_id] = geojson.id;\n\n        if (this.options.onEachFeature) {\n          this.options.onEachFeature(newLayer.feature, newLayer);\n        }\n\n        this.fire('createfeature', {\n          feature: newLayer.feature\n        });\n\n        // add the layer if it is within the time bounds or our layer is not time enabled\n        if (!this.options.timeField || (this.options.timeField && this._featureWithinTimeRange(geojson))) {\n          markers.push(newLayer);\n        }\n      }\n    }\n\n    if (markers.length) {\n      this.cluster.addLayers(markers);\n    }\n  },\n\n  addLayers: function (ids) {\n    var layersToAdd = [];\n    for (var i = ids.length - 1; i >= 0; i--) {\n      var layer = this._layers[ids[i]];\n      this.fire('addfeature', {\n        feature: layer.feature\n      });\n      layersToAdd.push(layer);\n    }\n    this.cluster.addLayers(layersToAdd);\n  },\n\n  removeLayers: function (ids, permanent) {\n    var layersToRemove = [];\n    for (var i = ids.length - 1; i >= 0; i--) {\n      var id = ids[i];\n      var layer = this._layers[id];\n      this.fire('removefeature', {\n        feature: layer.feature,\n        permanent: permanent\n      });\n      layersToRemove.push(layer);\n      if (this._layers[id] && permanent) {\n        delete this._layers[id];\n      }\n    }\n    this.cluster.removeLayers(layersToRemove);\n  },\n\n  /**\n   * Styling Methods\n   */\n\n  resetStyle: function (id) {\n    var layer = this._layers[id];\n\n    if (layer) {\n      layer.options = layer.defaultOptions;\n      this.setFeatureStyle(layer.feature.id, this.options.style);\n    }\n\n    return this;\n  },\n\n  setStyle: function (style) {\n    this.eachFeature(function (layer) {\n      this.setFeatureStyle(layer.feature.id, style);\n    }, this);\n    return this;\n  },\n\n  setFeatureStyle: function (id, style) {\n    var layer = this._layers[id];\n\n    if (typeof style === 'function') {\n      style = style(layer.feature);\n    }\n    if (layer.setStyle) {\n      layer.setStyle(style);\n    }\n  },\n\n  /**\n   * Utility Methods\n   */\n\n  eachFeature: function (fn, context) {\n    for (var i in this._layers) {\n      fn.call(context, this._layers[i]);\n    }\n    return this;\n  },\n\n  getFeature: function (id) {\n    return this._layers[id];\n  }\n});\n\nfunction featureLayer (options) {\n  return new FeatureLayer(options);\n}\n\nexport {\n    FeatureLayer,\n    featureLayer as default,\n    version as VERSION\n}\n","\nimport jQuery from 'jquery';\nimport Q from \"q\";\nimport { Config } from 'geoplatform.client';\n\n/**\n * Fetches style information from GeoPlatform UAL\n * @param {string} id - identifier of layer to resolve style for\n */\nfunction featureStyleResolver(id) {\n    let deferred = Q.defer();\n    if(!jQuery) {\n        deferred.reject(new Error(\"Unable to load feature layer style, jQuery is not installed\"));\n        return deferred.promise;\n    }\n    jQuery.ajax({\n       url: Config.ualUrl + '/api/layers/' + id + '/style',\n       dataType: 'json',\n       success: function(data) {\n           deferred.resolve(data);\n       },\n       error: function(xhr, status, message) {\n           let em = `FeatureStyleResolver() -\n               Error loading style information for layer ${id} : ${message}`;\n           let error = new Error(em);\n           deferred.reject(error);\n       }\n    });\n    return deferred.promise;\n}\n\nexport default featureStyleResolver;\n","\nimport jQuery from \"jquery\";\nimport Q from  \"q\";\nimport { Config } from 'geoplatform.client';\n\nimport {\n    Control,\n    icon as iconFn,\n    marker as markerFn,\n    circleMarker as circleMarkerFn,\n    bind,\n    SVG, svg, Canvas, canvas,\n    Util\n} from 'leaflet';\n\nimport { FeatureLayer as EsriClusterFeatureLayer } from './L.esri.Cluster.FeatureLayer';\nimport featureStyleResolver from '../shared/style-resolver';\nimport featurePopupTemplate from '../shared/popup-template';\n\n\n/**\n * Clustered Feature Layer\n * Provides custom style loading and point-ilization as well\n * as adding visibility and opacity manipulation methods\n * @extends L.esri.ClusterFeatureLayer\n */\nvar ClusteredFeatureLayer = EsriClusterFeatureLayer.extend({\n\n    currentVisibility: true,\n    currentOpacity: 1.0,\n\n    _gpStyle : { color: \"#00f\", weight: 2, fillColor: '#00f', fillOpacity: 0.3 },\n\n    /**\n     * @param {object} feature - GeoJSON Point Feature\n     * @param {L.LatLng} latlng\n     * @return {L.Marker}\n     */\n    pointToLayerFn: function (feature, latlng) {\n\n        var style = feature && feature.properties ? feature.properties.style : null;\n        if(!style && typeof this.options.style === 'function') {\n            // console.log(\"Using local style function\");\n            try {\n                style = this.options.style(feature);\n            } catch(e) {\n                console.log(\"error using style function in ClusteredFeatureLayer: \" + e.message);\n            }\n        }\n\n        style = style || this.options.style || {};\n        style.radius      = style['stroke-width'] || style.radius || 4;\n        style.weight      = style['stroke-width'] || style.weight || 2;\n        style.color       = style.stroke || style.color || '#03f';\n        style.opacity     = style['stroke-opacity'] || style.opacity || 0.9;\n        style.fillOpacity = style['fill-opacity'] || style.opacity || 0.3;\n        style.fillColor   = style.fill || style.color || '#03f';\n        style.renderer    = this.options.renderer;  //important for pane!\n\n        let marker = null;\n        if(style.shape === 'image') {\n            let width = style.width || 16;\n            let height = style.height || 16;\n            var icon = iconFn( {\n                iconUrl: style.content, //base64 encoded string\n                iconSize: [width, height],\n                iconAnchor: [width*0.5, height*0.5],\n                popupAnchor: [0, -11],\n            });\n            let mopts = { icon: icon };\n            if(Config.leafletPane) mopts.pane = Config.leafletPane;\n            marker = markerFn( latlng, mopts);\n        } else {\n            marker = circleMarkerFn(latlng, style);\n        }\n\n        let popupTemplate = this.options.popupTemplate || featurePopupTemplate;\n        marker.bindPopup(popupTemplate(feature));\n\n        return marker;\n    },\n\n    /**\n     * for all non-point features, bind a popup\n     * @param {object} feature - GeoJSON feature\n     * @param {L.Layer} layer - layer representing feature\n     */\n    eachFeatureFn: function(feature, layer) {\n        if(!feature || !feature.geometry || feature.geometry.type === 'Point') {\n            return;\n        }\n        layer.bindPopup(featurePopupTemplate(feature));\n    },\n\n\n\n    initialize: function (options) {\n\n        var self = this;\n\n        options = options || {};\n\n        if(Config.leafletPane)\n            options.pane = Config.leafletPane;\n\n        options.pointToLayer = bind(this.pointToLayerFn, this);\n        options.onEachFeature = bind(this.eachFeatureFn, this);\n        // options.fields = ['FID', 'type', 'title', 'geometry'];\n\n        //Increase from 1 to increase the distance away from the center that spiderfied markers are placed.\n        // This needs to be increased to ensure all markers can be clicked\n        // when spiderfied (some get stuck under the spider legs)\n        options.spiderfyDistanceMultiplier = 2;\n\n        let getGPStyle = () => { return this._gpStyle; };\n        options.style = options.style || getGPStyle;\n        if(options.styleResolver) {\n            this.styleResolver = options.styleResolver;\n        }\n\n        //in order to put features-based layers into same pane as tile layers,\n        // must specify renderer and set desired pane on that\n        let svgOpts = {};\n        if(Config.leafletPane)\n            svgOpts.pane = Config.leafletPane;\n        var renderer = (SVG && svg(svgOpts)) || (Canvas && canvas());\n        options.renderer = renderer;\n\n        EsriClusterFeatureLayer.prototype.initialize.call(this, options);\n\n        this.on('load', function() {\n            if(typeof this.options.zIndex !== 'undefined')\n                this.setZIndex(this.options.zIndex);\n        });\n\n    },\n\n    onAdd: function(map) {\n        EsriClusterFeatureLayer.prototype.onAdd.call(this, map);\n\n        if(this.options.layerId) {\n            this.loadStyle(this.options.layerId);\n        }\n    },\n\n    /** override super class' method to set viz/opac after sub layers created */\n    createLayers: function (features) {\n        EsriClusterFeatureLayer.prototype.createLayers.call(this, features);\n        this.setVisibility(this.currentVisibility);\n        this.setOpacity(this.currentOpacity);\n    },\n\n    /**\n     * @param {integer} index\n     */\n    setZIndex : function (index) {\n        this.options.zIndex = index;\n        for(var id in this._layers) {\n\n            let lyr = this._layers[id];\n            if(lyr.setZIndex)\n                lyr.setZIndex(index);\n            else if(lyr._updateZIndex)\n                lyr._updateZIndex(index);\n            else if(lyr._renderer && lyr._renderer._container){\n                lyr._renderer._container.style.zIndex = index;\n            } else {\n                // console.log(\"Clustered feature layer child \" + id + \" does not support ordering using z-index\");\n            }\n        }\n    },\n\n    /** */\n    toggleVisibility: function() {\n\n        this.currentVisibility = !this.currentVisibility;\n        this.setVisibility(this.currentVisibility);\n\n        // //clustered features\n        // if(this.cluster && this.cluster._featureGroup && this.cluster._featureGroup._layers) {\n        //     for(let id in this.cluster._featureGroup._layers) {\n        //         let layer = this.cluster._featureGroup._layers[id];\n        //         if(layer._icon) {\n        //             jQuery(layer._icon).toggleClass('invisible');\n        //         }\n        //     }\n        // }\n        //\n        // //non-clustered features\n        // if(this._layers) {\n        //     for(let id in this._layers)\n        //         this._layers[id].toggleVisibility();\n        // }\n    },\n\n    /**\n     * @param {boolean} bool - flag\n     */\n    setVisibility: function(bool) {\n\n        this.currentVisibility = !!bool;\n\n        //clustered features\n        if(this.cluster && this.cluster._featureGroup && this.cluster._featureGroup._layers) {\n            for(let id in this.cluster._featureGroup._layers) {\n                let layer = this.cluster._featureGroup._layers[id];\n                if(layer._icon) {\n                    //probably is a more efficient way to do this,\n                    // but this works currently.\n                    // TODO look at using\n                    //  markerCluster.refreshIconOptions({className:'invisible'});\n                    var icon = jQuery(layer._icon);\n                    if(bool) icon.removeClass('invisible');\n                    else icon.addClass('invisible');\n                }\n            }\n        }\n\n        //non-clustered features\n        if(this._layers) {\n            for(let id in this._layers) {\n                let layer = this._layers[id];\n                if(layer.setVisibility)\n                    layer.setVisibility(bool);\n                else if(layer.setStyle)\n                    layer.setStyle({display: bool ? '':'none'});\n            }\n        }\n    },\n\n    /**\n     * @param {number} opacity\n     */\n    setOpacity: function(opacity) {\n\n        this.currentOpacity = isNaN(opacity) ? 1.0 : opacity*1;\n\n        //clustered features\n        if(this.cluster && this.cluster._featureGroup && this.cluster._featureGroup._layers) {\n            for(let id in this.cluster._featureGroup._layers) {\n                let layer = this.cluster._featureGroup._layers[id];\n                if(layer._icon) {\n                    jQuery(layer._icon).css({opacity: opacity});\n                }\n            }\n        }\n\n        //non-clustered features\n        if(this._layers) {\n            for(let id in this._layers) {\n                let layer = this._layers[id];\n                if(layer.setOpacity)\n                    layer.setOpacity(opacity);\n            }\n        }\n    },\n\n    setStyle: function(style) {\n        this.eachFeature(function (layer) {\n            this.setFeatureStyle(layer.feature.id, style);\n        }, this);\n    },\n\n    loadStyle: function(gpLayerId) {\n\n        if(this.options.styleLoader) {\n            this.options.styleLoader(gpLayerId)\n            .then( json => {\n\n                if(!json) return;\n\n                let style = null;\n\n                if(json && json.styles) {\n\n                    let styleFn = Util.bind(function(feature) {\n\n                        let property = this.property || this.field1;\n                        let v = feature[property] || (feature.properties ? feature.properties[property] : null);\n                        let style = null;\n                        if(this.styles) {\n                            let wrapper = this.styles.find( sw => sw.value === v );\n                            if(wrapper) {\n                                style = wrapper.style;\n                                style.radius = style['stroke-width'] || style.radius || 4;\n                                style.weight = style['stroke-width'] || style.weight || 2;\n                                style.color = style.stroke || style.color || '#03f';\n                                style.opacity = style['stroke-opacity'] || style.opacity || 0.9;\n                                style.fillOpacity = style['fill-opacity'] || style.opacity || 0.3;\n                                style.fillColor = style.fill || style.color || '#03f';\n                            } else {\n                                console.log(\"No matching style for \" + JSON.stringify(feature.properties));\n                            }\n                        }\n                        // console.log(\"Using style: \" + JSON.stringify(style));\n                        return style;\n                    }, json);\n                    this.options.style = styleFn;\n                    setTimeout( (layer, style) => { layer.setStyle(style); }, 1000, this, styleFn);\n                    return;\n\n                } else if(json && typeof(json.push) !== 'undefined') {\n                    //multiple styles returned\n                    style = json[0];  //use first for now\n\n                } else if(json) {\n                    style = json;\n\n                } else {\n                    return; //unrecognizable style\n                }\n\n                if(style.shape) {\n                    var obj = jQuery.extend({}, style);\n                    obj.style = style;\n                    this._gpStyle = style;\n\n                    //setStyle on Cluster.FeatureLayer doesn't appear to work consistently for\n                    // non-clustered features.\n                    // this.setStyle(obj);\n                    //So instead, we manually set it on all features of the layer (that aren't clustered)\n                    for(let id in this._layers)\n                        this._layers[id].setStyle(obj);\n\n                }\n            })\n            .catch( e => {\n                console.log(\"Error fetching feature layer style\");\n                console.log(e);\n            });\n        }\n    }\n});\n\n\n\n\n/**\n * @param {object} layer - GeoPlatform Layer object\n * @param {object} options - optional properties\n * @return {L.Layer} leaflet layer instance or null\n */\nfunction clusteredFeatures(layer, options) {\n\n    let service = layer.services && layer.services.length ?\n        layer.services[0] : null;\n    if(!service) {\n        let msg = `clusteredFeatures() -\n                  Cannot create leaflet layer for GP Layer:\n                  layer has no service`;\n        throw new Error(msg);\n    }\n\n    let url     = service.href,\n        format  = layer.supportedFormats ? layer.supportedFormats[0] : null;\n\n    let styleResolver = options && options.styleResolver ?\n        options.styleResolver : featureStyleResolver;\n\n    let opts = {\n        url: url + '/' + layer.layerName,\n        styleLoader: styleResolver,\n        layerId: layer.id\n    };\n\n    if(Config.leafletPane) opts.pane = Config.leafletPane;\n    if(options && options.leafletPane) opts.pane = options.leafletPane;\n\n    return new ClusteredFeatureLayer(opts);\n}\n\n\n\n/**\n * @param {object} layer - GeoPlatform Layer object\n * @param {object} options - optional properties\n * @return {L.Layer} leaflet layer instance or null\n */\nfunction geoJsonFeed(layer, options) {\n\n    let service = layer.services && layer.services.length ?\n        layer.services[0] : null;\n    if(!service) {\n        let msg = `geoJsonFeed() -\n                  Cannot create leaflet layer for GP Layer:\n                  layer has no service`;\n        throw new Error(msg);\n    }\n\n    let url     = service.href,\n        format  = layer.supportedFormats ? layer.supportedFormats[0] : null;\n\n    let layerUrl = url + (url[url.length-1]==='/'?'':'/') +\n        layer.id + '/FeatureServer/' + layer.layerName;\n\n    let styleUrl = url.replace('feeds','styles') +\n        (url[url.length-1]==='/'?'':'/') + layer.id;\n\n    let styleLoaderFactory = function(url) {\n        return function (layerId) {\n            let deferred = Q.defer();\n            if(!jQuery) {\n                deferred.reject(new Error(\"Unable to load GeoJSON feed style, jQuery is not installed\"));\n                return deferred.promise;\n            }\n            jQuery.ajax(url, {\n                dataType:'json',\n                success: function(data) {\n                    deferred.resolve(data);\n                },\n                error: function(xhr, status, message) {\n                    let em = `geoJsonFeed() -\n                        Error loading style information for layer ${layerId} : ${message}`;\n                    let error = new Error(em);\n                    deferred.reject(error);\n                }\n            });\n            return deferred.promise;          //uses jQuery promise\n        };\n    };\n\n    let opts = {\n        url: layerUrl,\n        isModern: true,         //force to use GeoJSON\n        layerId: layer.id,    //used by style loader\n        styleLoader: styleLoaderFactory(styleUrl)\n    };\n\n    if(Config.leafletPane) opts.pane = Config.leafletPane;\n    if(options && options.leafletPane) opts.pane = options.leafletPane;\n\n    return new ClusteredFeatureLayer(opts);\n\n}\n\n\nexport {\n    ClusteredFeatureLayer as default,\n    ClusteredFeatureLayer,\n    clusteredFeatures,\n    geoJsonFeed\n};\n","\nimport jQuery from \"jquery\";\nimport Q from \"q\";\nimport { TileLayer, tileLayer, Util, popup } from 'leaflet';\n\nimport {Config} from 'geoplatform.client';\n\n\n\nvar WMS = TileLayer.WMS.extend({\n\n    enableGetFeatureInfo: function () {\n        this._map.on('click', this.getFeatureInfo, this);\n        this._enabled = true;\n    },\n\n    disableGetFeatureInfo: function() {\n        this._map.off('click', this.getFeatureInfo, this);\n        this._enabled = false;\n    },\n\n    isGetFeatureInfoEnabled: function() {\n        return this._enabled;\n    },\n\n    onRemove: function (map) {\n\n        //if GFI is enabled, disable it before removing\n        if(this.isGetFeatureInfoEnabled())\n        this.disableGetFeatureInfo();\n\n        // Triggered when the layer is removed from a map.\n        //   Unregister a click listener, then do all the upstream WMS things\n        TileLayer.WMS.prototype.onRemove.call(this, map);\n    },\n\n    getFeatureInfo: function (evt) {\n        // Make an AJAX request to the server and hope for the best\n        var url = this.getFeatureInfoUrl(evt.latlng),\n        showResults = Util.bind(this.showGetFeatureInfo, this),\n        parseGetFeatureInfo = this.parseGetFeatureInfo;\n        jQuery.ajax({\n            url: url,\n            success: function (data, status, xhr) {\n                // var err = typeof data === 'string' ? null : data;\n                if(typeof(data) !== 'string')\n                data = parseGetFeatureInfo(data);\n                showResults(null, evt.latlng, data);\n            },\n            error: function (xhr, status, error) {\n                showResults(error);\n            }\n        });\n    },\n\n    getFeatureInfoUrl: function (latlng) {\n        // Construct a GetFeatureInfo request URL given a point\n        var point = this._map.latLngToContainerPoint(latlng, this._map.getZoom()),\n        size = this._map.getSize(),\n\n        params = {\n            srs: 'EPSG:4326',\n            bbox: this._map.getBounds().toBBoxString(),\n            height: size.y,\n            width: size.x,\n            // layers: this.wmsParams.layers,\n            // query_layers: this.wmsParams.layers,\n            info_format: 'text/xml',\n            x: point.x,\n            y: point.y,\n            i: point.x, //1.3.0\n            j: point.y  //1.3.0\n        };\n\n        // return this._url + Util.getParamString(params, this._url, true);\n        var url = '/api/layers/' + this.wmsParams.wmvId + '/feature';\n        return Config.ualUrl + url + Util.getParamString(params, url, true);\n    },\n\n    parseGetFeatureInfo: function(content) {\n        var fields = [];\n        for(var field in content) {\n            fields.push(['<div><strong>', field, ': </strong>', content[field], '</div>'].join(' '));\n        }\n        if(fields.length == 0)\n        fields.push('<em>No data available</em>');\n        return '<div>' + fields.join(' ') + '</div>';\n    },\n\n    showGetFeatureInfo: function (err, latlng, content) {\n        if (err) { console.log(err); return; } // do nothing if there's an error\n\n        // Otherwise show the content in a popup, or something.\n        popup({ maxWidth: 800})\n        .setLatLng(latlng)\n        .setContent(content)\n        .openOn(this._map);\n    }\n\n});\n\n\nfunction wms(layer) {\n\n    let service = layer.services && layer.services.length ?\n        layer.services[0] : null;\n    if(!service) {\n        let msg = `wms() -\n                  Cannot create leaflet layer for GP Layer:\n                  layer has no service`;\n        throw new Error(msg);\n    }\n\n    let url = service.href;\n    let formats = layer.supportedFormats || [];\n    let format  = formats.length ? formats[0] : \"image/png\";\n\n    if(!url) {\n        throw new Error(\"WMS layer's service does not defined a service url\");\n    }\n\n    let supportedCrs = layer.crs || [];\n    if(supportedCrs && supportedCrs.length > 0 && ~supportedCrs.indexOf(\"ESPG:3857\")) {\n        console.log(\"Layer '\" + layer.label + \"' does not support \" +\n            \"EPSG:3857 Spherical Mercator projection and may not render appropriately or at all.\");\n    }\n\n    //determine proper version of the WMS spec to use\n    let version = '1.1.1';\n    let versions = service.serviceTypeVersions || [];\n    if(versions.length && versions.indexOf('1.1.1') < 0) {\n        version = versions[0];\n    } else {\n        console.log(\"Warning: WMS Service doesn't list supported versions, assuming 1.1.1\");\n    }\n\n\n    let opts = {\n        layers: layer.layerName,\n        transparent: true,\n        format: format,\n        wmvId: layer.id,\n        version: version\n    };\n    if(Config.leafletPane)\n        opts.pane = Config.leafletPane;\n\n    return new WMS(url, opts);\n\n}\n\n// TileLayer.WMS = WMS;\n// tileLayer.wms = wms;\n\nexport {\n    WMS as default,\n    WMS,\n    wms\n};\n","/* \n * Leaflet TimeDimension v1.1.0 - 2017-10-13 \n * \n * Copyright 2017 Biel Frontera (ICTS SOCIB) \n * datacenter@socib.es \n * http://www.socib.es/ \n * \n * Licensed under the MIT license. \n * \n * Demos: \n * http://apps.socib.es/Leaflet.TimeDimension/ \n * \n * Source: \n * git://github.com/socib/Leaflet.TimeDimension.git \n * \n */\n/*jshint indent: 4, browser:true*/\n/*global L*/\n/*\n * L.TimeDimension: TimeDimension object manages the time component of a layer.\n * It can be shared among different layers and it can be added to a map, and become\n * the default timedimension component for any layer added to the map.\n */\n\nL.TimeDimension = (L.Layer || L.Class).extend({\n\n    includes: (L.Evented || L.Mixin.Events),\n\n    initialize: function (options) {\n        L.setOptions(this, options);\n        // _availableTimes is an array with all the available times in ms.\n        this._availableTimes = this._generateAvailableTimes();\n        this._currentTimeIndex = -1;\n        this._loadingTimeIndex = -1;\n        this._loadingTimeout = this.options.loadingTimeout || 3000;\n        this._syncedLayers = [];\n        if (this._availableTimes.length > 0) {\n            this.setCurrentTime(this.options.currentTime || this._getDefaultCurrentTime());\n        }\n        if (this.options.lowerLimitTime) {\n            this.setLowerLimit(this.options.lowerLimitTime);\n        }\n        if (this.options.upperLimitTime) {\n            this.setUpperLimit(this.options.upperLimitTime);\n        }\n    },\n\n    getAvailableTimes: function () {\n        return this._availableTimes;\n    },\n\n    getCurrentTimeIndex: function () {\n        if (this._currentTimeIndex === -1) {\n            return this._availableTimes.length - 1;\n        }\n        return this._currentTimeIndex;\n    },\n\n    getCurrentTime: function () {\n        var index = -1;\n        if (this._loadingTimeIndex !== -1) {\n            index = this._loadingTimeIndex;\n        } else {\n            index = this.getCurrentTimeIndex();\n        }\n        if (index >= 0) {\n            return this._availableTimes[index];\n        } else {\n            return null;\n        }\n    },\n\n    isLoading: function () {\n        return (this._loadingTimeIndex !== -1);\n    },\n\n    setCurrentTimeIndex: function (newIndex) {\n        var upperLimit = this._upperLimit || this._availableTimes.length - 1;\n        var lowerLimit = this._lowerLimit || 0;\n        //clamp the value\n        newIndex = Math.min(Math.max(lowerLimit, newIndex), upperLimit);\n        if (newIndex < 0) {\n            return;\n        }\n        this._loadingTimeIndex = newIndex;\n        var newTime = this._availableTimes[newIndex];\n        \n        if (this._checkSyncedLayersReady(this._availableTimes[this._loadingTimeIndex])) {\n            this._newTimeIndexLoaded();\n        } else {\n            this.fire('timeloading', {\n                time: newTime\n            });\n            // add timeout of 3 seconds if layers doesn't response\n            setTimeout((function (index) {\n                if (index == this._loadingTimeIndex) {\n                    \n                    this._newTimeIndexLoaded();\n                }\n            }).bind(this, newIndex), this._loadingTimeout);\n        }\n\n    },\n\n    _newTimeIndexLoaded: function () {\n        if (this._loadingTimeIndex === -1) {\n            return;\n        }\n        var time = this._availableTimes[this._loadingTimeIndex];\n        \n        this._currentTimeIndex = this._loadingTimeIndex;\n        this.fire('timeload', {\n            time: time\n        });\n        this._loadingTimeIndex = -1;\n    },\n    \n    _checkSyncedLayersReady: function (time) {\n        for (var i = 0, len = this._syncedLayers.length; i < len; i++) {\n            if (this._syncedLayers[i].isReady) {\n                if (!this._syncedLayers[i].isReady(time)) {\n\t\t\t\t\treturn false;                    \n                }\n            }\n        }\n        return true;\n    },\n    \n    setCurrentTime: function (time) {\n        var newIndex = this._seekNearestTimeIndex(time);\n        this.setCurrentTimeIndex(newIndex);\n    },\n\n    seekNearestTime: function (time) {\n        var index = this._seekNearestTimeIndex(time);\n        return this._availableTimes[index];\n    },\n\n    nextTime: function (numSteps, loop) {\n        if (!numSteps) {\n            numSteps = 1;\n        }\n        var newIndex = this._currentTimeIndex;\n        var upperLimit = this._upperLimit || this._availableTimes.length - 1;\n        var lowerLimit = this._lowerLimit || 0;\n        if (this._loadingTimeIndex > -1) {\n            newIndex = this._loadingTimeIndex;\n        }\n        newIndex = newIndex + numSteps;\n        if (newIndex > upperLimit) {\n            if (!!loop) {\n                newIndex = lowerLimit;\n            } else {\n                newIndex = upperLimit;\n            }\n        }\n        // loop backwards\n        if (newIndex < lowerLimit) {\n            if (!!loop) {\n                newIndex = upperLimit;\n            } else {\n                newIndex = lowerLimit;\n            }\n        }\n        this.setCurrentTimeIndex(newIndex);\n    },\n\n    prepareNextTimes: function (numSteps, howmany, loop) {\n        if (!numSteps) {\n            numSteps = 1;\n        }\n\n        var newIndex = this._currentTimeIndex;\n        var currentIndex = newIndex;\n        if (this._loadingTimeIndex > -1) {\n            newIndex = this._loadingTimeIndex;\n        }\n        // assure synced layers have a buffer/cache of at least howmany elements\n        for (var i = 0, len = this._syncedLayers.length; i < len; i++) {\n            if (this._syncedLayers[i].setMinimumForwardCache) {\n                this._syncedLayers[i].setMinimumForwardCache(howmany);\n            }\n        }\n        var count = howmany;\n        var upperLimit = this._upperLimit || this._availableTimes.length - 1;\n        var lowerLimit = this._lowerLimit || 0;\n        while (count > 0) {\n            newIndex = newIndex + numSteps;\n            if (newIndex > upperLimit) {\n                if (!!loop) {\n                    newIndex = lowerLimit;\n                } else {\n                    break;\n                }\n            }\n            if (newIndex < lowerLimit) {\n                if (!!loop) {\n                    newIndex = upperLimit;\n                } else {\n                    break;\n                }\n            }\n            if (currentIndex === newIndex) {\n                //we looped around the timeline\n                //no need to load further, the next times are already loading\n                break;\n            }\n            this.fire('timeloading', {\n                time: this._availableTimes[newIndex]\n            });\n            count--;\n        }\n    },\n\n    getNumberNextTimesReady: function (numSteps, howmany, loop) {\n        if (!numSteps) {\n            numSteps = 1;\n        }\n\n        var newIndex = this._currentTimeIndex;\n        if (this._loadingTimeIndex > -1) {\n            newIndex = this._loadingTimeIndex;\n        }\n        var count = howmany;\n        var ready = 0;\n        var upperLimit = this._upperLimit || this._availableTimes.length - 1;\n        var lowerLimit = this._lowerLimit || 0;\n        while (count > 0) {\n            newIndex = newIndex + numSteps;\n            if (newIndex > upperLimit) {\n                if (!!loop) {\n                    newIndex = lowerLimit;\n                } else {\n                    count = 0;\n                    ready = howmany;\n                    break;\n                }\n            }\n            if (newIndex < lowerLimit) {\n                if (!!loop) {\n                    newIndex = upperLimit;\n                } else {\n                    count = 0;\n                    ready = howmany;\n                    break;\n                }\n            }\n            var time = this._availableTimes[newIndex];\n            if (this._checkSyncedLayersReady(time)) {\n                ready++;\n            }\n            count--;\n        }\n        return ready;\n    },\n\n    previousTime: function (numSteps, loop) {\n        this.nextTime(numSteps*(-1), loop);\n    },\n\n    registerSyncedLayer: function (layer) {\n        this._syncedLayers.push(layer);\n        layer.on('timeload', this._onSyncedLayerLoaded, this);\n    },\n\n    unregisterSyncedLayer: function (layer) {\n        var index = this._syncedLayers.indexOf(layer);\n        if (index != -1) {\n            this._syncedLayers.splice(index, 1);\n        }\n        layer.off('timeload', this._onSyncedLayerLoaded, this);\n    },\n\n    _onSyncedLayerLoaded: function (e) {\n        if (e.time == this._availableTimes[this._loadingTimeIndex] && this._checkSyncedLayersReady(e.time)) {\n            this._newTimeIndexLoaded();\n        }\n    },\n\n    _generateAvailableTimes: function () {\n        if (this.options.times) {\n            return L.TimeDimension.Util.parseTimesExpression(this.options.times);\n        } else if (this.options.timeInterval) {\n            var tiArray = L.TimeDimension.Util.parseTimeInterval(this.options.timeInterval);\n            var period = this.options.period || 'P1D';\n            var validTimeRange = this.options.validTimeRange || undefined;\n            return L.TimeDimension.Util.explodeTimeRange(tiArray[0], tiArray[1], period, validTimeRange);\n        } else {\n            return [];\n        }\n    },\n\n    _getDefaultCurrentTime: function () {\n        var index = this._seekNearestTimeIndex(new Date().getTime());\n        return this._availableTimes[index];\n    },\n\n    _seekNearestTimeIndex: function (time) {\n        var newIndex = 0;\n        var len = this._availableTimes.length;\n        for (; newIndex < len; newIndex++) {\n            if (time < this._availableTimes[newIndex]) {\n                break;\n            }\n        }\n        // We've found the first index greater than the time. Return the previous\n        if (newIndex > 0) {\n            newIndex--;\n        }\n        return newIndex;\n    },\n\n    setAvailableTimes: function (times, mode) {\n        var currentTime = this.getCurrentTime(),\n            lowerLimitTime = this.getLowerLimit(),\n            upperLimitTime = this.getUpperLimit();\n\n        if (mode == 'extremes') {\n            var period = this.options.period || 'P1D';\n            this._availableTimes = L.TimeDimension.Util.explodeTimeRange(new Date(times[0]), new Date(times[times.length - 1]), period);\n        } else {\n            var parsedTimes = L.TimeDimension.Util.parseTimesExpression(times);\n            if (this._availableTimes.length === 0) {\n                this._availableTimes = parsedTimes;\n            } else if (mode == 'intersect') {\n                this._availableTimes = L.TimeDimension.Util.intersect_arrays(parsedTimes, this._availableTimes);\n            } else if (mode == 'union') {\n                this._availableTimes = L.TimeDimension.Util.union_arrays(parsedTimes, this._availableTimes);\n            } else if (mode == 'replace') {\n                this._availableTimes = parsedTimes;\n            } else {\n                throw 'Merge available times mode not implemented: ' + mode;\n            }\n        }\n\n        if (lowerLimitTime) {\n            this.setLowerLimit(lowerLimitTime); //restore lower limit\n        }\n        if (upperLimitTime) {\n            this.setUpperLimit(upperLimitTime); //restore upper limit\n        }\n        this.setCurrentTime(currentTime);\n        this.fire('availabletimeschanged', {\n            availableTimes: this._availableTimes,\n            currentTime: currentTime\n        });\n        \n    },\n    getLowerLimit: function () {\n        return this._availableTimes[this.getLowerLimitIndex()];\n    },\n    getUpperLimit: function () {\n        return this._availableTimes[this.getUpperLimitIndex()];\n    },\n    setLowerLimit: function (time) {\n        var index = this._seekNearestTimeIndex(time);\n        this.setLowerLimitIndex(index);\n    },\n    setUpperLimit: function (time) {\n        var index = this._seekNearestTimeIndex(time);\n        this.setUpperLimitIndex(index);\n    },\n    setLowerLimitIndex: function (index) {\n        this._lowerLimit = Math.min(Math.max(index || 0, 0), this._upperLimit || this._availableTimes.length - 1);\n        this.fire('limitschanged', {\n            lowerLimit: this._lowerLimit,\n            upperLimit: this._upperLimit\n        });\n    },\n    setUpperLimitIndex: function (index) {\n        this._upperLimit = Math.max(Math.min(index, this._availableTimes.length - 1), this._lowerLimit || 0);\n        this.fire('limitschanged', {\n            lowerLimit: this._lowerLimit,\n            upperLimit: this._upperLimit\n        });\n    },\n    getLowerLimitIndex: function () {\n        return this._lowerLimit;\n    },\n    getUpperLimitIndex: function () {\n        return this._upperLimit;\n    }\n});\n\nL.Map.addInitHook(function () {\n    if (this.options.timeDimension) {\n        this.timeDimension = L.timeDimension(this.options.timeDimensionOptions || {});\n    }\n});\n\nL.timeDimension = function (options) {\n    return new L.TimeDimension(options);\n};\n\n/*\n * L.TimeDimension.Util\n */\n\nL.TimeDimension.Util = {\n    getTimeDuration: function(ISODuration) {\n        if (typeof nezasa === 'undefined') {\n            throw \"iso8601-js-period library is required for Leatlet.TimeDimension: https://github.com/nezasa/iso8601-js-period\";\n        }\n        return nezasa.iso8601.Period.parse(ISODuration, true);\n    },\n\n    addTimeDuration: function(date, duration, utc) {\n        if (typeof utc === 'undefined') {\n            utc = true;\n        }\n        if (typeof duration == 'string' || duration instanceof String) {\n            duration = this.getTimeDuration(duration);\n        }\n        var l = duration.length;\n        var get = utc ? \"getUTC\" : \"get\";\n        var set = utc ? \"setUTC\" : \"set\";\n\n        if (l > 0 && duration[0] != 0) {\n            date[set + \"FullYear\"](date[get + \"FullYear\"]() + duration[0]);\n        }\n        if (l > 1 && duration[1] != 0) {\n            date[set + \"Month\"](date[get + \"Month\"]() + duration[1]);\n        }\n        if (l > 2 && duration[2] != 0) {\n            // weeks\n            date[set + \"Date\"](date[get + \"Date\"]() + (duration[2] * 7));\n        }\n        if (l > 3 && duration[3] != 0) {\n            date[set + \"Date\"](date[get + \"Date\"]() + duration[3]);\n        }\n        if (l > 4 && duration[4] != 0) {\n            date[set + \"Hours\"](date[get + \"Hours\"]() + duration[4]);\n        }\n        if (l > 5 && duration[5] != 0) {\n            date[set + \"Minutes\"](date[get + \"Minutes\"]() + duration[5]);\n        }\n        if (l > 6 && duration[6] != 0) {\n            date[set + \"Seconds\"](date[get + \"Seconds\"]() + duration[6]);\n        }\n    },\n\n    subtractTimeDuration: function(date, duration, utc) {\n        if (typeof duration == 'string' || duration instanceof String) {\n            duration = this.getTimeDuration(duration);\n        }\n        var subDuration = [];\n        for (var i = 0, l = duration.length; i < l; i++) {\n            subDuration.push(-duration[i]);\n        }\n        this.addTimeDuration(date, subDuration, utc);\n    },\n\n    parseAndExplodeTimeRange: function(timeRange) {\n        var tr = timeRange.split('/');\n        var startTime = new Date(Date.parse(tr[0]));\n        var endTime = new Date(Date.parse(tr[1]));\n        var duration = tr.length > 2 ? tr[2] : \"P1D\";\n\n        return this.explodeTimeRange(startTime, endTime, duration);\n    },\n\n    explodeTimeRange: function(startTime, endTime, ISODuration, validTimeRange) {\n        var duration = this.getTimeDuration(ISODuration);\n        var result = [];\n        var currentTime = new Date(startTime.getTime());\n        var minHour = null,\n            minMinutes = null,\n            maxHour = null,\n            maxMinutes = null;\n        if (validTimeRange !== undefined) {\n            var validTimeRangeArray = validTimeRange.split('/');\n            minHour = validTimeRangeArray[0].split(':')[0];\n            minMinutes = validTimeRangeArray[0].split(':')[1];\n            maxHour = validTimeRangeArray[1].split(':')[0];\n            maxMinutes = validTimeRangeArray[1].split(':')[1];\n        }\n        while (currentTime < endTime) {\n            if (validTimeRange === undefined ||\n                (currentTime.getUTCHours() >= minHour && currentTime.getUTCHours() <= maxHour)\n            ) {\n                if ((currentTime.getUTCHours() != minHour || currentTime.getUTCMinutes() >= minMinutes) &&\n                    (currentTime.getUTCHours() != maxHour || currentTime.getUTCMinutes() <= maxMinutes)) {\n                    result.push(currentTime.getTime());\n                }\n            }\n            this.addTimeDuration(currentTime, duration);\n        }\n        if (currentTime >= endTime){\n            result.push(endTime.getTime());\n        }\n        return result;\n    },\n\n    parseTimeInterval: function(timeInterval) {\n        var parts = timeInterval.split(\"/\");\n        if (parts.length != 2) {\n            throw \"Incorrect ISO9601 TimeInterval: \" + timeInterval;\n        }\n        var startTime = Date.parse(parts[0]);\n        var endTime = null;\n        var duration = null;\n        if (isNaN(startTime)) {\n            // -> format duration/endTime\n            duration = this.getTimeDuration(parts[0]);\n            endTime = Date.parse(parts[1]);\n            startTime = new Date(endTime);\n            this.subtractTimeDuration(startTime, duration, true);\n            endTime = new Date(endTime);\n        } else {\n            endTime = Date.parse(parts[1]);\n            if (isNaN(endTime)) {\n                // -> format startTime/duration\n                duration = this.getTimeDuration(parts[1]);\n                endTime = new Date(startTime);\n                this.addTimeDuration(endTime, duration, true);\n            } else {\n                // -> format startTime/endTime\n                endTime = new Date(endTime);\n            }\n            startTime = new Date(startTime);\n        }\n        return [startTime, endTime];\n    },\n\n    parseTimesExpression: function(times) {\n        var result = [];\n        if (!times) {\n            return result;\n        }\n        if (typeof times == 'string' || times instanceof String) {\n            var timeRanges = times.split(\",\");\n            var timeRange;\n            var timeValue;\n            for (var i=0, l=timeRanges.length; i<l; i++){\n                timeRange = timeRanges[i];\n                if (timeRange.split(\"/\").length == 3) {\n                    result = result.concat(this.parseAndExplodeTimeRange(timeRange));\n                } else {\n                    timeValue = Date.parse(timeRange);\n                    if (!isNaN(timeValue)) {\n                        result.push(timeValue);\n                    }\n                }\n            }\n        } else {\n            result = times;\n        }\n        return result.sort(function(a, b) {\n            return a - b;\n        });\n    },\n\n    intersect_arrays: function(arrayA, arrayB) {\n        var a = arrayA.slice(0);\n        var b = arrayB.slice(0);\n        var result = [];\n        while (a.length > 0 && b.length > 0) {\n            if (a[0] < b[0]) {\n                a.shift();\n            } else if (a[0] > b[0]) {\n                b.shift();\n            } else /* they're equal */ {\n                result.push(a.shift());\n                b.shift();\n            }\n        }\n        return result;\n    },\n\n    union_arrays: function(arrayA, arrayB) {\n        var a = arrayA.slice(0);\n        var b = arrayB.slice(0);\n        var result = [];\n        while (a.length > 0 && b.length > 0) {\n            if (a[0] < b[0]) {\n                result.push(a.shift());\n            } else if (a[0] > b[0]) {\n                result.push(b.shift());\n            } else /* they're equal */ {\n                result.push(a.shift());\n                b.shift();\n            }\n        }\n        if (a.length > 0) {\n            result = result.concat(a);\n        } else if (b.length > 0) {\n            result = result.concat(b);\n        }\n        return result;\n    }\n\n};\n\n/*\n * L.TimeDimension.Layer:  an abstract Layer that can be managed/synchronized with a TimeDimension.\n * The constructor recieves a layer (of any kind) and options.\n * Any children class should implement `_onNewTimeLoading`, `isReady` and `_update` functions\n * to react to time changes.\n */\n\nL.TimeDimension.Layer = (L.Layer || L.Class).extend({\n\n    includes: (L.Evented || L.Mixin.Events),\n    options: {\n        opacity: 1,\n        zIndex: 1\n    },\n\n    initialize: function(layer, options) {\n        L.setOptions(this, options || {});\n        this._map = null;\n        this._baseLayer = layer;\n        this._currentLayer = null;\n        this._timeDimension = this.options.timeDimension || null;\n    },\n\n    addTo: function(map) {\n        map.addLayer(this);\n        return this;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        if (!this._timeDimension && map.timeDimension) {\n            this._timeDimension = map.timeDimension;\n        }\n        this._timeDimension.on(\"timeloading\", this._onNewTimeLoading, this);\n        this._timeDimension.on(\"timeload\", this._update, this);\n        this._timeDimension.registerSyncedLayer(this);\n        this._update();\n    },\n\n    onRemove: function(map) {\n        this._timeDimension.unregisterSyncedLayer(this);\n        this._timeDimension.off(\"timeloading\", this._onNewTimeLoading, this);\n        this._timeDimension.off(\"timeload\", this._update, this);\n        this.eachLayer(map.removeLayer, map);\n        this._map = null;\n    },\n\n    eachLayer: function(method, context) {\n        method.call(context, this._baseLayer);\n        return this;\n    },\n\n    setZIndex: function(zIndex) {\n        this.options.zIndex = zIndex;\n        if (this._baseLayer.setZIndex) {\n            this._baseLayer.setZIndex(zIndex);\n        }\n        if (this._currentLayer && this._currentLayer.setZIndex) {\n            this._currentLayer.setZIndex(zIndex);\n        }\n        return this;\n    },\n\n    setOpacity: function(opacity) {\n        this.options.opacity = opacity;\n        if (this._baseLayer.setOpacity) {\n            this._baseLayer.setOpacity(opacity);\n        }\n        if (this._currentLayer && this._currentLayer.setOpacity) {\n            this._currentLayer.setOpacity(opacity);\n        }\n        return this;\n    },\n\n    bringToBack: function() {\n        if (!this._currentLayer) {\n            return;\n        }\n        this._currentLayer.bringToBack();\n        return this;\n    },\n\n    bringToFront: function() {\n        if (!this._currentLayer) {\n            return;\n        }\n        this._currentLayer.bringToFront();\n        return this;\n    },\n\n    _onNewTimeLoading: function(ev) {\n        // to be implemented for each type of layer\n        this.fire('timeload', {\n            time: ev.time\n        });\n        return;\n    },\n\n    isReady: function(time) {\n        // to be implemented for each type of layer\n        return true;\n    },\n\n    _update: function() {\n        // to be implemented for each type of layer\n        return true;\n    },\n\n    getBaseLayer: function() {\n        return this._baseLayer;\n    },\n\n    getBounds: function() {\n        var bounds = new L.LatLngBounds();\n        if (this._currentLayer) {\n            bounds.extend(this._currentLayer.getBounds ? this._currentLayer.getBounds() : this._currentLayer.getLatLng());\n        }\n        return bounds;\n    }\n\n});\n\nL.timeDimension.layer = function(layer, options) {\n    return new L.TimeDimension.Layer(layer, options);\n};\n/*\n * L.TimeDimension.Layer.WMS: wms Layer associated to a TimeDimension\n */\n\nL.TimeDimension.Layer.WMS = L.TimeDimension.Layer.extend({\n\n    initialize: function(layer, options) {\n        L.TimeDimension.Layer.prototype.initialize.call(this, layer, options);\n        this._timeCacheBackward = this.options.cacheBackward || this.options.cache || 0;\n        this._timeCacheForward = this.options.cacheForward || this.options.cache || 0;\n        this._wmsVersion = this.options.wmsVersion || this.options.version || layer.options.version || \"1.1.1\";\n        this._getCapabilitiesParams = this.options.getCapabilitiesParams || {};\n        this._getCapabilitiesAlternateUrl = this.options.getCapabilitiesUrl || null;\n        this._getCapabilitiesAlternateLayerName = this.options.getCapabilitiesLayerName || null;\n        this._proxy = this.options.proxy || null;\n        this._updateTimeDimension = this.options.updateTimeDimension || false;\n        this._setDefaultTime = this.options.setDefaultTime || false;\n        this._updateTimeDimensionMode = this.options.updateTimeDimensionMode || 'intersect'; // 'union' or 'replace'\n        this._layers = {};\n        this._defaultTime = 0;\n        this._availableTimes = [];\n        this._capabilitiesRequested = false;\n        if (this._updateTimeDimension || this.options.requestTimeFromCapabilities) {\n            this._requestTimeDimensionFromCapabilities();\n        }\n\n        this._baseLayer.on('load', (function() {\n            this._baseLayer.setLoaded(true);\n            this.fire('timeload', {\n                time: this._defaultTime\n            });\n        }).bind(this));\n    },\n\n    getEvents: function() {\n        var clearCache = L.bind(this._unvalidateCache, this);\n        return {\n            moveend: clearCache,\n            zoomend: clearCache\n        }\n    },\n\n    eachLayer: function(method, context) {\n        for (var prop in this._layers) {\n            if (this._layers.hasOwnProperty(prop)) {\n                method.call(context, this._layers[prop]);\n            }\n        }\n        return L.TimeDimension.Layer.prototype.eachLayer.call(this, method, context);\n    },\n\n    _onNewTimeLoading: function(ev) {\n        // \n        var layer = this._getLayerForTime(ev.time);\n        if (!this._map.hasLayer(layer)) {\n            this._map.addLayer(layer);\n            // \n        }\n    },\n\n    isReady: function(time) {\n        var layer = this._getLayerForTime(time);\n        if (this.options.bounds && this._map)\n            if (!this._map.getBounds().contains(this.options.bounds))\n                return true;\n        return layer.isLoaded();\n    },\n\n    onAdd: function(map) {\n        L.TimeDimension.Layer.prototype.onAdd.call(this, map);\n        if (this._availableTimes.length == 0) {\n            this._requestTimeDimensionFromCapabilities();\n        } else {\n            this._updateTimeDimensionAvailableTimes();\n        }\n    },\n\n    _update: function() {\n        if (!this._map)\n            return;\n        var time = this._timeDimension.getCurrentTime();\n        // It will get the layer for this time (create or get)\n        // Then, the layer will be loaded if necessary, adding it to the map (and show it after loading).\n        // If it already on the map (but probably hidden), it will be shown\n        var layer = this._getLayerForTime(time);\n        if (this._currentLayer == null) {\n            this._currentLayer = layer;\n        }\n        if (!this._map.hasLayer(layer)) {\n            this._map.addLayer(layer);\n        } else {\n            this._showLayer(layer, time);\n        }\n    },\n\n    setOpacity: function(opacity) {\n        L.TimeDimension.Layer.prototype.setOpacity.apply(this, arguments);\n        // apply to all preloaded caches\n        for (var prop in this._layers) {\n            if (this._layers.hasOwnProperty(prop) && this._layers[prop].setOpacity) {\n                this._layers[prop].setOpacity(opacity);\n            }\n        }\n    },\n\n    setZIndex: function(zIndex){\n        L.TimeDimension.Layer.prototype.setZIndex.apply(this, arguments);\n        // apply to all preloaded caches\n        for (var prop in this._layers) {\n            if (this._layers.hasOwnProperty(prop) && this._layers[prop].setZIndex) {\n                this._layers[prop].setZIndex(zIndex);\n            }\n        }\n    },\n\n    setParams: function(params, noRedraw) {\n        L.extend(this._baseLayer.options, params);\n        if (this._baseLayer.setParams) {\n            this._baseLayer.setParams(params, noRedraw);\n        }\n        for (var prop in this._layers) {\n            if (this._layers.hasOwnProperty(prop) && this._layers[prop].setParams) {\n                this._layers[prop].setLoaded(false); // mark it as unloaded\n                this._layers[prop].setParams(params, noRedraw);\n            }\n        }\n        return this;\n    },\n\n    _unvalidateCache: function() {\n        var time = this._timeDimension.getCurrentTime();\n        for (var prop in this._layers) {\n            if (time != prop && this._layers.hasOwnProperty(prop)) {\n                this._layers[prop].setLoaded(false); // mark it as unloaded\n                this._layers[prop].redraw();\n            }\n        }\n    },\n\n    _evictCachedTimes: function(keepforward, keepbackward) {\n        // Cache management\n        var times = this._getLoadedTimes();\n        var strTime = String(this._currentTime);\n        var index = times.indexOf(strTime);\n        var remove = [];\n        // remove times before current time\n        if (keepbackward > -1) {\n            var objectsToRemove = index - keepbackward;\n            if (objectsToRemove > 0) {\n                remove = times.splice(0, objectsToRemove);\n                this._removeLayers(remove);\n            }\n        }\n        if (keepforward > -1) {\n            index = times.indexOf(strTime);\n            var objectsToRemove = times.length - index - keepforward - 1;\n            if (objectsToRemove > 0) {\n                remove = times.splice(index + keepforward + 1, objectsToRemove);\n                this._removeLayers(remove);\n            }\n        }\n    },\n    _showLayer: function(layer, time) {\n        if (this._currentLayer && this._currentLayer !== layer) {\n            this._currentLayer.hide();\n        }\n        layer.show();\n        if (this._currentLayer && this._currentLayer === layer) {\n            return;\n        }\n        this._currentLayer = layer;\n        this._currentTime = time;\n        \n\n        this._evictCachedTimes(this._timeCacheForward, this._timeCacheBackward);\n    },\n\n    _getLayerForTime: function(time) {\n        if (time == 0 || time == this._defaultTime || time == null) {\n            return this._baseLayer;\n        }\n        if (this._layers.hasOwnProperty(time)) {\n            return this._layers[time];\n        }\n        var nearestTime = this._getNearestTime(time);\n        if (this._layers.hasOwnProperty(nearestTime)) {\n            return this._layers[nearestTime];\n        }\n\n        var newLayer = this._createLayerForTime(nearestTime);\n\n        this._layers[time] = newLayer;\n\n        newLayer.on('load', (function(layer, time) {\n            layer.setLoaded(true);\n            // this time entry should exists inside _layers\n            // but it might be deleted by cache management\n            if (!this._layers[time]) {\n                this._layers[time] = layer;\n            }\n            if (this._timeDimension && time == this._timeDimension.getCurrentTime() && !this._timeDimension.isLoading()) {\n                this._showLayer(layer, time);\n            }\n            // \n            this.fire('timeload', {\n                time: time\n            });\n        }).bind(this, newLayer, time));\n\n        // Hack to hide the layer when added to the map.\n        // It will be shown when timeload event is fired from the map (after all layers are loaded)\n        newLayer.onAdd = (function(map) {\n            Object.getPrototypeOf(this).onAdd.call(this, map);\n            this.hide();\n        }).bind(newLayer);\n        return newLayer;\n    },\n\n    _createLayerForTime:function(time){\n        var wmsParams = this._baseLayer.options;\n        wmsParams.time = new Date(time).toISOString();\n        return new this._baseLayer.constructor(this._baseLayer.getURL(), wmsParams);\n    },\n\n    _getLoadedTimes: function() {\n        var result = [];\n        for (var prop in this._layers) {\n            if (this._layers.hasOwnProperty(prop)) {\n                result.push(prop);\n            }\n        }\n        return result.sort(function(a, b) {\n            return a - b;\n        });\n    },\n\n    _removeLayers: function(times) {\n        for (var i = 0, l = times.length; i < l; i++) {\n            if (this._map)\n                this._map.removeLayer(this._layers[times[i]]);\n            delete this._layers[times[i]];\n        }\n    },\n\n    setMinimumForwardCache: function(value) {\n        if (value > this._timeCacheForward) {\n            this._timeCacheForward = value;\n        }\n    },\n\n    _requestTimeDimensionFromCapabilities: function() {\n        if (this._capabilitiesRequested) {\n            return;\n        }\n        this._capabilitiesRequested = true;\n        var url = this._getCapabilitiesUrl();\n        if (this._proxy) {\n            url = this._proxy + '?url=' + encodeURIComponent(url);\n        }\n        var oReq = new XMLHttpRequest();\n        oReq.addEventListener(\"load\", (function(xhr) {\n            var data = xhr.currentTarget.responseXML;\n            this._defaultTime = Date.parse(this._getDefaultTimeFromCapabilities(data));\n            this._setDefaultTime = this._setDefaultTime || (this._timeDimension && this._timeDimension.getAvailableTimes().length == 0);\n            this.setAvailableTimes(this._parseTimeDimensionFromCapabilities(data));\n            if (this._setDefaultTime && this._timeDimension) {\n                this._timeDimension.setCurrentTime(this._defaultTime);\n            }\n        }).bind(this));\n        oReq.overrideMimeType('application/xml');\n        oReq.open(\"GET\", url);\n        oReq.send();\n    },\n\n    _getCapabilitiesUrl: function() {\n        var url = this._baseLayer.getURL();\n        if (this._getCapabilitiesAlternateUrl)\n            url = this._getCapabilitiesAlternateUrl;\n        var params = L.extend({}, this._getCapabilitiesParams, {\n          'request': 'GetCapabilities',\n          'service': 'WMS',\n          'version': this._wmsVersion\n        });\n        url = url + L.Util.getParamString(params, url, params.uppercase);\n        return url;\n    },\n\n    _parseTimeDimensionFromCapabilities: function(xml) {\n        var layers = xml.querySelectorAll('Layer[queryable=\"1\"]');\n        var layerName = this._baseLayer.wmsParams.layers;\n        var layer = null;\n        var times = null;\n\n        layers.forEach(function(current) {\n            if (current.querySelector(\"Name\").innerHTML === layerName) {\n                layer = current;\n            }\n        })\n        if (layer) {\n            times = this._getTimesFromLayerCapabilities(layer);\n            if (!times) {\n                times = this._getTimesFromLayerCapabilities(layer.parentNode);\n            }\n        }\n\n        return times;\n    },\n\n    _getTimesFromLayerCapabilities: function(layer) {\n        var times = null;\n        var dimensions = layer.querySelectorAll(\"Dimension[name='time']\");\n        if (dimensions && dimensions.length && dimensions[0].textContent.length) {\n            times = dimensions[0].textContent.trim();\n        } else {\n            var extents = layer.querySelectorAll(\"Extent[name='time']\");\n            if (extents && extents.length && extents[0].textContent.length) {\n                times = extents[0].textContent.trim();\n            }\n        }\n        return times;\n    },\n\n    _getDefaultTimeFromCapabilities: function(xml) {\n        var layers = xml.querySelectorAll('Layer[queryable=\"1\"]');\n        var layerName = this._baseLayer.wmsParams.layers;\n        var layer = null;\n        var times = null;\n\n        layers.forEach(function(current) {\n            if (current.querySelector(\"Name\").innerHTML === layerName) {\n                layer = current;\n            }\n        })\n\n        var defaultTime = 0;\n        if (layer) {\n            defaultTime = this._getDefaultTimeFromLayerCapabilities(layer);\n            if (defaultTime == 0) {\n                defaultTime = this._getDefaultTimeFromLayerCapabilities(layer.parentNode);\n            }\n        }\n        return defaultTime;\n    },\n\n    _getDefaultTimeFromLayerCapabilities: function(layer) {\n        var defaultTime = 0;\n        var dimensions = layer.querySelectorAll(\"Dimension[name='time']\");\n        if (dimensions && dimensions.length && dimensions[0].attributes.default) {\n            defaultTime = dimensions[0].attributes.default;\n        } else {\n            var extents = layer.querySelectorAll(\"Extent[name='time']\");\n            if (extents && extents.length && extents[0].attributes.default) {\n                defaultTime = extents[0].attributes.default;\n            }\n        }\n        return defaultTime;\n    },\n\n    setAvailableTimes: function(times) {\n        this._availableTimes = L.TimeDimension.Util.parseTimesExpression(times);\n        this._updateTimeDimensionAvailableTimes();\n    },\n\n    _updateTimeDimensionAvailableTimes: function() {\n        if ((this._timeDimension && this._updateTimeDimension) ||\n            (this._timeDimension && this._timeDimension.getAvailableTimes().length == 0)) {\n            this._timeDimension.setAvailableTimes(this._availableTimes, this._updateTimeDimensionMode);\n            if (this._setDefaultTime && this._defaultTime > 0) {\n                this._timeDimension.setCurrentTime(this._defaultTime);\n            }\n        }\n    },\n\n    _getNearestTime: function(time) {\n        if (this._layers.hasOwnProperty(time)) {\n            return time;\n        }\n        if (this._availableTimes.length == 0) {\n            return time;\n        }\n        var index = 0;\n        var len = this._availableTimes.length;\n        for (; index < len; index++) {\n            if (time < this._availableTimes[index]) {\n                break;\n            }\n        }\n        // We've found the first index greater than the time. Get the previous\n        if (index > 0) {\n            index--;\n        }\n        if (time != this._availableTimes[index]) {\n            \n            \n        }\n        return this._availableTimes[index];\n    },\n\n});\n\nif (!L.NonTiledLayer) {\n    L.NonTiledLayer = (L.Layer || L.Class).extend({});\n}\n\nL.NonTiledLayer.include({\n    _visible: true,\n    _loaded: false,\n\n    _originalUpdate: L.NonTiledLayer.prototype._update,\n    _originalOnRemove: L.NonTiledLayer.prototype.onRemove,\n\n    _update: function() {\n        if (!this._visible && this._loaded) {\n            return;\n        }\n        this._originalUpdate();\n    },\n\n    onRemove: function(map) {\n        this._loaded = false;\n        this._originalOnRemove(map);\n    },\n\n    setLoaded: function(loaded) {\n        this._loaded = loaded;\n    },\n\n    isLoaded: function() {\n        return this._loaded;\n    },\n\n    hide: function() {\n        this._visible = false;\n        this._div.style.display = 'none';\n    },\n\n    show: function() {\n        this._visible = true;\n        this._div.style.display = 'block';\n    },\n\n    getURL: function() {\n        return this._wmsUrl;\n    }\n\n});\n\nL.TileLayer.include({\n    _visible: true,\n    _loaded: false,\n\n    _originalUpdate: L.TileLayer.prototype._update,\n\n    _update: function() {\n        if (!this._visible && this._loaded) {\n            return;\n        }\n        this._originalUpdate();\n    },\n\n    setLoaded: function(loaded) {\n        this._loaded = loaded;\n    },\n\n    isLoaded: function() {\n        return this._loaded;\n    },\n\n    hide: function() {\n        this._visible = false;\n        if (this._container) {\n            this._container.style.display = 'none';\n        }\n    },\n\n    show: function() {\n        this._visible = true;\n        if (this._container) {\n            this._container.style.display = 'block';\n        }\n    },\n\n    getURL: function() {\n        return this._url;\n    }\n\n});\n\nL.timeDimension.layer.wms = function(layer, options) {\n    return new L.TimeDimension.Layer.WMS(layer, options);\n};\n\n/*\n * L.TimeDimension.Layer.GeoJson:\n */\n\nL.TimeDimension.Layer.GeoJson = L.TimeDimension.Layer.extend({\n\n    initialize: function(layer, options) {\n        L.TimeDimension.Layer.prototype.initialize.call(this, layer, options);\n        this._updateTimeDimension = this.options.updateTimeDimension || false;\n        this._updateTimeDimensionMode = this.options.updateTimeDimensionMode || 'extremes'; // 'union', 'replace' or extremes\n        this._duration = this.options.duration || null;\n        this._addlastPoint = this.options.addlastPoint || false;\n        this._waitForReady = this.options.waitForReady || false;\n        this._defaultTime = 0;\n        this._availableTimes = [];\n        this._loaded = false;\n        if (this._baseLayer.getLayers().length == 0) {\n            if (this._waitForReady){\n                this._baseLayer.on(\"ready\", this._onReadyBaseLayer, this);\n            }else{\n                this._loaded = true;\n            }\n        } else {\n            this._loaded = true;\n            this._setAvailableTimes();\n        }\n        // reload available times if data is added to the base layer\n        this._baseLayer.on('layeradd', (function () {\n            if (this._loaded) {\n                this._setAvailableTimes();\n            }\n        }).bind(this));\n    },\n\n    onAdd: function(map) {\n        L.TimeDimension.Layer.prototype.onAdd.call(this, map);\n        if (this._loaded) {\n            this._setAvailableTimes();\n        }\n    },\n\n    eachLayer: function(method, context) {\n        if (this._currentLayer) {\n            method.call(context, this._currentLayer);\n        }\n        return L.TimeDimension.Layer.prototype.eachLayer.call(this, method, context);\n    },\n\n    isReady: function(time) {\n        return this._loaded;\n    },\n\n    _update: function() {\n        if (!this._map)\n            return;\n        if (!this._loaded) {\n            return;\n        }\n\n        var time = this._timeDimension.getCurrentTime();\n\n        var maxTime = this._timeDimension.getCurrentTime(),\n            minTime = 0;\n        if (this._duration) {\n            var date = new Date(maxTime);\n            L.TimeDimension.Util.subtractTimeDuration(date, this._duration, true);\n            minTime = date.getTime();\n        }\n\n        // new coordinates:\n        var layer = L.geoJson(null, this._baseLayer.options);\n        var layers = this._baseLayer.getLayers();\n        for (var i = 0, l = layers.length; i < l; i++) {\n            var feature = this._getFeatureBetweenDates(layers[i].feature, minTime, maxTime);\n            if (feature) {\n                layer.addData(feature);\n                if (this._addlastPoint && feature.geometry.type == \"LineString\") {\n                    if (feature.geometry.coordinates.length > 0) {\n                        var properties = feature.properties;\n                        properties.last = true;\n                        layer.addData({\n                            type: 'Feature',\n                            properties: properties,\n                            geometry: {\n                                type: 'Point',\n                                coordinates: feature.geometry.coordinates[feature.geometry.coordinates.length - 1]\n                            }\n                        });\n                    }\n                }\n            }\n        }\n\n        if (this._currentLayer) {\n            this._map.removeLayer(this._currentLayer);\n        }\n        if (layer.getLayers().length) {\n            layer.addTo(this._map);\n            this._currentLayer = layer;\n        }\n    },\n\n    _setAvailableTimes: function() {\n        var times = [];\n        this._availableTimes = [];\n        var layers = this._baseLayer.getLayers();\n        for (var i = 0, l = layers.length; i < l; i++) {\n            if (layers[i].feature) {\n                times = L.TimeDimension.Util.union_arrays(\n                    times,\n                    this._getFeatureTimes(layers[i].feature)\n                );\n            }\n        }\n        // String dates to ms\n        for (var i = 0, l = times.length; i < l; i++) {\n            var time = times[i]\n            if (typeof time == 'string' || time instanceof String) {\n                time = Date.parse(time.trim());\n            }\n            this._availableTimes.push(time);\n        }\n        if (this._timeDimension && (this._updateTimeDimension || this._timeDimension.getAvailableTimes().length == 0)) {\n            this._timeDimension.setAvailableTimes(this._availableTimes, this._updateTimeDimensionMode);\n        }\n    },\n\n    _getFeatureTimes: function(feature) {\n        if (!feature.properties) {\n            return [];\n        }\n        if (feature.properties.hasOwnProperty('coordTimes')) {\n            return feature.properties.coordTimes;\n        }\n        if (feature.properties.hasOwnProperty('times')) {\n            return feature.properties.times;\n        }\n        if (feature.properties.hasOwnProperty('linestringTimestamps')) {\n            return feature.properties.linestringTimestamps;\n        }\n        if (feature.properties.hasOwnProperty('time')) {\n            return [feature.properties.time];\n        }\n        return [];\n    },\n\n    _getFeatureBetweenDates: function(feature, minTime, maxTime) {\n        var featureStringTimes = this._getFeatureTimes(feature);\n        if (featureStringTimes.length == 0) {\n            return feature;\n        }\n        var featureTimes = [];\n        for (var i = 0, l = featureStringTimes.length; i < l; i++) {\n            var time = featureStringTimes[i]\n            if (typeof time == 'string' || time instanceof String) {\n                time = Date.parse(time.trim());\n            }\n            featureTimes.push(time);\n        }\n\n        if (featureTimes[0] > maxTime || featureTimes[l - 1] < minTime) {\n            return null;\n        }\n        var index_min = null,\n            index_max = null,\n            l = featureTimes.length;\n        if (featureTimes[l - 1] > minTime) {\n            for (var i = 0; i < l; i++) {\n                if (index_min === null && featureTimes[i] > minTime) {\n                    // set index_min the first time that current time is greater the minTime\n                    index_min = i;\n                }\n                if (featureTimes[i] > maxTime) {\n                    index_max = i;\n                    break;\n                }\n            }\n        }\n        if (index_min === null) {\n            index_min = 0;\n        }\n        if (index_max === null) {\n            index_max = l;\n        }\n        var new_coordinates = [];\n        if (feature.geometry.coordinates[0].length) {\n            new_coordinates = feature.geometry.coordinates.slice(index_min, index_max);\n        } else {\n            new_coordinates = feature.geometry.coordinates;\n        }\n        return {\n            type: 'Feature',\n            properties: feature.properties,\n            geometry: {\n                type: feature.geometry.type,\n                coordinates: new_coordinates\n            }\n        };\n    },\n\n    _onReadyBaseLayer: function() {\n        this._loaded = true;\n        this._setAvailableTimes();\n        this._update();\n    },\n\n});\n\nL.timeDimension.layer.geoJson = function(layer, options) {\n    return new L.TimeDimension.Layer.GeoJson(layer, options);\n};\n\n/*jshint indent: 4, browser:true*/\n/*global L*/\n\n\n/*\n * L.TimeDimension.Player\n */\n//'use strict';\nL.TimeDimension.Player = (L.Layer || L.Class).extend({\n\n    includes: (L.Evented || L.Mixin.Events),\n    initialize: function(options, timeDimension) {\n        L.setOptions(this, options);\n        this._timeDimension = timeDimension;\n        this._paused = false;\n        this._buffer = this.options.buffer || 5;\n        this._minBufferReady = this.options.minBufferReady || 1;\n        this._waitingForBuffer = false;\n        this._loop = this.options.loop || false;\n        this._steps = 1;\n        this._timeDimension.on('timeload', (function(data) {\n            this.release(); // free clock\n            this._waitingForBuffer = false; // reset buffer\n        }).bind(this));\n        this.setTransitionTime(this.options.transitionTime || 1000);\n        \n        this._timeDimension.on('limitschanged availabletimeschanged timeload', (function(data) {\n            this._timeDimension.prepareNextTimes(this._steps, this._minBufferReady, this._loop);\n        }).bind(this));\n    },\n\n\n    _tick: function() {\n        var maxIndex = this._getMaxIndex();\n        var maxForward = (this._timeDimension.getCurrentTimeIndex() >= maxIndex) && (this._steps > 0);\n        var maxBackward = (this._timeDimension.getCurrentTimeIndex() == 0) && (this._steps < 0);\n        if (maxForward || maxBackward) {\n            // we reached the last step\n            if (!this._loop) {\n                this.pause();\n                this.stop();\n                this.fire('animationfinished');\n                return;\n            }\n        }\n\n        if (this._paused) {\n            return;\n        }\n        var numberNextTimesReady = 0,\n            buffer = this._bufferSize;\n\n        if (this._minBufferReady > 0) {\n            numberNextTimesReady = this._timeDimension.getNumberNextTimesReady(this._steps, buffer, this._loop);\n            // If the player was waiting, check if all times are loaded\n            if (this._waitingForBuffer) {\n                if (numberNextTimesReady < buffer) {\n                    \n                    this.fire('waiting', {\n                        buffer: buffer,\n                        available: numberNextTimesReady\n                    });\n                    return;\n                } else {\n                    // all times loaded\n                    \n                    this.fire('running');\n                    this._waitingForBuffer = false;\n                }\n            } else {\n                // check if player has to stop to wait and force to full all the buffer\n                if (numberNextTimesReady < this._minBufferReady) {\n                    \n                    this._waitingForBuffer = true;\n                    this._timeDimension.prepareNextTimes(this._steps, buffer, this._loop);\n                    this.fire('waiting', {\n                        buffer: buffer,\n                        available: numberNextTimesReady\n                    });\n                    return;\n                }\n            }\n        }\n        this.pause();\n        this._timeDimension.nextTime(this._steps, this._loop);\n        if (buffer > 0) {\n            this._timeDimension.prepareNextTimes(this._steps, buffer, this._loop);\n        }\n    },\n    \n    _getMaxIndex: function(){\n       return Math.min(this._timeDimension.getAvailableTimes().length - 1, \n                       this._timeDimension.getUpperLimitIndex() || Infinity);\n    },\n\n    start: function(numSteps) {\n        if (this._intervalID) return;\n        this._steps = numSteps || 1;\n        this._waitingForBuffer = false;\n        if (this.options.startOver){\n            if (this._timeDimension.getCurrentTimeIndex() === this._getMaxIndex()){\n                 this._timeDimension.setCurrentTimeIndex(this._timeDimension.getLowerLimitIndex() || 0);\n            }\n        }\n        this.release();\n        this._intervalID = window.setInterval(\n            L.bind(this._tick, this),\n            this._transitionTime);\n        this._tick();\n        this.fire('play');\n        this.fire('running');\n    },\n\n    stop: function() {\n        if (!this._intervalID) return;\n        clearInterval(this._intervalID);\n        this._intervalID = null;\n        this._waitingForBuffer = false;\n        this.fire('stop');\n    },\n\n    pause: function() {\n        this._paused = true;\n    },\n\n    release: function () {\n        this._paused = false;\n    },\n\n    getTransitionTime: function() {\n        return this._transitionTime;\n    },\n\n    isPlaying: function() {\n        return this._intervalID ? true : false;\n    },\n\n    isWaiting: function() {\n        return this._waitingForBuffer;\n    },\n    isLooped: function() {\n        return this._loop;\n    },\n\n    setLooped: function(looped) {\n        this._loop = looped;\n        this.fire('loopchange', {\n            loop: looped\n        });\n    },\n\n    setTransitionTime: function(transitionTime) {\n        this._transitionTime = transitionTime;\n        if (typeof this._buffer === 'function') {\n            this._bufferSize = this._buffer.call(this, this._transitionTime, this._minBufferReady, this._loop);\n            \n        } else {\n            this._bufferSize = this._buffer;\n        }\n        if (this._intervalID) {\n            this.stop();\n            this.start(this._steps);\n        }\n        this.fire('speedchange', {\n            transitionTime: transitionTime,\n            buffer: this._bufferSize\n        });\n    },\n\n    getSteps: function() {\n        return this._steps;\n    }\n});\n\n/*jshint indent: 4, browser:true*/\n/*global L*/\n\n/*\n * L.Control.TimeDimension: Leaflet control to manage a timeDimension\n */\n\nL.UI = L.ui = L.UI || {};\nL.UI.Knob = L.Draggable.extend({\n    options: {\n        className: 'knob',\n        step: 1,\n        rangeMin: 0,\n        rangeMax: 10\n            //minValue : null,\n            //maxValue : null\n    },\n    initialize: function(slider, options) {\n        L.setOptions(this, options);\n        this._element = L.DomUtil.create('div', this.options.className || 'knob', slider);\n        L.Draggable.prototype.initialize.call(this, this._element, this._element);\n        this._container = slider;\n        this.on('predrag', function() {\n            this._newPos.y = 0;\n            this._newPos.x = this._adjustX(this._newPos.x);\n        }, this);\n        this.on('dragstart', function() {\n            L.DomUtil.addClass(slider, 'dragging');\n        });\n        this.on('dragend', function() {\n            L.DomUtil.removeClass(slider, 'dragging');\n        });\n        L.DomEvent.on(this._element, 'dblclick', function(e) {\n            this.fire('dblclick', e);\n        }, this);\n        L.DomEvent.disableClickPropagation(this._element);\n        this.enable();\n    },\n\n    _getProjectionCoef: function() {\n        return (this.options.rangeMax - this.options.rangeMin) / (this._container.offsetWidth || this._container.style.width);\n    },\n    _update: function() {\n        this.setPosition(L.DomUtil.getPosition(this._element).x);\n    },\n    _adjustX: function(x) {\n        var value = this._toValue(x) || this.getMinValue();\n        return this._toX(this._adjustValue(value));\n    },\n\n    _adjustValue: function(value) {\n        value = Math.max(this.getMinValue(), Math.min(this.getMaxValue(), value)); //clamp value\n        value = value - this.options.rangeMin; //offsets to zero\n\n        //snap the value to the closet step\n        value = Math.round(value / this.options.step) * this.options.step;\n        value = value + this.options.rangeMin; //restore offset\n        value = Math.round(value * 100) / 100; // *100/100 to avoid floating point precision problems\n\n        return value;\n    },\n\n    _toX: function(value) {\n        var x = (value - this.options.rangeMin) / this._getProjectionCoef();\n        //\n        return x;\n    },\n\n    _toValue: function(x) {\n        var v = x * this._getProjectionCoef() + this.options.rangeMin;\n        //\n        return v;\n    },\n\n    getMinValue: function() {\n        return this.options.minValue || this.options.rangeMin;\n    },\n    getMaxValue: function() {\n        return this.options.maxValue || this.options.rangeMax;\n    },\n\n    setStep: function(step) {\n        this.options.step = step;\n        this._update();\n    },\n\n    setPosition: function(x) {\n        L.DomUtil.setPosition(this._element,\n            L.point(this._adjustX(x), 0));\n        this.fire('positionchanged');\n    },\n    getPosition: function() {\n        return L.DomUtil.getPosition(this._element).x;\n    },\n\n    setValue: function(v) {\n        //\n        this.setPosition(this._toX(v));\n    },\n\n    getValue: function() {\n        return this._adjustValue(this._toValue(this.getPosition()));\n    }\n});\n\n\n/*\n * L.Control.TimeDimension: Leaflet control to manage a timeDimension\n */\n\nL.Control.TimeDimension = L.Control.extend({\n    options: {\n        styleNS: 'leaflet-control-timecontrol',\n        position: 'bottomleft',\n        title: 'Time Control',\n        backwardButton: true,\n        forwardButton: true,\n        playButton: true,\n        playReverseButton: false,\n        loopButton: false,\n        displayDate: true,\n        timeSlider: true,\n        timeSliderDragUpdate: false,\n        limitSliders: false,\n        limitMinimumRange: 5,\n        speedSlider: true,\n        minSpeed: 0.1,\n        maxSpeed: 10,\n        speedStep: 0.1,\n        timeSteps: 1,\n        autoPlay: false,\n        playerOptions: {\n            transitionTime: 1000\n        }\n    },\n\n    initialize: function(options) {\n        L.Control.prototype.initialize.call(this, options);\n        this._dateUTC = true;\n        this._timeDimension = this.options.timeDimension || null;\n    },\n\n    onAdd: function(map) {\n        var container;\n        this._map = map;\n        if (!this._timeDimension && map.timeDimension) {\n            this._timeDimension = map.timeDimension;\n        }\n        this._initPlayer();\n\n        container = L.DomUtil.create('div', 'leaflet-bar leaflet-bar-horizontal leaflet-bar-timecontrol');\n        if (this.options.backwardButton) {\n            this._buttonBackward = this._createButton('Backward', container);\n        }\n        if (this.options.playReverseButton) {\n            this._buttonPlayReversePause = this._createButton('Play Reverse', container);\n        }\n        if (this.options.playButton) {\n            this._buttonPlayPause = this._createButton('Play', container);\n        }\n        if (this.options.forwardButton) {\n            this._buttonForward = this._createButton('Forward', container);\n        }\n        if (this.options.loopButton) {\n            this._buttonLoop = this._createButton('Loop', container);\n        }\n        if (this.options.displayDate) {\n            this._displayDate = this._createButton('Date', container);\n        }\n        if (this.options.timeSlider) {\n            this._sliderTime = this._createSliderTime(this.options.styleNS + ' timecontrol-slider timecontrol-dateslider', container);\n        }\n        if (this.options.speedSlider) {\n            this._sliderSpeed = this._createSliderSpeed(this.options.styleNS + ' timecontrol-slider timecontrol-speed', container);\n        }\n\n        this._steps = this.options.timeSteps || 1;\n\n        this._timeDimension.on('timeload',  this._update, this);\n        this._timeDimension.on('timeload',  this._onPlayerStateChange, this);\n        this._timeDimension.on('timeloading', this._onTimeLoading, this);\n\n        this._timeDimension.on('limitschanged availabletimeschanged', this._onTimeLimitsChanged, this);\n\n        L.DomEvent.disableClickPropagation(container);\n\n        return container;\n    },\n    addTo: function() {\n        //To be notified AFTER the component was added to the DOM\n        L.Control.prototype.addTo.apply(this, arguments);\n        this._onPlayerStateChange();\n        this._onTimeLimitsChanged();\n        this._update();\n        return this;\n    },\n    onRemove: function() {\n        this._player.off('play stop running loopchange speedchange', this._onPlayerStateChange, this);\n        this._player.off('waiting', this._onPlayerWaiting, this);\n        //this._player = null;  keep it for later re-add\n\n        this._timeDimension.off('timeload',  this._update, this);\n        this._timeDimension.off('timeload',  this._onPlayerStateChange, this);\n        this._timeDimension.off('timeloading', this._onTimeLoading, this);\n        this._timeDimension.off('limitschanged availabletimeschanged', this._onTimeLimitsChanged, this);\n    },\n\n    _initPlayer: function() {\n        if (!this._player){ // in case of remove/add\n            if (this.options.player) {\n                this._player = this.options.player;\n            } else {\n                this._player = new L.TimeDimension.Player(this.options.playerOptions, this._timeDimension);\n            }\n        }\n        if (this.options.autoPlay) {\n            this._player.start(this._steps);\n        }\n        this._player.on('play stop running loopchange speedchange', this._onPlayerStateChange, this);\n        this._player.on('waiting', this._onPlayerWaiting, this);\n        this._onPlayerStateChange();\n    },\n\n    _onTimeLoading : function(data) {\n        if (data.time == this._timeDimension.getCurrentTime()) {\n            if (this._displayDate) {\n                L.DomUtil.addClass(this._displayDate, 'loading');\n            }\n        }\n    },\n\n    _onTimeLimitsChanged: function() {\n        var lowerIndex = this._timeDimension.getLowerLimitIndex(),\n            upperIndex = this._timeDimension.getUpperLimitIndex(),\n            max = this._timeDimension.getAvailableTimes().length - 1;\n\n        if (this._limitKnobs) {\n            this._limitKnobs[0].options.rangeMax = max;\n            this._limitKnobs[1].options.rangeMax = max;\n            this._limitKnobs[0].setValue(lowerIndex || 0);\n            this._limitKnobs[1].setValue(upperIndex || max);\n        }\n        if (this._sliderTime) {\n            this._sliderTime.options.rangeMax = max;\n            this._sliderTime._update();\n        }\n    },\n\n    _onPlayerWaiting: function(evt) {\n        if (this._buttonPlayPause && this._player.getSteps() > 0) {\n            L.DomUtil.addClass(this._buttonPlayPause, 'loading');\n            this._buttonPlayPause.innerHTML = this._getDisplayLoadingText(evt.available, evt.buffer);\n        }\n        if (this._buttonPlayReversePause && this._player.getSteps() < 0) {\n            L.DomUtil.addClass(this._buttonPlayReversePause, 'loading');\n            this._buttonPlayReversePause.innerHTML = this._getDisplayLoadingText(evt.available, evt.buffer);\n        }\n    },\n    _onPlayerStateChange: function() {\n        if (this._buttonPlayPause) {\n            if (this._player.isPlaying() && this._player.getSteps() > 0) {\n                L.DomUtil.addClass(this._buttonPlayPause, 'pause');\n                L.DomUtil.removeClass(this._buttonPlayPause, 'play');\n            } else {\n                L.DomUtil.removeClass(this._buttonPlayPause, 'pause');\n                L.DomUtil.addClass(this._buttonPlayPause, 'play');\n            }\n            if (this._player.isWaiting() && this._player.getSteps() > 0) {\n                L.DomUtil.addClass(this._buttonPlayPause, 'loading');\n            } else {\n                this._buttonPlayPause.innerHTML = '';\n                L.DomUtil.removeClass(this._buttonPlayPause, 'loading');\n            }\n        }\n        if (this._buttonPlayReversePause) {\n            if (this._player.isPlaying() && this._player.getSteps() < 0) {\n                L.DomUtil.addClass(this._buttonPlayReversePause, 'pause');\n            } else {\n                L.DomUtil.removeClass(this._buttonPlayReversePause, 'pause');\n            }\n            if (this._player.isWaiting() && this._player.getSteps() < 0) {\n                L.DomUtil.addClass(this._buttonPlayReversePause, 'loading');\n            } else {\n                this._buttonPlayReversePause.innerHTML = '';\n                L.DomUtil.removeClass(this._buttonPlayReversePause, 'loading');\n            }\n        }\n        if (this._buttonLoop) {\n            if (this._player.isLooped()) {\n                L.DomUtil.addClass(this._buttonLoop, 'looped');\n            } else {\n                L.DomUtil.removeClass(this._buttonLoop, 'looped');\n            }\n        }\n        if (this._sliderSpeed && !this._draggingSpeed) {\n            var speed =  this._player.getTransitionTime() || 1000;//transitionTime\n            speed = Math.round(10000 / speed) /10; // 1s / transition\n            this._sliderSpeed.setValue(speed);\n        }\n    },\n\n    _update: function() {\n        if (!this._timeDimension) {\n            return;\n        }\n        if (this._timeDimension.getCurrentTimeIndex() >= 0) {\n            var date = new Date(this._timeDimension.getCurrentTime());\n            if (this._displayDate) {\n                L.DomUtil.removeClass(this._displayDate, 'loading');\n                this._displayDate.innerHTML = this._getDisplayDateFormat(date);\n            }\n            if (this._sliderTime && !this._slidingTimeSlider) {\n                this._sliderTime.setValue(this._timeDimension.getCurrentTimeIndex());\n            }\n        } else {\n            if (this._displayDate) {\n                this._displayDate.innerHTML = this._getDisplayNoTimeError();\n            }\n        }\n    },\n\n    _createButton: function(title, container) {\n        var link = L.DomUtil.create('a', this.options.styleNS + ' timecontrol-' + title.toLowerCase(), container);\n        link.href = '#';\n        link.title = title;\n\n        L.DomEvent\n            .addListener(link, 'click', L.DomEvent.stopPropagation)\n            .addListener(link, 'click', L.DomEvent.preventDefault)\n            .addListener(link, 'click', this['_button' + title.replace(/ /i, '') + 'Clicked'], this);\n\n        return link;\n    },\n\n    _createSliderTime: function(className, container) {\n        var sliderContainer,\n            sliderbar,\n            max,\n            knob, limits;\n        sliderContainer = L.DomUtil.create('div', className, container);\n        /*L.DomEvent\n            .addListener(sliderContainer, 'click', L.DomEvent.stopPropagation)\n            .addListener(sliderContainer, 'click', L.DomEvent.preventDefault);*/\n\n        sliderbar = L.DomUtil.create('div', 'slider', sliderContainer);\n        max = this._timeDimension.getAvailableTimes().length - 1;\n\n        if (this.options.limitSliders) {\n            limits = this._limitKnobs = this._createLimitKnobs(sliderbar);\n        }\n        knob = new L.UI.Knob(sliderbar, {\n            className: 'knob main',\n            rangeMin: 0,\n            rangeMax: max\n        });\n        knob.on('dragend', function(e) {\n            var value = e.target.getValue();\n            this._sliderTimeValueChanged(value);\n            this._slidingTimeSlider = false;\n        }, this);\n        knob.on('drag', function(e) {\n            this._slidingTimeSlider = true;\n            var time = this._timeDimension.getAvailableTimes()[e.target.getValue()];\n            if (time) {\n                var date = new Date(time);\n                if (this._displayDate) {\n                  this._displayDate.innerHTML = this._getDisplayDateFormat(date);\n                }\n                if (this.options.timeSliderDragUpdate){\n                    this._sliderTimeValueChanged(e.target.getValue());\n                }\n            }\n        }, this);\n\n        knob.on('predrag', function() {\n            var minPosition, maxPosition;\n            if (limits) {\n                //limits the position between lower and upper knobs\n                minPosition = limits[0].getPosition();\n                maxPosition = limits[1].getPosition();\n                if (this._newPos.x < minPosition) {\n                    this._newPos.x = minPosition;\n                }\n                if (this._newPos.x > maxPosition) {\n                    this._newPos.x = maxPosition;\n                }\n            }\n        }, knob);\n        L.DomEvent.on(sliderbar, 'click', function(e) {\n            if (L.DomUtil.hasClass(e.target, 'knob')) {\n                return; //prevent value changes on drag release\n            }\n            var first = (e.touches && e.touches.length === 1 ? e.touches[0] : e),\n                x = L.DomEvent.getMousePosition(first, sliderbar).x;\n            if (limits) { // limits exits\n                if (limits[0].getPosition() <= x && x <= limits[1].getPosition()) {\n                    knob.setPosition(x);\n                    this._sliderTimeValueChanged(knob.getValue());\n                }\n            } else {\n                knob.setPosition(x);\n                this._sliderTimeValueChanged(knob.getValue());\n            }\n\n        }, this);\n        knob.setPosition(0);\n\n        return knob;\n    },\n\n\n    _createLimitKnobs: function(sliderbar) {\n        L.DomUtil.addClass(sliderbar, 'has-limits');\n        var max = this._timeDimension.getAvailableTimes().length - 1;\n        var rangeBar = L.DomUtil.create('div', 'range', sliderbar);\n        var lknob = new L.UI.Knob(sliderbar, {\n            className: 'knob lower',\n            rangeMin: 0,\n            rangeMax: max\n        });\n        var uknob = new L.UI.Knob(sliderbar, {\n            className: 'knob upper',\n            rangeMin: 0,\n            rangeMax: max\n        });\n\n\n        L.DomUtil.setPosition(rangeBar, 0);\n        lknob.setPosition(0);\n        uknob.setPosition(max);\n\n        //Add listeners for value changes\n        lknob.on('dragend', function(e) {\n            var value = e.target.getValue();\n            this._sliderLimitsValueChanged(value, uknob.getValue());\n        }, this);\n        uknob.on('dragend', function(e) {\n            var value = e.target.getValue();\n            this._sliderLimitsValueChanged(lknob.getValue(), value);\n        }, this);\n\n        //Add listeners to position the range bar\n        lknob.on('drag positionchanged', function() {\n            L.DomUtil.setPosition(rangeBar, L.point(lknob.getPosition(), 0));\n            rangeBar.style.width = uknob.getPosition() - lknob.getPosition() + 'px';\n        }, this);\n\n        uknob.on('drag positionchanged', function() {\n            rangeBar.style.width = uknob.getPosition() - lknob.getPosition() + 'px';\n        }, this);\n\n        //Add listeners to prevent overlaps\n        uknob.on('predrag', function() {\n            //bond upper to lower\n            var lowerPosition = lknob._toX(lknob.getValue() + this.options.limitMinimumRange);\n            if (uknob._newPos.x <= lowerPosition) {\n                uknob._newPos.x = lowerPosition;\n            }\n        }, this);\n\n        lknob.on('predrag', function() {\n            //bond lower to upper\n            var upperPosition = uknob._toX(uknob.getValue() - this.options.limitMinimumRange);\n            if (lknob._newPos.x >= upperPosition) {\n                lknob._newPos.x = upperPosition;\n            }\n        }, this);\n\n        lknob.on('dblclick', function() {\n            this._timeDimension.setLowerLimitIndex(0);\n        }, this);\n        uknob.on('dblclick', function() {\n            this._timeDimension.setUpperLimitIndex(this._timeDimension.getAvailableTimes().length - 1);\n        }, this);\n\n        return [lknob, uknob];\n    },\n\n\n    _createSliderSpeed: function(className, container) {\n        var sliderContainer = L.DomUtil.create('div', className, container);\n        /* L.DomEvent\n            .addListener(sliderContainer, 'click', L.DomEvent.stopPropagation)\n            .addListener(sliderContainer, 'click', L.DomEvent.preventDefault);\n*/\n        var speedLabel = L.DomUtil.create('span', 'speed', sliderContainer);\n        var sliderbar = L.DomUtil.create('div', 'slider', sliderContainer);\n        var initialSpeed = Math.round(10000 / (this._player.getTransitionTime() || 1000)) / 10;\n        speedLabel.innerHTML = this._getDisplaySpeed(initialSpeed);\n\n        var knob = new L.UI.Knob(sliderbar, {\n            step: this.options.speedStep,\n            rangeMin: this.options.minSpeed,\n            rangeMax: this.options.maxSpeed\n        });\n\n        knob.on('dragend', function(e) {\n            var value = e.target.getValue();\n            this._draggingSpeed = false;\n            speedLabel.innerHTML = this._getDisplaySpeed(value);\n            this._sliderSpeedValueChanged(value);\n        }, this);\n        knob.on('drag', function(e) {\n            this._draggingSpeed = true;\n            speedLabel.innerHTML = this._getDisplaySpeed(e.target.getValue());\n        }, this);\n         knob.on('positionchanged', function (e) {\n            speedLabel.innerHTML = this._getDisplaySpeed(e.target.getValue());\n        }, this);\n\n        L.DomEvent.on(sliderbar, 'click', function(e) {\n            if (e.target === knob._element) {\n                return; //prevent value changes on drag release\n            }\n            var first = (e.touches && e.touches.length === 1 ? e.touches[0] : e),\n                x = L.DomEvent.getMousePosition(first, sliderbar).x;\n            knob.setPosition(x);\n            speedLabel.innerHTML = this._getDisplaySpeed(knob.getValue());\n            this._sliderSpeedValueChanged(knob.getValue());\n        }, this);\n        return knob;\n    },\n\n    _buttonBackwardClicked: function() {\n        this._timeDimension.previousTime(this._steps);\n    },\n\n    _buttonForwardClicked: function() {\n        this._timeDimension.nextTime(this._steps);\n    },\n    _buttonLoopClicked: function() {\n        this._player.setLooped(!this._player.isLooped());\n    },\n\n    _buttonPlayClicked: function() {\n        if (this._player.isPlaying()) {\n            this._player.stop();\n        } else {\n            this._player.start(this._steps);\n        }\n    },\n\n    _buttonPlayReverseClicked: function() {\n        if (this._player.isPlaying()) {\n            this._player.stop();\n        } else {\n            this._player.start(this._steps * (-1));\n        }\n    },\n\n    _buttonDateClicked: function(){\n        this._toggleDateUTC();\n    },\n\n    _sliderTimeValueChanged: function(newValue) {\n        this._timeDimension.setCurrentTimeIndex(newValue);\n    },\n\n    _sliderLimitsValueChanged: function(lowerLimit, upperLimit) {\n        this._timeDimension.setLowerLimitIndex(lowerLimit);\n        this._timeDimension.setUpperLimitIndex(upperLimit);\n    },\n\n    _sliderSpeedValueChanged: function(newValue) {\n        this._player.setTransitionTime(1000 / newValue);\n    },\n\n    _toggleDateUTC: function() {\n        if (this._dateUTC) {\n            L.DomUtil.removeClass(this._displayDate, 'utc');\n            this._displayDate.title = 'Local Time';\n        } else {\n            L.DomUtil.addClass(this._displayDate, 'utc');\n            this._displayDate.title = 'UTC Time';\n        }\n        this._dateUTC = !this._dateUTC;\n        this._update();\n    },\n\n    _getDisplayDateFormat: function(date) {\n        return this._dateUTC ? date.toISOString() : date.toLocaleString();\n    },\n    _getDisplaySpeed: function(fps) {\n        return fps + 'fps';\n    },\n    _getDisplayLoadingText: function(available, buffer) {\n        return '<span>' + Math.floor(available / buffer * 100) + '%</span>';\n    },\n    _getDisplayNoTimeError: function() {\n        return 'Time not available';\n    }\n\n});\n\nL.Map.addInitHook(function() {\n    if (this.options.timeDimensionControl) {\n        this.timeDimensionControl = L.control.timeDimension(this.options.timeDimensionControlOptions || {});\n        this.addControl(this.timeDimensionControl);\n    }\n});\n\nL.control.timeDimension = function(options) {\n    return new L.Control.TimeDimension(options);\n};\n","\n\nimport jQuery from \"jquery\";\nimport Q from \"q\";\n\nimport * as L from 'leaflet';\nimport { TileLayer, tileLayer } from 'leaflet';\nimport 'leaflet-timedimension/dist/leaflet.timedimension.src';\n// import { TimeDimension, timeDimension } from \"../libs/L.TimeDimension\";\n\nimport {Config} from 'geoplatform.client';\n\nimport WMS from './wms';\n\n\n\nclass WMST extends L.TimeDimension.Layer.WMS {\n\n    constructor(layer, opts) {\n        super(layer, opts);\n    }\n\n    //override default parser to query all Layers (whether queryable or not)\n    _parseTimeDimensionFromCapabilities (xml) {\n        var layers = xml.querySelectorAll('Layer');\n        var layerName = this._baseLayer.wmsParams.layers;\n        var layer = null;\n        var times = null;\n\n        layers.forEach(function(current) {\n            if (current.querySelector(\"Name\").innerHTML === layerName) {\n                layer = current;\n            }\n        });\n        if (layer) {\n            times = this._getTimesFromLayerCapabilities(layer);\n            if (!times) {\n                times = this._getTimesFromLayerCapabilities(layer.parentNode);\n            }\n        }\n\n        return times;\n    }\n\n    //override default parser to fall back if Dimension is provided but has no values\n    _getTimesFromLayerCapabilities (layer) {\n        var times = null;\n        var dimensions = layer.querySelectorAll(\"Dimension[name='time']\");\n        if (dimensions && dimensions.length && dimensions[0].textContent.length) {\n            times = dimensions[0].textContent.trim();\n        }\n        if(!times || !times.length) {\n            var extents = layer.querySelectorAll(\"Extent[name='time']\");\n            if (extents && extents.length && extents[0].textContent.length) {\n                times = extents[0].textContent.trim();\n            }\n        }\n        if(times && ~times.indexOf(\"current\")) {\n            times = times.replace('current', new Date().toISOString());\n        }\n        return times;\n    }\n\n}\n\n\n\n\nfunction wmst(gpLayer) {\n\n    let service = gpLayer.services[0];\n    let url = service.href;\n\n    if(!url) {\n        throw new Error(\"WMST Layer's service does not defined a service url\");\n    }\n\n    let opts = {\n        layers      : gpLayer.layerName,\n        transparent : true,\n        format      : \"image/png\",\n        wmvId       : gpLayer.layerId\n    };\n    if(Config.leafletPane)\n        opts.pane = Config.leafletPane;\n\n    let leafletLayer = new WMS( url, opts );\n\n    let proxyUrl = Config.ualUrl + '/api/services/' +\n        service.id + '/proxy/capabilities';\n\n    let tdOpts = { times : null };\n\n    if(gpLayer.temporal) {\n\n        let d1 = gpLayer.temporal.startDate ?\n            new Date(gpLayer.temporal.startDate) : new Date();\n        let d2 = gpLayer.temporal.endDate ?\n            new Date(gpLayer.temporal.endDate) : new Date();\n\n        tdOpts.times = d1.toISOString() + '/' + d2.toISOString() + '/P1D';\n    }\n\n    return new WMST(leafletLayer, {\n        timeDimension: new L.TimeDimension(tdOpts),\n        proxy: proxyUrl\n    });\n}\n\n/*L.*/TileLayer.WMST = WMST;\n/*L.*/tileLayer.wmst = wmst;\n\nexport {\n    WMST as default,\n    WMST,\n    wmst\n};\n\n\n\n// import * as TimeDimension from 'leaflet-timedimension/dist/leaflet.timedimension.min';\n// // import { TimeDimension, timeDimension } from \"../libs/L.TimeDimension\";\n//\n// import {Config} from 'geoplatform.client';\n//\n//\n// // function tdPolyFill(options) {\n// //     return new WMST(options);\n// // }\n// //\n// // var TimeDimension = L.TimeDimension;\n// // var timeDimension = L.timeDimension || tdPolyFill;\n//\n// var WMST = (TimeDimension && TimeDimension.Layer || TileLayer).WMS.extend({\n//\n//     //override default parser to query all Layers (whether queryable or not)\n//     _parseTimeDimensionFromCapabilities: function(xml) {\n//         var layers = xml.querySelectorAll('Layer');\n//         var layerName = this._baseLayer.wmsParams.layers;\n//         var layer = null;\n//         var times = null;\n//\n//         layers.forEach(function(current) {\n//             if (current.querySelector(\"Name\").innerHTML === layerName) {\n//                 layer = current;\n//             }\n//         });\n//         if (layer) {\n//             times = this._getTimesFromLayerCapabilities(layer);\n//             if (!times) {\n//                 times = this._getTimesFromLayerCapabilities(layer.parentNode);\n//             }\n//         }\n//\n//         return times;\n//     },\n//\n//     //override default parser to fall back if Dimension is provided but has no values\n//     _getTimesFromLayerCapabilities: function(layer) {\n//         var times = null;\n//         var dimensions = layer.querySelectorAll(\"Dimension[name='time']\");\n//         if (dimensions && dimensions.length && dimensions[0].textContent.length) {\n//             times = dimensions[0].textContent.trim();\n//         }\n//         if(!times || !times.length) {\n//             var extents = layer.querySelectorAll(\"Extent[name='time']\");\n//             if (extents && extents.length && extents[0].textContent.length) {\n//                 times = extents[0].textContent.trim();\n//             }\n//         }\n//         if(times && ~times.indexOf(\"current\")) {\n//             times = times.replace('current', new Date().toISOString());\n//         }\n//         return times;\n//     }\n//\n// });\n//\n//\n//\n//\n// function wmst(gpLayer) {\n//\n//     let service = gpLayer.services[0];\n//     let url = service.href;\n//\n//     if(!url) {\n//         throw new Error(\"WMST Layer's service does not defined a service url\");\n//     }\n//\n//     let opts = {\n//         layers: gpLayer.layerName,\n//         transparent: true,\n//         format: \"image/png\",\n//         wmvId: gpLayer.layerId\n//     };\n//     if(Config.leafletPane)\n//         opts.pane = Config.leafletPane;\n//\n//     let leafletLayer = new TileLayer.CustomWMS( url, opts );\n//\n//     let proxyUrl = Config.ualUrl + '/api/services/' +\n//         service.id + '/proxy/capabilities';\n//\n//     let tdOpts = {};\n//\n//     if(gpLayer.temporal) {\n//\n//         let d1 = gpLayer.temporal.startDate ?\n//             new Date(gpLayer.temporal.startDate) : new Date();\n//         let d2 = gpLayer.temporal.endDate ?\n//             new Date(gpLayer.temporal.endDate) : new Date();\n//\n//         tdOpts.times = d1.toISOString() + '/' + d2.toISOString() + '/P1D';\n//     }\n//\n//     return new WMST(leafletLayer, {\n//         timeDimension: timeDimension(tdOpts),\n//         proxy: proxyUrl\n//     });\n// }\n//\n//\n// TileLayer.WMST = WMST;\n// tileLayer.wmst = wmst;\n//\n// export {\n//     WMST as default,\n//     WMST,\n//     wmst\n// };\n","\n\nimport jQuery from \"jquery\";\nimport Q from \"q\";\nimport {\n    TileLayer, tileLayer,\n    Browser, extend, setOptions,\n    Point, Util, LatLng\n} from 'leaflet';\n\nimport {Config} from 'geoplatform.client';\n\n\nif (typeof Object.assign != 'function') {\n    // Must be writable: true, enumerable: false, configurable: true\n    Object.defineProperty(Object, \"assign\", {\n        value: function assign(target, varArgs) { // .length of function is 2\n            'use strict';\n            if (target == null) { // TypeError if undefined or null\n                throw new TypeError('Cannot convert undefined or null to object');\n            }\n\n            var to = Object(target);\n\n            for (var index = 1; index < arguments.length; index++) {\n                var nextSource = arguments[index];\n\n                if (nextSource != null) { // Skip over if undefined or null\n                    for (var nextKey in nextSource) {\n                        // Avoid bugs when hasOwnProperty is shadowed\n                        if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n                            to[nextKey] = nextSource[nextKey];\n                        }\n                    }\n                }\n            }\n            return to;\n        },\n        writable: true,\n        configurable: true\n    });\n}\n\n\nconst paramRe = /\\{ *([\\w_-]+) *\\}/g;\n\n// @function template(str: String, data: Object): String\n// Simple templating facility, accepts a template string of the form `'Hello {a}, {b}'`\n// and a data object like `{a: 'foo', b: 'bar'}`, returns evaluated string\n// `('Hello foo, bar')`. You can also specify functions instead of strings for\n// data values  they will be evaluated passing `data` as an argument.\nfunction template(str, data) {\n\treturn str.replace(paramRe, function (str, key) {\n\t\tvar value = data[key];\n        if (value === undefined) {\n            value = data[key.toLowerCase()];\n        }\n        if (value === undefined) {\n        \tthrow new Error('No value provided for variable ' + str);\n\t\t} else if (typeof value === 'function') {\n\t\t\tvalue = value(data);\n\t\t}\n\t\treturn value;\n\t});\n}\n\n\n/*\n * inspired by and uses code from https://github.com/mylen/leaflet.TileLayer.WMTS\n */\nvar WMTS = TileLayer.extend({\n\n    defaultWmtsParams: {\n\n        service: 'WMTS',\n        request: 'GetTile',\n        version: '1.0.0',\n        layers: '',\n        styles: '',\n        tileMatrixSet: '',\n        format: 'image/png'\n    },\n\n    initialize: function (url, options) { // (String, Object)\n        this._url = url;\n        var wmtsParams = extend({}, this.defaultWmtsParams);\n        var tileSize = options.tileSize || this.options.tileSize;\n        if (options.detectRetina && Browser.retina) {\n            wmtsParams.width = wmtsParams.height = tileSize * 2;\n        } else {\n            wmtsParams.width = wmtsParams.height = tileSize;\n        }\n        for (var i in options) {\n            // all keys that are not TileLayer options go to WMTS params\n            if (!this.options.hasOwnProperty(i) && i!=\"matrixIds\") {\n                wmtsParams[i] = options[i];\n            }\n        }\n        this.wmtsParams = wmtsParams;\n        this.matrixIds = options.matrixIds||this.getDefaultMatrix();\n        setOptions(this, options);\n    },\n\n    onAdd: function (map) {\n        this._crs = this.options.crs || map.options.crs;\n        TileLayer.prototype.onAdd.call(this, map);\n    },\n\n    getTileUrl: function (coords) { // (Point, Number) -> String\n        var tileSize = this.options.tileSize;\n        var nwPoint = coords.multiplyBy(tileSize);\n        nwPoint.x+=1;\n        nwPoint.y-=1;\n        var sePoint = nwPoint.add(new Point(tileSize, tileSize));\n        var zoom = this._tileZoom;\n        var nw = this._crs.project(this._map.unproject(nwPoint, zoom));\n        var se = this._crs.project(this._map.unproject(sePoint, zoom));\n        var tilewidth = se.x-nw.x;\n        //zoom = this._map.getZoom();\n        var ident = this.matrixIds[zoom].identifier;\n        var tileMatrix = this.wmtsParams.tileMatrixSet + \":\" + ident;\n        var X0 = this.matrixIds[zoom].topLeftCorner.lng;\n        var Y0 = this.matrixIds[zoom].topLeftCorner.lat;\n        var tilecol=Math.floor((nw.x-X0)/tilewidth);\n        var tilerow=-Math.floor((nw.y-Y0)/tilewidth);\n\n\n        let url = this._url;\n        let isTileMatrixTemplated = url.indexOf('{TileMatrix}');\n        let isTileRowTemplated = url.indexOf('{TileRow}');\n        let isTileColTemplated = url.indexOf('{TileCol}');\n\n        let o = Object.assign({ s: this._getSubdomain(coords) }, this.wmtsParams);\n        if(isTileMatrixTemplated>0) o.TileMatrix = ident;\n        if(isTileRowTemplated>0) o.TileRow = tilerow;\n        if(isTileColTemplated>0) o.TileCol = tilecol;\n        for(let k in o) {\n            o[k.toLowerCase()] = o[k];\n        }\n        // url = Util.template(url.toLowerCase(), o);\n        url = template(url, o);\n\n        let qsi = url.indexOf(\"?\");\n        if(qsi<0 || (isTileMatrixTemplated<qsi && isTileRowTemplated<qsi || isTileColTemplated<qsi)) {\n            //if the TM,TR,TC variables are templated but not as querystring parameters\n            // (ie, no '?' present or those params are before the '?'),\n            // then the URL must not be OGC WMTS, so no need for WMTS parameters\n\n        } else {\n            url = url + Util.getParamString(this.wmtsParams, url);\n            if(isTileMatrixTemplated<0)\n                url += \"&TileMatrix=\" + ident; //tileMatrixSet\n            if(isTileRowTemplated<0)\n                url += \"&TileRow=\" + tilerow;\n            if(isTileColTemplated<0)\n                url += \"&TileCol=\" + tilecol;\n        }\n\n        return url;\n    },\n\n    setParams: function (params, noRedraw) {\n        extend(this.wmtsParams, params);\n        if (!noRedraw) {\n            this.redraw();\n        }\n        return this;\n    },\n\n    getDefaultMatrix : function () {\n        /**\n         * the matrix3857 represents the projection\n         * for in the IGN WMTS for the google coordinates.\n         */\n        var matrixIds3857 = new Array(22);\n        for (var i= 0; i<22; i++) {\n            matrixIds3857[i]= {\n                identifier    : \"\" + i,\n                topLeftCorner : new LatLng(20037508.3428,-20037508.3428)\n            };\n        }\n        return matrixIds3857;\n    }\n});\n\n\n\n\nfunction wmts(layer) {\n\n    let url = layer.services && layer.services.length ? layer.services[0].href : null;\n\n    let options = {\n        layer: layer.layerName,\n        style: 'default',\n        tileMatrixSet: \"default\",\n        format: \"image/png\"\n    };\n    if(Config.leafletPane)\n        options.pane = Config.leafletPane;\n\n    let distro = (layer.distributions || []).find( dist => {\n        //ensure dist isn't 'null'\n        return dist && dist.href && ( dist.mediaType==='image/png' || dist.mediaType==='image/jpeg' );\n    });\n    if(distro) {\n        url = distro.href;\n        options.format = distro.mediaType;\n\n        let params = distro.parameters || [];\n        params.each( param => {\n\n            //ignore wmts specific parameters, WMTS layer will populate those values\n            // based upon map state.\n            let plc = param.name.toLowerCase();\n            if(\"tilematrix\" === plc || \"tilerow\" === plc || \"tilecol\" === plc)\n                return;\n\n            //for all other parameters, try to fill in default or initial values\n            let value = param.defaultValue || param.values && param.values.length && param.values[0];\n            if(value !== null && value !== undefined) {\n                url = url.replace('{' + param.name + '}', value);\n            }\n        });\n    } else {\n        throw new Error(\"WTMS Layer - layer \" + layer.id +\n            \" has no distribution(s) usable to make WMTS requests\");\n    }\n\n    if(!url) throw new Error(\"Unable to determine WMTS URL for layer \" + layer.id +\n        \". Please make sure it is defined by either the service or a distribution on the layer itself.\");\n\n    return new WMTS( url, options );\n\n}\n\nTileLayer.WMTS = WMTS;\ntileLayer.wmts = wmts;\n\nexport {\n    WMTS as default,\n    WMTS,\n    wmts\n};\n","\n\nimport jQuery from \"jquery\";\nimport Q from \"q\";\nimport { TileLayer, tileLayer, Browser, extend, setOptions, Util } from 'leaflet';\n\nimport {Config} from 'geoplatform.client';\n\n\nvar esriTileLayer = TileLayer.extend({\n\n    defaultESRIParams: {\n        layers:       '', //=show:0,1,2\n        transparent:  true,\n        format:       'png32',\n        // srs:          '4326',\n        // bboxsr:       '4326',\n        // bbox:         null,\n        // size:         '256,256',\n        f:            'image'\n        // imagesr:      '4326'\n    },\n\n    initialize: function (url, options) { // (String, Object)\n\n        if(!url) throw new Error(\"Layer was not configured with a URL\");\n        \n        if(url.indexOf(\"/export\") < 0) {\n            let qidx = url.indexOf(\"?\");\n            if(qidx > 0) {\n                url = url.substring(0, qidx) + '/export' + url.substring(qidx);\n            } else {\n                url += '/export';\n            }\n        }\n        this._url = url;\n\n        let esriParams = extend({}, this.defaultESRIParams),\n            tileSize = options.tileSize || this.options.tileSize;\n\n        let dim;\n        if (options.detectRetina && Browser.retina) {\n            dim = esriParams.height = tileSize * 2;\n        } else {\n            dim = esriParams.height = tileSize;\n        }\n        esriParams.size = dim + ',' + dim;\n\n        for (var i in options) {\n            // all keys that are not TileLayer options go to WMS params\n            if (!this.options.hasOwnProperty(i) && i !== 'crs') {\n                esriParams[i] = options[i];\n            }\n        }\n\n        //layer ids\n        // esriParams.layers = \"show:\" + esriParams.layers;\n\n        this.esriParams = esriParams;\n\n        setOptions(this, options);\n\n    },\n\n    onAdd: function (map) {\n        this._crs = this.options.crs || map.options.crs;\n        this.esriParams.srs = this.esriParams.imagesr = this.esriParams.bboxsr = this._crs.code;\n        TileLayer.prototype.onAdd.call(this, map);\n    },\n\n    getTileUrl: function (tilePoint) { // (Point, Number) -> String\n\n        let map = this._map,\n            tileSize = this.options.tileSize,\n\n        nwPoint = tilePoint.multiplyBy(tileSize),\n        sePoint = nwPoint.add([tileSize, tileSize]),\n\n        nw = this._crs.project(map.unproject(nwPoint, tilePoint.z)),\n        se = this._crs.project(map.unproject(sePoint, tilePoint.z)),\n        bbox = [nw.x, se.y, se.x, nw.y].join(','),\n\n        url = Util.template(this._url, {s: this._getSubdomain(tilePoint)});\n\n        let params = extend({}, this.esriParams);\n        params.layers = \"show:\" + params.layers;\n\n        //convert to esri-special SR for spherical mercator\n        if(params.bboxsr === 'EPSG:3857')\n            params.bboxsr = '102100';\n        if(params.imagesr === 'EPSG:3857')\n            params.imagesr = '102100';\n\n        return url + Util.getParamString(params, url, true) + '&BBOX=' + bbox;\n    },\n\n    setParams: function (params, noRedraw) {\n        extend(this.esriParams, params);\n        if (!noRedraw) {\n            this.redraw();\n        }\n        return this;\n    }\n});\n\n\nTileLayer.ESRI = esriTileLayer;\ntileLayer.esri = function (url, options) {\n    return new TileLayer.ESRI(url, options);\n};\n\nexport default esriTileLayer;\n","\nimport { TileLayer } from 'leaflet';\n\n\n/**\n * @param {Object} layer - GeoPlatform Layer\n * @return {L.TileLayer}\n */\nfunction OSMLayerFactory(layer) {\n\n    return new TileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        minZoom: 1, maxZoom: 19,\n        attribution: 'Map data (c) <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors'\n    });\n}\n\nexport default OSMLayerFactory;\n","\nimport Q from \"q\";\nimport jQuery from 'jquery';\nimport * as L from \"leaflet\";\nimport * as esri from \"esri-leaflet\";\nimport ServiceTypes from \"../service/types\";\nimport OSM from \"./osm\";\nimport FeatureLayer from './feature';\nimport {\n    ClusteredFeatureLayer,\n    clusteredFeatures,\n    geoJsonFeed\n} from './cluster-feature';\n\nimport {WMS, wms} from './wms';\nimport {WMST, wmst} from './wmst';\nimport {WMTS, wmts} from './wmts';\nimport ESRITileLayer from './L.TileLayer.ESRI';\nimport OSMLayerFactory from './osm-factory';\nimport { Config, ItemTypes, LayerService, JQueryHttpClient } from 'geoplatform.client';\n\n\n\n\n/**\n * Fetches style information from GeoPlatform UAL\n * @param {string} id - identifier of layer to resolve style for\n */\nfunction styleResolverFactory(service) {\n\n    if(!service || typeof(service.style) !== 'function') {\n        throw new Error(\"Must provide a LayerService instance\");\n    }\n\n    return function featureStyleResolver(id) {\n        return service.style(id).catch(e => {\n            let msg = `Error loading style information for layer ${id} : ${e.message}`;\n            return Q.reject( new Error(msg) );\n        });\n    };\n}\n\n\n\n\n\n\n\n\n\nclass LayerFactory {\n\n    constructor() {\n        this.factories = [];    // A list of configured factory functors to instantiate layers\n        this.init();\n    }\n\n    register(fn) {\n        if(typeof(fn) === 'function') {\n            this.factories.push(fn);\n        }\n    }\n\n    setLayerService(service) {\n        this.service = service;\n    }\n\n    /**\n     * @return {function}\n     */\n    getStyleResolver() {\n        if(!this.service || typeof(this.service.style) === 'undefined') {\n            this.service = new LayerService(Config.ualUrl, new JQueryHttpClient());\n        }\n        return styleResolverFactory(this.service);\n    }\n\n    /**\n     * @param {object} layer - GP Layer object\n     * @return {L.Layer} leaflet layer instance or null\n     */\n    create(layer) {\n        if(!layer) {\n            throw new Error(\"LayerFactory expects a layer object\");\n        }\n        for(let i=0; i<this.factories.length; ++i) {\n            let fn = this.factories[i];\n            let result = fn && typeof(fn)==='function' && fn(layer);\n            if(result) return result;\n        }\n        return null;\n    }\n\n\n    init () {\n\n        //OSM factory\n        this.register((layer)=> {\n            if(layer && layer.resourceTypes &&\n                layer.resourceTypes.length &&\n                ~layer.resourceTypes.indexOf(\"http://www.geoplatform.gov/ont/openlayer/OSMLayer\")) {\n                return OSMLayerFactory();\n            }\n        });\n\n        // ESRI factory\n        this.register( (layer) => {\n            if(!layer || !layer.services || !layer.services.length) return null;\n            let service = layer.services[0],\n                url     = service.href,\n                typeUri = service.serviceType ? service.serviceType.uri : null,\n                srs     = layer.supportedCRS ? layer.supportedCRS[0] : null,\n                format  = layer.supportedFormats ? layer.supportedFormats[0] : null,\n                opts = {};\n\n            function checkUrl(url) {\n                if(!url) throw new Error(\"Layer's service does not define a service url\");\n            }\n\n            if(ServiceTypes.ESRI_MAP_SERVER &&\n                ServiceTypes.ESRI_MAP_SERVER.uri === typeUri) {\n                checkUrl(url);\n                opts = {\n                    layers: layer.layerName,\n                    transparent: true,\n                    format: format || \"png32\"\n                };\n                if(srs) opts.srs = srs;\n                if(Config.leafletPane)\n                    opts.pane = Config.leafletPane;\n                return new ESRITileLayer(url, opts);\n\n            } else if(ServiceTypes.ESRI_FEATURE_SERVER &&\n                ServiceTypes.ESRI_FEATURE_SERVER.uri === typeUri) {\n                checkUrl(url);\n                return clusteredFeatures(layer, {\n                    styleResolver: this.getStyleResolver()\n                });\n\n            } else if(ServiceTypes.ESRI_TILE_SERVER &&\n                ServiceTypes.ESRI_TILE_SERVER.uri === typeUri) {\n                checkUrl(url);\n                opts = { url: url, useCors: true };\n                if(Config.leafletPane)\n                    opts.pane = Config.leafletPane;\n                return esri.tiledMapLayer(opts);\n\n            } else if(ServiceTypes.ESRI_IMAGE_SERVER &&\n                ServiceTypes.ESRI_IMAGE_SERVER.uri === typeUri) {\n                opts = { url: url, useCors: true };\n                if(Config.leafletPane)\n                    opts.pane = Config.leafletPane;\n                return esri.imageMapLayer(opts);\n\n            }\n            return null;\n        });\n\n        // OGC factory\n        this.register( (layer) => {\n            if(!layer || !layer.services || !layer.services.length) return null;\n            let service = layer.services[0],\n                typeUri = service.serviceType ? service.serviceType.uri : null;\n            if(ServiceTypes.WMS && ServiceTypes.WMS.uri === typeUri) {\n                return wms(layer);\n            } else if(ServiceTypes.WMST && ServiceTypes.WMST.uri === typeUri) {\n                return wmst(layer);\n            } else if(ServiceTypes.WMTS && ServiceTypes.WMTS.uri === typeUri) {\n                return wmts(layer);\n            }\n            return null;\n        });\n\n\n        this.register( (layer) => {\n            if(!layer || !layer.services || !layer.services.length) return null;\n            let service = layer.services[0],\n                typeUri = service.serviceType ? service.serviceType.uri : null;\n            if(ServiceTypes.FEED && ServiceTypes.FEED.uri === typeUri) {\n                return geoJsonFeed(layer, {\n                    styleResolver: this.getStyleResolver()\n                });\n            }\n            return null;\n        });\n\n\n\n\n\n        this.register( (layer) => {\n\n            if(!layer) return null;\n\n            const MBVTRT = 'http://www.geoplatform.gov/ont/openlayer/MapBoxVectorTileLayer';\n            let resourceTypes = layer.resourceTypes || [];\n            if(resourceTypes.indexOf(MBVTRT) < 0) { //not tagged as VT layer\n                return null;\n            }\n\n            let href = layer.href;\n            if(!href || href.indexOf(\".pbf\") < 0) {\n                console.log(\"LayerFactory - Layer does not define an Access URL\");\n                return null;  //missing URL\n            }\n\n            //if Leaflet vector grid plugin is not installed, can't render VT Layers\n            if( typeof(L.vectorGrid) === 'undefined' &&\n                typeof(L.vectorGrid.protobuf) === 'undefined') {\n                console.log(\"LayerFactory - Leaflet Vector Tiles plugin not found\");\n                return null;\n            }\n\n            // let styleFn = function(featureProperties, z){\n            //     let fill = '#AD816E';\n            //     return { color: fill, weight: 1 };\n            // };\n            //\n            // var styles = {\n            //     \"nc_wetlands\" : styleFn,\n            //     \"va_wetlands\": styleFn\n            // };\n            var opts = {\n        \t\trendererFactory: L.canvas.tile\n                // ,\n        \t\t// vectorTileLayerStyles: styles,\n        \t};\n            if(Config.leafletPane) opts.pane = Config.leafletPane;\n        \treturn L.vectorGrid.protobuf(href, opts);\n\n        });\n\n    }\n}\n\nexport default new LayerFactory();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// /**\n//  * @param {Object} layer - GeoPlatform Layer object\n//  * @return {L.Layer} Leaflet layer instance\n//  */\n// var LayerFactory = function(layer) {\n//\n//     if(!layer) {\n//         throw new Error(`\n//             L.GeoPlatform.LayerFactory() -\n//             Invalid argument: must provide a layer object\n//         `);\n//     }\n//\n//     //OSM layers have no \"services\" so we have to treat them differently\n//     if(OSM.test(layer)) {\n//         return OSMLayerFactory();\n//     }\n//\n//     if(!layer.services || !layer.services.length) {\n//         console.log(\"MapCore LayerFactory() - cannot create layer for \" + layer.id + \" because it has no services\");\n//         throw new Error(`GeoPlatform Layer resource ('${layer.id}') has no Services defined`);\n//     }\n//\n//     let service = layer.services[0],\n//         url     = service.href,\n//         typeUri = service.serviceType ? service.serviceType.uri : null,\n//         srs     = layer.supportedCRS ? layer.supportedCRS[0] : null,\n//         format  = layer.supportedFormats ? layer.supportedFormats[0] : null,\n//         opts = {};\n//\n//     if(typeUri === null) {\n//         console.log(\"MapCore LayerFactory() - cannot create layer for \" + layer.id +\n//             \"; it has a Service of an unspecified service type\");\n//         throw new Error(`GeoPlatform Layer resource ('${layer.id}') has a Service of an unspecified service type`);\n//         // return null;\n//     }\n//\n//     if(ServiceTypes.ESRI_MAP_SERVER &&\n//         ServiceTypes.ESRI_MAP_SERVER.uri === typeUri) {\n//         opts = {\n//             layers: layer.layerName,\n//             transparent: true,\n//             format: format || \"png32\"\n//         };\n//         if(srs) opts.srs = srs;\n//         if(Config.leafletPane)\n//             opts.pane = Config.leafletPane;\n//         return new ESRITileLayer(url, opts);\n//\n//     } else if(ServiceTypes.ESRI_FEATURE_SERVER &&\n//         ServiceTypes.ESRI_FEATURE_SERVER.uri === typeUri) {\n//         return clusteredFeatures(layer);\n//\n//     } else if(ServiceTypes.ESRI_TILE_SERVER &&\n//         ServiceTypes.ESRI_TILE_SERVER.uri === typeUri) {\n//         opts = { url: url, useCors: true };\n//         if(Config.leafletPane)\n//             opts.pane = Config.leafletPane;\n//         return esri.tiledMapLayer(opts);\n//\n//     } else if(ServiceTypes.ESRI_IMAGE_SERVER &&\n//         ServiceTypes.ESRI_IMAGE_SERVER.uri === typeUri) {\n//         opts = { url: url, useCors: true };\n//         if(Config.leafletPane)\n//             opts.pane = Config.leafletPane;\n//         return esri.imageMapLayer(opts);\n//\n//     } else if(ServiceTypes.FEED && ServiceTypes.FEED.uri === typeUri) {\n//         return geoJsonFeed(layer);\n//\n//     } else if(ServiceTypes.WMS && ServiceTypes.WMS.uri === typeUri) {\n//         return wms(layer);\n//\n//     } else if(ServiceTypes.WMST && ServiceTypes.WMST.uri === typeUri) {\n//         return wmst(layer);\n//\n//     } else if(ServiceTypes.WMTS && ServiceTypes.WMTS.uri === typeUri) {\n//         return wmts(layer);\n//\n//     } else {\n//         console.log(\"MapCore LayerFactory() - Could not create layer for \" + layer.id +\n//             \"because of unsupported service type: \" + typeUri);\n//         throw new Error(\"GeoPlatform Layer resource ('\" + layer.id +\n//             \"') has a Service with an unsupported service type: \" + typeUri);\n//         // return null;\n//     }\n// };\n//\n// export default LayerFactory;\n","\n\nimport jQuery from \"jquery\";\nimport Q from \"q\";\nimport { circleMarker, geoJson, featureGroup, LayerGroup } from 'leaflet';\n\nimport GeoPlatformClient from 'geoplatform.client';\n\nimport LayerFactory from '../layer/factory';\nimport OSM from \"../layer/osm\";\nimport DefaultBaseLayer from '../layer/baselayer-default';\n\nconst ItemTypes = GeoPlatformClient.ItemTypes;\nconst ServiceFactory = GeoPlatformClient.ServiceFactory;\nconst HttpClient = GeoPlatformClient.JQueryHttpClient;\nconst Config = GeoPlatformClient.Config;\n\n\nclass Listener {\n\n    constructor() {\n        //listeners to be unregistered upon destroy\n        this._listeners = {};\n    }\n\n    on (type, listener) {\n        if(!this._listeners[type])\n            this._listeners[type] = [];\n        this._listeners[type].push(listener);\n    }\n\n    off (type, listener) {\n        if(!type) this._listeners = {};\n        if(!this._listeners[type]) return;\n        if(!listener) this._listeners[type] = [];\n        else {\n            var idx = this._listeners[type].indexOf(listener);\n            if(idx >= 0)\n                this._listeners[type].splice(idx, 1);\n        }\n    }\n\n    notify(type) {\n        if(!this._listeners[type]) return;\n        var args = Array.prototype.slice.call(arguments, 1);\n        this._listeners[type].each(function(l) { l.apply(null, args); });\n    }\n\n}\n\n\n\nclass MapInstance extends Listener {\n\n    constructor(key) {\n        super();\n\n        this.setHttpClient(new HttpClient());\n        this.setServiceFactory(ServiceFactory);\n\n        //generate random key (see factory below)\n        this._key = key || Math.ceil(Math.random()*9999);\n\n        //registry id of current map if available\n        this._mapId = null,\n\n        //definition of map (ie, from server)\n        this._mapDef = this.initializeMapDefinition(),\n\n        //primary map instance (ie, leaflet)\n        this._mapInstance = null,\n\n        //default map extent (if map doesn't have one for being saved)\n        this._defaultExtent = null,\n\n        //current base layer object and leaflet instance\n        this._baseLayerDef = null,\n        this._baseLayer = null,\n\n        //set definitions of layer states (including layer info) on map\n        this._layerStates = [],\n\n        //map layer def ids with leaflet instances\n        this._layerCache = {},\n\n        //errors generated by layers loading\n        this._layerErrors= [],\n        this._layerErrorHandler = function(e) {\n            console.log(`MapInstance.defaultLayerErrorHandler() - ${e.id} : ${e.message}`);\n        },\n\n        //layer used to store features on map\n        this._featureLayer = null,\n        this._featureLayerVisible = true,\n\n        //set of registered map tools\n        this._tools = [],\n\n        //state management\n        this.state = { dirty: false }; // jshint ignore:line\n\n\n        this._geoJsonLayerOpts = {\n            style: function(feature) {\n                if(feature.properties.style)\n                    return feature.properties.style;\n            },\n            onEachFeature: function(feature, layer) {\n\n                var style = { weight: 2, color: '#03f', opacity: 0.9, radius: 4, fillColor: '#03f', fillOpacity: 0.5 };\n                if(~feature.geometry.type.indexOf('Point')) {\n                    style.fillOpacity = 0.9;\n                }\n\n                var props = feature.properties = feature.properties || {};\n                if(feature.properties.id === undefined || feature.properties.id === null)\n                    feature.properties.id = Math.floor(Math.random()*999999);\n                feature.properties.label = props.label || props.title || props.name || \"Untitled \" + feature.geometry.type + \" Feature\";\n                feature.properties.description = props.description || props.desc || \"This feature needs a description!\";\n                feature.properties.style = props.style || style;\n\n                layer.bindTooltip(props.label);\n                /*\n                toggle: setLabelNoHide(bool)\n                it may only exist on markers!\n                */\n            },\n            pointToLayer: function (feature, latlng) {\n\n                var style = feature.properties.style || {};\n                style.radius = style.radius || 4;\n                style.weight = style.weight || 2;\n                style.color = style.color || '#03f';\n                style.opacity = style.opacity || 0.9;\n                style.fillOpacity = style.opacity;\n                style.fillColor = style.color;\n\n                if(!L) {\n                    throw new Error(\"Leaflet is not available\");\n                }\n                return circleMarker(latlng, style);\n            }\n        };\n\n    }\n\n    dispose () {\n        this.destroyMap();\n        this.svcCache = null;\n        this.serviceFactory = null;\n        this.httpClient = null;\n        this._key = null;\n        this._mapId = null;\n        this._mapDef = null;\n        this._mapInstance = null;\n        this._defaultExtent = null;\n        this._baseLayerDef = null;\n        this._baseLayer = null;\n        this._layerStates = null;\n        this._layerCache = null;\n        this._layerErrors= null;\n        this._featureLayer = null;\n        this._featureLayerVisible = true;\n        this._tools = null;\n        this.state = null;\n        this._geoJsonLayerOpts = null;\n    }\n\n\n    getKey () {\n        return this._key;\n    }\n\n    /**\n     * Override default (JQuery-based) map service used by this instance\n     * @param {ItemService} mapService - service to use to CRUD map objects\n     * @deprecated use setServiceFactory instead\n     */\n    setService(mapService) {\n        // this.mapService = mapService;\n    }\n\n    /**\n     * @param {ServiceFactory} factory - GeoPlatform ServiceFactory to instantiate services for maps and layers\n     */\n    setServiceFactory(factory) {\n        this.svcCache = {}; //wipe out cached services\n        this.serviceFactory = factory;\n    }\n\n    /**\n     * @param {HttpClient} httpClient - HttpClient impl to use with the new factory\n     */\n    setHttpClient(httpClient) {\n        this.svcCache = {}; //wipe out cached services\n        this.httpClient = httpClient;\n    }\n\n    /**\n     * @param {string} type - GeoPlatform Object model type to support (\"Map\", \"Layer\", etc)\n     * @return {ItemService} item service implementation for the requested type\n     */\n    getService(type) {\n        if(!this.svcCache[type])\n            this.svcCache[type] = this.serviceFactory(type, Config.ualUrl, this.httpClient);\n        return this.svcCache[type];\n    }\n\n    /**\n     * @param {Function} fn - callback when an error is encountered\n     */\n    setErrorHandler(fn) {\n        this._layerErrorHandler = fn;\n    }\n\n\n    //-----------------\n    getLayerStateIndex (layerId) {\n        if(!layerId) return -1;\n        for(let i=0; i<this._layerStates.length; ++i) {\n            if(this._layerStates[i].layer && layerId === this._layerStates[i].layer.id) {\n                return i;\n            }\n        }\n        return -1;\n        // return this._layerStates.indexOfObj(layerId, (id, state) => state.layer.id === id );\n    }\n\n    getLayerState (layerId) {\n        let index = this.getLayerStateIndex(layerId);\n        return index >= 0 ? this._layerStates[index] : null;\n    }\n    //-----------------\n\n\n    initializeMapDefinition() {\n        return {\n            type: ItemTypes.MAP,\n            title: \"My New Map\",\n            label: \"My New Map\",\n            description: \"This map needs a description\",\n            createdBy: null,\n            baseLayer: this._baseLayerDef,\n            layers: [],\n            keywords: [],\n            themes: [],\n            resourceTypes: ['http://www.geoplatform.gov/ont/openmap/GeoplatformMap']\n        };\n    }\n\n    /**\n     * @param metadata object\n     * @return object definition of the current map suitable for sending to WMVR\n     */\n    getMapResourceContent(metadata) {\n\n        metadata = metadata || {};\n\n        //map layers\n        metadata.layers = this._layerStates.slice(0);\n        // ... UAL should support accepting just an id here, so we'll do just that\n        metadata.baseLayer = this._baseLayerDef;\n\n        metadata.annotations = this._featureLayer ?\n            { title: \"Map Features\", geoJSON: this._featureLayer.toGeoJSON() } : null;\n\n        //geographic extent\n        let extent = this._mapInstance.getBounds();\n        metadata.extent = {\n            minx: extent.getWest(),\n            miny: extent.getSouth(),\n            maxx: extent.getEast(),\n            maxy: extent.getNorth()\n        };\n\n        return metadata;\n    }\n\n    /**\n     * @return Leaflet toolbar\n     */\n    getDrawControlToolbar() {\n        if(!this._mapInstance.drawControl) return null;\n        var toolbars = this._mapInstance.drawControl._toolbars;\n        var toolbar = null;\n        for(var key in toolbars) {\n            if(toolbars.hasOwnProperty(key)) {\n                if(toolbars[key]._modes) {\n                    toolbar = toolbars[key];\n                    break;\n                }\n            }\n        }\n        return toolbar;\n    }\n\n    /**\n     * @param error Leaflet tile load error (.target is layer, .tile is image)\n     */\n    handleLayerError(error) {\n        // console.log(\"MapInstance.handleLayerError() - \" +\n        //     \"Layer's tile failed to load: \" + error.tile.src);\n        if(!this._layerCache) {\n            console.log(\"Unable to find layer in layer cache. Layer error is \" + error);\n            return;\n        }\n        var layer = error.target;\n        for(var id in this._layerCache) {\n            if(this._layerCache[id] === layer) {\n                this.processLayerError(error, id);\n                break;\n            }\n        }\n    }\n\n    /**\n     * Given a Leaflet tile load error and the responsible layer id,\n     * Try to isolate the cause of the error using the proxy\n     * and notify listeners that an error has occurred\n     */\n    processLayerError(error, id) {\n\n        var finder = (l) => { return l.id === id || (l.layer && l.layer.id === id); };\n\n        if(!this._layerErrors.find(finder)) {\n\n            let obj = this.logLayerError(id, \"Layer ('\" + id + \"') failed to completely load. \" +\n                \"It may be inaccessible or misconfigured.\");\n\n            var url = error.tile.src;\n            var params = {id:id};\n            url.substring(url.indexOf(\"?\")+1, url.length).split('&').each(function(param) {\n                var p = param.split('=');\n                params[p[0]] = p[1];\n            });\n\n            let layerService = this.getService(ItemTypes.LAYER);\n            if(layerService) {\n                layerService.validate(id, params)\n                .catch(e => {\n                    var def = this._layerStates.find(finder);\n                    if(def) {\n                        obj.message = \"Layer '\" + def.layer.label + \"' failed to completely load. \" +\n                                \"Reported cause: \" + e.message;\n                    }\n                    this.notify('layer:error', obj);\n                });\n            }\n        }\n    }\n\n    /**\n     * @param {string} layerId - identifier of layer generating the error\n     * @param {string} errorMsg - message of the error\n     */\n    logLayerError(layerId, errorMsg) {\n        // console.log(\"MapInstance.logLayerError() - layer \"  + id +\n        //     \" generated error '\" + errorMsg + \"'\");\n        let err = { id: layerId, message: errorMsg };\n        this._layerErrors.push(err);\n        if(this._layerErrorHandler) {\n            this._layerErrorHandler(err);\n        }\n        return err;\n    }\n\n    /* -- State Management of internal model -- */\n\n    touch (event) {\n        this.state.dirty = true;\n        if(event) {\n            if(arguments.length > 1) {\n                this.notify.apply(this, Array.prototype.slice.call(arguments));\n            } else\n                this.notify(event);\n            // console.log(\"Dirtying map for \" + event);\n        }\n        // else console.log(\"Dirtying map\");\n    }\n    clean() {\n        // console.log(\"Cleaning map\");\n        this.state.dirty = false;\n    }\n    /* --------------------------------------- */\n\n\n\n\n    /* ==============================================\n        Map manipulation operations\n       ============================================== */\n\n    setMap (map) { this._mapInstance = map; }\n\n    /**\n     * @return {L.Map} map instance\n     */\n    getMap () { return this._mapInstance; }\n\n    /** @return {object} definition of map */\n    getMapDefinition () { return this._mapDef; }\n\n    /** @return {string} identifier of map */\n    getMapId () { return this._mapId; }\n\n    /**\n     * Focuses the map on the specified lat/lng coordinate\n     * @param lat number\n     * @param lng number\n     * @param zoom number (optional)\n     */\n    setView (lat, lng, zoom) {\n        let z = zoom;\n        if(typeof(z) === 'undefined')\n            z = this._mapInstance.getZoom();\n        this._mapInstance.setView([lat,lng], z);\n        this.touch('map:view:changed');\n    }\n\n    /**\n     * Retrieve the current center of the map\n     * @return [lat,lng]\n     */\n    getView () {\n        var latLng = this._mapInstance.getCenter();\n        return [latLng.lat, latLng.lng];\n    }\n\n    /**\n     * @return integer current zoom level of the map\n     */\n    getZoom () {\n        return this._mapInstance.getZoom();\n    }\n\n    /**\n     * Zoom to the map's default extent\n     * If the map is saved, this will be the saved viewport\n     * otherwise, it will be CONUS\n     */\n    zoomToDefault () {\n        if(!this._mapInstance) return;\n        if(this._defaultExtent) {\n            this._mapInstance.fitBounds([\n                [this._defaultExtent.miny, this._defaultExtent.minx],\n                [this._defaultExtent.maxy, this._defaultExtent.maxx]\n            ]);\n        } else {\n            console.log(\"MapInstance.zoomToDefault() - No default extent specified\");\n            this._mapInstance.setView([38, -96], 5);\n        }\n        try {\n            this.touch('map:view:changed');\n        } catch(e) { }\n    }\n\n    /**\n     * @param {Object} extent - either a GP extent object or Leaflet LatLngBounds object\n     */\n    setExtent(extent) {\n        if(!extent) return;\n        if( typeof(extent.minx) !== 'undefined' &&\n            typeof(extent.miny) !== 'undefined' &&\n            typeof(extent.maxx) !== 'undefined' &&\n            typeof(extent.maxy) !== 'undefined' ) {\n            //GP model extent\n            this._mapInstance.fitBounds([\n                [extent.miny, extent.minx],\n                [extent.maxy, extent.maxx]\n            ]);\n        } else if(typeof(extent.getWest) !== 'undefined') {\n            //L.LatLngBounds\n            this._mapInstance.fitBounds(extent);\n        } else {\n\n        }\n    }\n\n\n    /* ==============================================\n        Layer operations\n       ============================================== */\n\n\n    /**\n     * @param layer Leaflet Layer instance or object definition\n     */\n    setBaseLayer (layer) {\n\n        let promise = null;\n        if(!layer) {\n            promise = DefaultBaseLayer.get(this.getService(ItemTypes.LAYER));\n        } else\n            promise = Q.resolve(layer);\n\n        promise.then( layer => {\n\n            let leafletLayer = LayerFactory.create(layer);\n            if(!leafletLayer) {\n                console.log(\"Warning: MapInstance could not create base \" +\n                    \"layer for '\" + layer.id + \"'\");\n                return;\n            }\n\n            this._mapInstance.addLayer(leafletLayer);\n            leafletLayer.setZIndex(0);  //set at bottom\n\n            let oldBaseLayer = this._baseLayer;\n            if(oldBaseLayer) {\n                this._mapInstance.removeLayer(oldBaseLayer);\n            }\n\n            //remember new base layer\n            this._baseLayer = leafletLayer;\n            this._baseLayerDef = layer;\n\n            //will notify listeners\n            this.touch('baselayer:changed', layer, leafletLayer);\n            // this.notify('baselayer:changed', layer, leafletLayer);\n\n        })\n        .catch(e => {\n            console.log(`MapInstance.setBaseLayer() - Error getting base layer for map : ${e.message}`);\n            this.logLayerError( layer.id, \"Error setting baselayer on map \" +\n                \"because of the following error(s): \" + e.message );\n        });\n    }\n\n    /**\n     * @return array of base layers definitions that can be used\n     */\n    // getBaseLayerOptions () {\n    //     return this._baseLayerOptions;\n    // },\n\n    getBaseLayer () { return this._baseLayerDef; }\n\n    /**\n     * @return {array[object]} list of layer states containing layer information\n     */\n    getLayers () { return this._layerStates; }\n\n    getLayerErrors () { return this._layerErrors; }\n\n    clearLayerErrors () {\n        this._layerErrors = [];\n        this.notify('layer:error');\n    }\n\n    clearOverlays () {\n        if(!this._layerCache) return;\n        for(var i=this._layerStates.length-1; i>=0; --i) {\n            var state = this._layerStates[i];\n            var layerInstance = this._layerCache[state.layer.id];\n            if(layerInstance) {\n                layerInstance.off(\"layer:error\");\n                this._layerCache[state.layer.id] = null;\n                this._mapInstance.removeLayer(layerInstance);\n            }\n        }\n        this._layerStates = [];\n        this.touch('layers:changed');\n\n        //TODO stop listening for layer events\n    }\n\n    /**\n     * @param {array[object]} layers - list of layers (NOTE: not wrapped by layer states, this method applies that)\n     */\n    addLayers (layers) {\n        if(!this._layerCache) {\n            console.log(\"WARN: attempting to add layers to an empty cache\");\n            return;\n        }\n\n        if(!this._layerCache) {\n            console.log(\"WARN: Attempting to add layers to a map with no layer cache\");\n            return;\n        }\n\n        if(!layers) return;\n        if(typeof(layers.push) === 'undefined') {\n            layers = [layers];\n        }\n\n        layers.forEach( (obj,index) => {\n\n            let layer = null, state = null;\n\n            if(obj.type && obj.type===ItemTypes.LAYER) { //is a layer\n                layer = obj;\n            } else if(obj.layer) {  //is layer state\n                layer = obj.layer;  // containing a layer\n                state = obj;\n            }\n\n            if(!layer) {\n                console.log(\"MapInstance.addLayers() - layer (\" + index +\n                    \") is not a Layer or a Layer state. Ignoring...\");\n                return;  //layer info is missing, skip it\n            }\n\n            //DT-442 prevent adding layer that already exists on map\n            if(this._layerCache[layer.id]) return;\n\n            if(!state) {\n                try {\n                    //wrapped in try{}catch because layer may contain circular reference\n                    // which will cause error when used by JSON methods\n                    let layerCopy = JSON.parse(JSON.stringify(layer));\n                    state = {\n                        opacity: 1,\n                        visibility: true,\n                        layer: layerCopy\n                    };\n                } catch(e) {\n                    throw new Error(\"Unable to add layer to map because of \" + e.message);\n                }\n            }\n\n            let z = layers.length - index;\n            state.zIndex = z;\n\n            this.addLayerWithState(layer, state);\n\n        });\n\n        this.touch('layers:changed');\n    }\n\n    /**\n     * @param {Object} layer - GeoPlatform Layer instance\n     * @param {Object} state - GeoPlatform Layer State\n     */\n    addLayerWithState(layer, state) {\n\n        var leafletLayer = null;\n        try {\n            if(!layer || !state)\n                throw new Error(\"Invalid argument, missing layer and or state\");\n\n            leafletLayer = LayerFactory.create(layer);\n            if(!leafletLayer) {\n                throw new Error(\"Could not create leaflet layer for GP Layer '\" +\n                    layer.id + \"'\");\n            }\n\n        } catch(e) {\n            this.logLayerError( layer.id,\n                \"Layer '\" + layer.label + \"' could not be added to the \" +\n                \"map instance; \" + e.message);\n        }\n\n        if(!leafletLayer) return;\n\n        //cache leaflet object first\n        if(this._layerCache) this._layerCache[layer.id] = leafletLayer;\n\n        //listen for layer errors so we can inform the user\n        // that a layer hasn't been loaded in a useful way\n        leafletLayer.on('tileerror', (e) => { this.handleLayerError(e); });\n\n        this._mapInstance.addLayer(leafletLayer);\n\n        if( !isNaN(state.zIndex) && leafletLayer.setZIndex )\n            leafletLayer.setZIndex(state.zIndex);\n\n        this._layerStates.push(state);\n\n        this.notify('layer:added', layer, leafletLayer);\n\n\n        // if layer is initially \"off\" or...\n        // if layer is initially not 100% opaque\n        if(!state.visibility || state.opacity < 1) {\n            // initialize layer visibility and opacity async, or else\n            // some of the layers won't get properly initialized\n            setTimeout( (layer, state) => {\n                this.setLayerVisibility(layer, state.visibility);\n                this.setLayerOpacity(layer, state.opacity);\n                //TODO notify of change\n\n                //DT-2102 timeout needs to be large enough or else\n                // feature layers won't get opacity updated on map load\n            }, 2000, leafletLayer, state);\n        }\n    }\n\n    /**\n     * @param {integer} from - position of layer being moved\n     * @param {integer} to - desired position to move layer to\n     */\n    moveLayer (from, to) {\n        if(!this._layerCache) return;\n\n        if(!this._layerCache) return;\n\n        if(isNaN(from)) return;\n\n        //end of list\n        if(isNaN(to)) to = this._layerStates.length-1;\n\n        let copy = this._layerStates.splice(from, 1)[0];    //grab layer being moved\n        this._layerStates.splice(to, 0, copy);\n\n        for(let z=1, i=this._layerStates.length-1; i>=0; --i,++z) {\n            let layerState = this._layerStates[i];\n            let layerInstance = this._layerCache[ layerState.layer.id ];\n            if(layerInstance) {\n                layerInstance.setZIndex(z);\n                layerState.zIndex = z;\n            }\n        }\n\n        this.touch('layers:changed', this.getLayers());\n    }\n\n    /**\n     *\n     */\n    removeLayer (id) {\n\n        if(!this._layerCache) return;\n        var layerInstance = this._layerCache[id];\n        if(layerInstance) {\n\n            //remove layer from tracked defs array\n            let index = this.getLayerStateIndex(id);\n            // console.log(\"MapInstance.removeLayer(\" + id + \")\");\n            if(index >= 0 && index < this._layerStates.length)\n                this._layerStates.splice(index, 1);\n\n            //stop listening for errors\n            layerInstance.off(\"layer:error\");\n\n            //remove layer from map\n            this._mapInstance.removeLayer(layerInstance);\n\n            //remove layer from cache\n            this._layerCache[id] = null;\n        }\n        this.touch('layers:changed');\n    }\n\n    /**\n     *\n     */\n    toggleLayerVisibility (id) {\n        if(!this._layerCache) return;\n        var layerInstance = this._layerCache[id];\n        if(layerInstance) {\n            let state = this.getLayerState(id);\n            state.visibility = !state.visibility;\n\n            if(layerInstance._currentImage) {\n                //ESRI Image Service layers have an IMG element\n                // that gets modified and replaced every map event (zoom/pan)\n                // so we can't just toggle classes like on other layers.\n                //Instead, we need to use the ESRI setOpacity method to toggle\n                // but need to update layer state as well.\n                layerInstance.setOpacity(state.visibility ? 1 : 0);\n                state.opacity = layerInstance.getOpacity();\n                return;\n            }\n\n            this.setLayerVisibility(layerInstance, state.visibility);\n        }\n    }\n\n    /**\n     * Note: this does not update layer definition state. Use\n     * MapInstance.toggleLayerVisibility to do that and adjust\n     * rendered layer's visibility.\n     *\n     * @param {L.Layer} layerInstance - leaflet layer instance\n     * @param {boolean} visible - flag indicating visibility of layer\n     */\n    setLayerVisibility (layerInstance, visible) {\n\n        if(layerInstance.setVisibility) {\n            //using custom method provided in src/layer/module.js\n            layerInstance.setVisibility(visible);\n\n        } else if(layerInstance._container) {\n            //otherwise, using jquery on dom directly\n            let el = jQuery(layerInstance._container);\n            // if(visible) el.removeClass(\"invisible\");\n            // else el.addClass('invisible');\n            el.css({'display': visible ? '' : 'none'});\n        }\n\n        this.touch('map:layer:changed');\n    }\n\n    /**\n     *\n     */\n    updateLayerOpacity (id, opacity) {\n\n        if(!this._layerCache) return;\n        var layerInstance = this._layerCache[id];\n\n        //if layer id is for base layer...\n        if(!layerInstance && this._baseLayerDef.id === id) {\n            layerInstance = this._baseLayer;\n        }\n\n        //adjust rendered leaflet layer\n        opacity = this.setLayerOpacity(layerInstance, opacity);\n\n        // if overlay layer, update state value\n        let state = this.getLayerState(id);\n        if(state) state.opacity = opacity;\n\n    }\n\n    /**\n     * Note: this method does not update the associated Layer Definition\n     * state value for opacity. Use MapInstance.updateLayerOpacity() to\n     * both update state and adjust rendered layer.\n     *\n     * @param {L.Layer} layerInstance - leaflet layer instance\n     * @param {number} opacity - value between 0 and 1.0 or 0 and 100\n     * @return {number} normalized opacity value between 0 and 1.0\n     */\n    setLayerOpacity (layerInstance, opacity) {\n        if(layerInstance && layerInstance.setOpacity) {\n            if(opacity > 1.0) opacity = opacity / 100.0;\n            layerInstance.setOpacity(opacity);\n            this.touch('map:layer:changed');\n        }\n        return opacity;\n    }\n\n    /**\n     * @param {Object} GeoPlatform Layer instance\n     * @return {L.Layer} Leaflet layer instance representing that layer or null\n     */\n    getLeafletLayerFor (gpLayer) {\n        if(!gpLayer || !this._layerCache) return null;\n        let leafletLayer = this._layerCache[gpLayer.id];\n        return leafletLayer || null;\n    }\n\n    /**\n     *\n     */\n    toggleGetFeatureInfo (layerId) {\n        if(!this._layerCache) return;\n        var layerInstance = this._layerCache[layerId];\n        if(layerInstance) {\n            if(typeof(layerInstance.enableGetFeatureInfo) !== 'undefined') {\n                if(layerInstance.isGetFeatureInfoEnabled()) {\n                    layerInstance.disableGetFeatureInfo();\n                    jQuery(_mapInstance._container).removeClass('selectable-cursor');\n                } else {\n                    layerInstance.enableGetFeatureInfo();\n                    jQuery(_mapInstance._container).addClass('selectable-cursor');\n                }\n            }\n\n        }\n    }\n\n\n    /* ==============================================\n       Feature operations\n       ============================================== */\n\n\n    /**\n     * @return array of features on the map\n     */\n    getFeatures () {\n        if(this._featureLayer) {\n            return this._featureLayer.toGeoJSON().features;\n        }\n        return [];\n    }\n\n    /**\n     * @param json geojson object or array of geojson objects\n     */\n    addFeatures (json) {\n\n        if(!json) return;\n\n        if(typeof(json.push) !== 'undefined') {\n            //array of features\n            for(var i=0; i<json.length; ++i)\n                this.addFeature(json[i], false);\n            this.touch('features:changed');\n\n        } else if(json.features) {\n            this.addFeatures(json.features);\n\n        } else { //single feature\n            this.addFeature(json, true);\n        }\n\n    }\n\n    /**\n     * @param json geojson object\n     */\n    addFeature (json, fireEvent) {\n        // var type = json.type;\n        // var coordinates = json.coordinates;\n\n        if(!L) {\n            throw new Error(\"Leaflet is not available\");\n        }\n\n        if(!this._featureLayer) {\n\n            // _featureLayer = geoJson([], _geoJsonLayerOpts).addTo(_mapInstance);\n            this._featureLayer = featureGroup().addTo(this._mapInstance);\n\n        }\n\n        // _featureLayer.addData(json);\n        var opts = jQuery.extend({}, this._geoJsonLayerOpts);\n        geoJson(json, opts).eachLayer((l)=>this.addFeatureLayer(l));\n\n        if(typeof(fireEvent) === 'undefined' || fireEvent === true)\n            this.touch('features:changed');\n        else this.touch();\n\n        // console.log(JSON.stringify(_featureLayer.toGeoJSON()));\n\n    }\n\n    /**\n     * @param featureJson object defining a GeoJSON feature\n     */\n    updateFeature (featureJson) {\n        var layer = this.getFeatureLayer(featureJson.properties.id);\n        if(layer) {\n\n            layer.feature = featureJson;\n\n            //update style\n            layer.setStyle(featureJson.properties.style);\n\n            //rebind label in case that changed\n            var label = featureJson.properties.label ||\n                \"Untitled \" + featureJson.geometry.type + \" Feature\";\n            layer.bindTooltip(label);\n\n            // layer.redraw();\n            this.touch(\"map:feature:changed\");\n        }\n    }\n\n    /**\n     * Replace an existing L.Path-based layer with one using\n     * the supplied Feature GeoJSON object.  Removes the existing\n     * layer and adds a new one created from the GeoJSON.\n     *\n     * @param featureJson object defining GeoJSON feature\n     */\n    replaceFeature (featureJson) {\n\n        if(!L) {\n            throw new Error(\"Leaflet is not available\");\n        }\n\n        //find existing layer for this feature\n        var layer = this.getFeatureLayer(featureJson.properties.id);\n        if(layer) {\n\n            //remove existing\n            this._featureLayer.removeLayer(layer);\n\n            //add replacement\n            geoJson(featureJson, this._geoJsonLayerOpts)\n                .eachLayer((l)=>this.addFeatureLayer(l));\n\n            this.touch(\"map:feature:changed\");\n        }\n    }\n\n    /**\n     * @param featureId identifier of feature to focus the map on\n     */\n    focusFeature (featureId) {\n        var layer = this.getFeatureLayer(featureId);\n        if(layer) {\n            if( typeof(layer.getBounds) !== 'undefined') {\n                let extent = layer.getBounds();\n                this._mapInstance.fitBounds(extent);\n            } else if(typeof(layer.getLatLng) !== 'undefined') {\n                let latLng = layer.getLatLng();\n                this._mapInstance.panTo(latLng);\n            } else {\n                console.log(\"MapInstance.focusFeature() - Cannot focus feature because it has no bounds or lat/lng\");\n            }\n        } else {\n            console.log(\"MapInstance.focusFeature() - Cannot focus feature because it has no layer\");\n        }\n    }\n\n    /**\n     * @param\n     */\n    removeFeature (featureId) {\n        var layer = this.getFeatureLayer(featureId);\n        if(layer && this._featureLayer) {\n            this._featureLayer.removeLayer(layer);\n            this.touch('features:changed');\n        }\n    }\n\n    /**\n     *\n     */\n    removeFeatures () {\n        if(this._featureLayer) {\n            this._featureLayer.clearLayers();\n            this.touch(\"features:changed\");\n        }\n    }\n\n    /**\n     *\n     */\n    getFeatureLayer (featureId) {\n        if(!this._featureLayer) return null;\n\n        var features = this._featureLayer.getLayers();\n        for(var i=0; i<features.length; ++i) {\n            if(features[i].feature.properties.id === featureId) {\n                return features[i];\n            }\n        }\n        return null;\n    }\n\n    toggleFeaturesLayer () {\n        if(!this._featureLayer) return false;    //ignore if not rendered yet\n\n        this._featureLayerVisible = !this._featureLayerVisible;\n        this.setFeatureLayerVisibility(this._featureLayer, this._featureLayerVisible);\n        return this._featureLayerVisible;\n    }\n\n    /**\n     * @param {L.Feature} feature - Leaflet feature instance\n     * @param {boolean} visibility - flag\n     */\n    setFeatureVisibility (feature, visibility) {\n        this.setFeatureLayerVisibility(feature, visibility);\n    }\n\n    getFeaturesLayerVisibility () {\n        return this._featureLayerVisible;\n    }\n\n\n    /*\n     * method for adding feature layers to the map\n     * when these layers may be layer groups.\n     * finds leaf node layers and adds them to the\n     * map's feature group\n     */\n    addFeatureLayer(layer) {\n        this._addFeatureLayer(layer);\n        this.touch(\"features:changed\");\n    }\n\n    /**\n     * Internal method, use 'addFeatureLayer' instead\n     * @param {Object} layer\n     */\n    _addFeatureLayer(layer) {\n        if(!L) {\n            throw new Error(\"Leaflet is not available\");\n        }\n        if(!layer.feature && layer instanceof LayerGroup) {\n            layer.eachLayer( (child) => {\n                this._addFeatureLayer(child);\n            });\n        } else {\n            this._featureLayer.addLayer(layer);\n        }\n    }\n\n\n    //toggle visibility of parent feature layer\n    setFeatureLayerVisibility(layer, visibility) {\n        if(!layer) return;\n        this._featureLayerVisible = visibility;\n\n        if(layer.getLayers) {\n            layer.getLayers().each( (child) => {\n                this.setFeatureLayerVisibility(child, visibility);\n            });\n\n        } else {\n            let container = layer._container || layer._path;\n            if(container)\n                container.style.display = visibility ? '' : 'none';\n        }\n    }\n\n\n\n    /* ==============================================\n       Map lifecycle operations\n       ============================================== */\n\n    /**\n     * @param {Object} metadata\n     * @return {Promise} resolving persisted map\n     */\n    save (metadata) {\n        return this.saveMap(metadata);\n    }\n\n    /**\n     * @param md object containing metadata properties for map\n     */\n    saveMap (md) {\n\n        let metadata = md || {};\n\n        //add GeoPlatformMap resource type if not already present\n        const gpMapType = 'http://www.geoplatform.gov/ont/openmap/GeoplatformMap';\n        metadata.resourceTypes = metadata.resourceTypes || [];\n        if(metadata.resourceTypes.indexOf(gpMapType) < 0)\n            metadata.resourceTypes.push(gpMapType);\n\n        var content = this.getMapResourceContent(metadata);\n\n        //ensure the two name properties line up\n        if(content.title && content.title !== content.label) {\n            content.label = content.title;\n        } else if(content.label && !content.title) {\n            content.title = content.label;\n        }\n\n        // console.log(\"Updating: \" + JSON.stringify(map));\n        return this.getService(ItemTypes.MAP)\n        .save(content)\n        .then( result => {\n\n            //track new map's info so we can update it with next save\n            if(!this._mapId)\n                this._mapId = result.id;\n\n            this._mapDef = result;\n            this._defaultExtent = result.extent;\n            this.clean();\n            return result;\n        })\n        .catch(err=>{\n            console.log(\"MapCore MapInstance.saveMap() - \" +\n                \"The requested map could not be saved because: \" + err.message);\n            let e = new Error(\"The requested map could not be saved because of the following error(s): \" +\n                err.message);\n            return Q.reject(e);\n        });\n\n    }\n\n    /**\n     * Retrieve a map's descriptor from the registry\n     * @param {string} mapId identifier of map\n     * @return {Promise} resolving the map object\n     */\n    fetchMap (mapId) {\n        //Having to send cache busting parameter to avoid CORS header cache\n        // not sending correct Origin value\n        return this.getService(ItemTypes.MAP).get(mapId);\n    }\n\n    /**\n     * Retrieve a map's descriptor and load it as the\n     * current map managed by this service\n     * @param {string} mapId identifier of map\n     * @return {Promise} resolving the map object\n     */\n    loadMap (mapId) {\n\n        return this.fetchMap(mapId).then(map => {\n\n            if(!map) {\n                throw new Error(\"The requested map ('\" + mapId +\n                    \"') came back null\");\n\n            } else if(typeof(map) === 'string') {\n                throw new Error(\"The requested map ('\" + mapId +\n                    \"') came back as a string\");\n\n            } else if(map.message) {\n                throw new Error(\"There was an error loading the requested map ('\" +\n                    mapId + \"'): \" + map.message);\n            }\n\n\n            //loading a map by its ID, so we need to increment it's view count\n            if('development' !== Config.env) {\n\n                setTimeout( (map) => {\n                    //update view count\n                    let views = map.statistics ? (map.statistics.numViews||0) : 0;\n                    let patch = [ { op: 'replace', path: '/statistics/numViews', value: views+1 } ];\n                    this.getService(ItemTypes.MAP).patch(map.id, patch)\n                    // this.mapService.patch(map.id, patch)\n                    .then( updated => { map.statistics = updated.statistics; })\n                    .catch( e => {\n                        console.log(\"MapInstance.saveMap() - Error updating view \" +\n                            \"count for map ('\" + mapId + \"'): \" + e);\n                    });\n                }, 1000, map);\n\n            }\n\n            //load the map into the viewer\n            this.loadMapFromObj(map);\n\n            return map;\n        })\n        .catch( err => {\n            console.log(\"MapInstance.loadMap() - \" +\n                \"The requested map could not be loaded because \" + err.message);\n            let e = new Error(\"The requested map ('\" + mapId +\n                \"') could not be loaded because of the following error(s): \" +\n                err.message);\n            return Q.reject(e);\n        });\n    }\n\n\n    /**\n     * Load a map from its descriptor as the current\n     * map managed by this service\n     * @param map object\n     */\n    loadMapFromObj (map) {\n\n        // console.log(\"Loading Map Object\");\n        // console.log(map);\n\n        this._mapId = map.id;\n        this._mapDef = map;\n\n        map.extent = this.ensureExtent(map.extent);\n\n        //set extent from loaded map\n        this._defaultExtent = map.extent;\n        var extent = map.extent;\n\n        //remove existing layers\n        this._mapInstance.eachLayer((l) => {\n            this._mapInstance.removeLayer(l);\n        });\n        this._layerCache = {};\n        this._layerStates = [];\n\n        //set new base layer\n        this.setBaseLayer(map.baseLayer);\n\n        //add layers from loaded map\n        this.addLayers(map.layers);\n\n        //add features\n        if(map.annotations && map.annotations.geoJSON) {\n            let fc = map.annotations.geoJSON;\n            if(fc.features)\n                this.addFeatures(fc.features);\n            else\n                this.addFeatures([fc]);\n        }\n\n        this._mapInstance.fitBounds([\n            [extent.miny, extent.minx],\n            [extent.maxy, extent.maxx]\n        ]);\n\n        this.clean();\n        this.notify('map:loaded', map);\n\n    }\n\n    /**\n     * @param {object} extent\n     * @return {object} corrected or default extent\n     */\n    ensureExtent( extent ) {\n\n        let west  = !extent || isNaN(extent.minx) ? -179.0 : extent.minx*1.0;\n        let east  = !extent || isNaN(extent.maxx) ?  179.0 : extent.maxx*1.0;\n        let south = !extent || isNaN(extent.miny) ?  -89.0 : extent.miny*1.0;\n        let north = !extent || isNaN(extent.maxy) ?   89.0 : extent.maxy*1.0;\n\n        //ensure x,y is ordered correctly\n        let t;\n        if(west > east) {\n            t = Math.min(west, east);\n            east = Math.max(west, east);\n            west = t;\n        }\n        if(south > north) {\n            t = Math.min(south, north);\n            north = Math.max(south, north);\n            south = t;\n        }\n\n        //prevent out-of-bounds extents\n        if(west < -180.0) west = -179.0;\n        if(east > 180.0)  east =  179.0;\n        if(south < -90.0) south = -89.0;\n        if(north > 90.0)  north =  89.0;\n\n        return { minx : west, miny : south, maxx : east, maxy : north };\n    }\n\n\n    /**\n     *\n     */\n    destroyMap () {\n        // console.log(\"Destroying Map\");\n        this._mapInstance = null;\n        this._layerCache = null;\n        this._layerStates = null;\n        this._featureLayer = null;\n    }\n\n    /**\n     * Used to take an existing map that is already persisted on the\n     * server and unlink it here in the client so that it will be saved\n     * as a completely new map when mapService.saveMap(...) is next called\n     */\n    setAsNewMap (mapToUse) {\n        this._mapId = null;\n        this._mapDef = mapToUse || this.initializeMapDefinition();\n    }\n\n\n    /* ==============================================\n        Tool operations\n       ============================================== */\n\n    registerTool (id, tool) {\n        this._tools[id] = tool;\n    }\n\n    unregisterTool (id) {\n        this._tools[id] = null;\n    }\n\n    enableTool (id, finish) {\n        if(!this._tools[id]) return false;\n        this._tools[id].activate(function() {\n            this.notify('tool:disabled', id);\n        });\n        this.notify('tool:enabled', id);\n    }\n\n\n    /* ----------- MISC ------------ */\n\n    //https://github.com/gsklee/ngStorage\n    cacheMap () {\n\n        if(state.dirty) {\n            var map = this.getMapResourceContent();\n            //use exploded layer info\n            map.layers = this._layerStates.slice(0);\n            // $sessionStorage.map = map;\n        }\n    }\n\n    restoreMap () {\n        // if($sessionStorage.map) {\n        //     console.log(\"Restoring cached map\");\n        //     let map = $sessionStorage.map;\n        //     // console.log(JSON.stringify(map));\n        //     $sessionStorage.map = null;\n        //     this.loadMapFromObj(map);\n        // }\n    }\n    /* ---------------------------- */\n}\n\nexport default MapInstance;\n","\nimport MapInstance from './instance';\n\nvar cache = {};\n\nexport default {\n\n    get: function(key) {\n        if(key && cache[key])\n            return cache[key];\n\n        let instance = new MapInstance(key);\n        cache[instance._key] = instance;\n        return instance;\n    },\n\n    dispose: function(key) {\n        if(key) {\n            cache[key].dispose();\n            delete cache[key];\n        } else {\n            cache = null;\n        }\n    }\n};\n","\nimport * as L from \"leaflet\";\nimport * as esri from \"esri-leaflet\";\n\n\nimport LoadingControl from './control/L.Control.Loading';\nimport MeasureControl from './control/L.Control.MeasureControl';\nimport MousePositionControl from './control/L.Control.MousePosition';\n\nimport DefaultBaseLayer from './layer/baselayer-default';\nimport LayerFactory from './layer/factory';\nimport OSMLayerFactory from './layer/osm-factory';\nimport ESRIClusterFeatureLayer from './layer/L.esri.Cluster.FeatureLayer';\nimport {\n    ClusteredFeatureLayer,\n    clusteredFeatures,\n    geoJsonFeed\n} from './layer/cluster-feature';\nimport FeatureLayer from './layer/feature';\nimport {WMS, wms} from './layer/wms';\nimport {WMST, wmst} from './layer/wmst';\nimport {WMTS, wmts} from './layer/wmts';\nimport ESRITileLayer from './layer/L.TileLayer.ESRI';\nimport OSM from './layer/osm';\n\nimport MapInstance from './map/instance';\nimport MapFactory from './map/factory';\n\nimport ServiceTypes from './service/types';\n\nimport PopupTemplate from './shared/popup-template';\nimport StyleResolver from './shared/style-resolver';\n\n\n\nif(typeof(Array.prototype.each) === 'undefined') {\n    Array.prototype.each = function(fn) {\n        let arr = this, len = arr.length;\n        for(let i=0; i<len; ++i) {\n            try {\n                fn(arr[i]);\n            } catch(e) {\n                throw e;\n            }\n        }\n    };\n}\n\n\n\n\n\nexport default {\n\n    //export Leaflet bound inside this plugin to ensure the correct instance\n    // of leaflet is being referenced by other plugins (ie, Marker Cluster)\n    // the \"isLatLngBounds\" method issue where a different instance of Leaflet\n    // was being compared and resulted in a false equivalence, breaking the\n    // clustering layer code\n    L,\n\n    LoadingControl,\n    MeasureControl,\n    MousePositionControl,\n    DefaultBaseLayer,\n    LayerFactory,\n    OSMLayerFactory,\n    ESRIClusterFeatureLayer,\n    ClusteredFeatureLayer,\n    clusteredFeatures,\n    geoJsonFeed,\n    FeatureLayer,\n    WMS,\n    wms,\n    WMST,\n    wmst,\n    WMTS,\n    wmts,\n    ESRITileLayer,\n    OSM,\n    MapInstance,\n    MapFactory,\n    ServiceTypes,\n    PopupTemplate,\n    StyleResolver\n};\n"],"names":["loadingControl","Control","extend","options","position","separate","zoomControl","spinjs","spin","lines","length","width","radius","rotate","top","initialize","setOptions","_dataLoaders","onAdd","map","Spinner","console","error","_addLayerListeners","_addMapListeners","zoomsliderControl","classes","container","_container","DomUtil","create","_indicator","_spinner","appendChild","el","onRemove","_removeLayerListeners","_removeMapListeners","removeFrom","removeChild","_map","prototype","call","addLoader","id","updateIndicator","removeLoader","isLoading","_showIndicator","_hideIndicator","_countLoaders","size","key","hasOwnProperty","addClass","Zoom","removeClass","_zoomOutButton","Zoomslider","_ui","zoomOut","_handleLoading","e","getEventId","_handleLoad","layer","_leaflet_id","target","_layerAdd","on","loading","load","exception","warn","eachLayer","off","dataloading","dataload","layerremove","Loading","Map","addInitHook","addControl","measureControl","className","_createButton","_toggleMeasure","html","title","fn","context","link","innerHTML","href","DomEvent","stopPropagation","preventDefault","_measuring","_startMeasuring","_stopMeasuring","_oldCursor","style","cursor","_doubleClickZoom","doubleClickZoom","enabled","disable","_mouseMove","_mouseClick","_finishPath","document","_onKeyDown","_layerPaint","layerGroup","addTo","_points","enable","clearLayers","_restartPath","latlng","_lastPoint","_layerPaintPathTemp","polyline","color","weight","clickable","dashArray","spliceLatLngs","_tooltip","_distance","_updateTooltipPosition","distance","distanceTo","_updateTooltipDistance","_createTooltip","_layerPaintPath","addLatLng","_lastCircle","removeLayer","CircleMarker","opacity","fill","fillOpacity","undefined","icon","divIcon","iconAnchor","marker","setLatLng","total","difference","totalRound","_round","differenceRound","text","_icon","val","Math","round","keyCode","Measure","control","measure","mergeOptions","positionControl","separator","emptyString","lngFirst","numDigits","lngFormatter","latFormatter","prefix","disableClickPropagation","_onMouseMove","lng","Util","formatNum","lat","value","prefixAndValue","MousePosition","mousePosition","QueryFactory","GeoPlatformClient","LayerService","HttpClient","JQueryHttpClient","Config","test","resourceTypes","indexOf","get","layerService","query","fields","ualUrl","search","then","response","results","catch","Q","reject","WORLD_STREET_LAYER","DefaultBaseLayer","baseLayerId","defaultBaseLayerId","resolve","OSM","set","configure","ogcExpr","esriExpr","keyFn","expr","str","m","exec","types","ESRI_FEATURE_SERVER","ESRI_IMAGE_SERVER","ESRI_MAP_SERVER","ESRI_TILE_SERVER","KML","CSW","WCS","WFS","WMS","WMTS","WMST","FEED","refresh","updateList","service","url","log","pageSize","svc","ItemService","i","data","type","label","supported","toUpperCase","message","featurePopupTemplate","feature","props","Object","keys","properties","pFn","list","names","find","match","lc","name","toLowerCase","titleProp","descProp","description","result","modified","Date","toDateString","date","toTimeString","linkProp","prop","p","FeatureLayer","esri","_gpStyle","fillColor","pointToLayerFn","shape","height","iconFn","iconUrl","content","iconSize","popupAnchor","mopts","leafletPane","pane","markerFn","stroke","renderer","circleMarkerFn","popupTemplate","bindPopup","eachFeatureFn","geometry","getGPStyle","svgOpts","SVG","svg","Canvas","canvas","pointToLayer","bind","onEachFeature","zIndex","setZIndex","index","_layers","toggleVisibility","setOpacity","loadStyle","gpLayerId","styleLoader","json","styles","styleFn","property","field1","v","wrapper","sw","setStyle","push","obj","jQuery","statics","EVENTS","CLUSTEREVENTS","_leafletIds","cluster","L","markerClusterGroup","_key","random","toString","replace","addEventParent","addLayer","createLayers","features","markers","geojson","newLayer","GeoJSON","geometryToLayer","asFeature","defaultOptions","resetStyle","fire","timeField","_featureWithinTimeRange","addLayers","ids","layersToAdd","removeLayers","permanent","layersToRemove","setFeatureStyle","eachFeature","getFeature","featureLayer","featureStyleResolver","deferred","defer","Error","promise","ajax","dataType","success","xhr","status","em","ClusteredFeatureLayer","EsriClusterFeatureLayer","currentVisibility","currentOpacity","spiderfyDistanceMultiplier","styleResolver","layerId","setVisibility","lyr","_updateZIndex","_renderer","bool","_featureGroup","display","isNaN","css","JSON","stringify","setTimeout","clusteredFeatures","services","msg","format","supportedFormats","opts","layerName","geoJsonFeed","layerUrl","styleUrl","styleLoaderFactory","isModern","TileLayer","enableGetFeatureInfo","getFeatureInfo","_enabled","disableGetFeatureInfo","isGetFeatureInfoEnabled","evt","getFeatureInfoUrl","showResults","showGetFeatureInfo","parseGetFeatureInfo","point","latLngToContainerPoint","getZoom","getSize","params","srs","bbox","getBounds","toBBoxString","y","x","info_format","j","wmsParams","wmvId","getParamString","field","join","err","popup","maxWidth","setContent","openOn","wms","formats","supportedCrs","crs","version","versions","serviceTypeVersions","layers","transparent","xml","querySelectorAll","_baseLayer","times","forEach","current","querySelector","_getTimesFromLayerCapabilities","parentNode","dimensions","textContent","trim","extents","toISOString","Layer","wmst","gpLayer","leafletLayer","proxyUrl","tdOpts","temporal","d1","startDate","d2","endDate","timeDimension","proxy","tileLayer","assign","defineProperty","varArgs","TypeError","to","arguments","nextSource","nextKey","writable","configurable","paramRe","template","defaultWmtsParams","request","tileMatrixSet","_url","wmtsParams","tileSize","detectRetina","Browser","retina","matrixIds","getDefaultMatrix","_crs","getTileUrl","coords","nwPoint","multiplyBy","sePoint","add","Point","zoom","_tileZoom","nw","project","unproject","se","tilewidth","ident","identifier","tileMatrix","X0","topLeftCorner","Y0","tilecol","floor","tilerow","isTileMatrixTemplated","isTileRowTemplated","isTileColTemplated","o","s","_getSubdomain","TileMatrix","TileRow","TileCol","k","qsi","setParams","noRedraw","redraw","matrixIds3857","Array","LatLng","wmts","distro","distributions","dist","mediaType","parameters","each","plc","param","defaultValue","values","esriTileLayer","defaultESRIParams","f","qidx","substring","esriParams","dim","imagesr","bboxsr","code","tilePoint","z","ESRI","OSMLayerFactory","minZoom","maxZoom","attribution","styleResolverFactory","LayerFactory","factories","init","register","typeUri","serviceType","uri","supportedCRS","checkUrl","ServiceTypes","ESRITileLayer","getStyleResolver","useCors","MBVTRT","protobuf","rendererFactory","tile","ItemTypes","ServiceFactory","Listener","_listeners","listener","idx","splice","args","slice","l","apply","MapInstance","setHttpClient","setServiceFactory","ceil","_mapId","_mapDef","initializeMapDefinition","_mapInstance","_defaultExtent","_baseLayerDef","_layerStates","_layerCache","_layerErrors","_layerErrorHandler","_featureLayer","_featureLayerVisible","_tools","state","dirty","_geoJsonLayerOpts","desc","bindTooltip","circleMarker","destroyMap","svcCache","serviceFactory","httpClient","mapService","factory","getLayerStateIndex","MAP","createdBy","baseLayer","keywords","themes","metadata","annotations","geoJSON","toGeoJSON","extent","minx","getWest","miny","getSouth","maxx","getEast","maxy","getNorth","drawControl","toolbars","_toolbars","toolbar","_modes","processLayerError","finder","logLayerError","src","split","getService","LAYER","validate","def","notify","errorMsg","event","setView","touch","latLng","getCenter","fitBounds","oldBaseLayer","layerInstance","layerCopy","parse","visibility","addLayerWithState","handleLayerError","setLayerVisibility","setLayerOpacity","from","copy","layerState","getLayers","getLayerState","_currentImage","getOpacity","visible","addFeature","addFeatures","fireEvent","featureGroup","geoJson","addFeatureLayer","featureJson","getFeatureLayer","featureId","getLatLng","panTo","setFeatureLayerVisibility","_addFeatureLayer","LayerGroup","child","_path","saveMap","md","gpMapType","getMapResourceContent","save","clean","mapId","fetchMap","env","views","statistics","numViews","patch","op","path","updated","loadMapFromObj","ensureExtent","setBaseLayer","fc","west","east","south","north","t","min","max","mapToUse","tool","finish","activate","cache","instance","dispose","arr","len","LoadingControl","MeasureControl","MousePositionControl","ESRIClusterFeatureLayer","MapFactory","PopupTemplate","StyleResolver"],"mappings":";;;;;;;;;;;IAGA,IAAIA,iBAAiBC,YAAQC,MAAR,CAAe;IAChCC,aAAS;IACLC,kBAAU,SADL;IAELC,kBAAU,KAFL;IAGLC,qBAAa,IAHR;IAILC,gBAAQ,KAJH;IAKLC,cAAM;IACJC,mBAAO,CADH;IAEJC,oBAAQ,CAFJ;IAGJC,mBAAO,CAHH;IAIJC,oBAAQ,CAJJ;IAKJC,oBAAQ,EALJ;IAMJC,iBAAK;IAND;IALD,KADuB;;IAgBhCC,gBAAY,oBAASZ,OAAT,EAAkB;IAC1Ba,uBAAW,IAAX,EAAiBb,OAAjB;IACA,aAAKc,YAAL,GAAoB,EAApB;;IAEA;IACA;IACA,YAAI,KAAKd,OAAL,CAAaG,WAAb,KAA6B,IAAjC,EAAuC;IACnC,iBAAKA,WAAL,GAAmB,KAAKH,OAAL,CAAaG,WAAhC;IACH;IACJ,KAzB+B;;IA2BhCY,WAAO,eAASC,GAAT,EAAc;IACjB,YAAI,KAAKhB,OAAL,CAAaI,MAAb,IAAwB,OAAOa,OAAP,KAAmB,UAA/C,EAA4D;IACxD,mBAAOC,QAAQC,KAAR,CAAc,oIAAd,CAAP;IACH;IACD,aAAKC,kBAAL,CAAwBJ,GAAxB;IACA,aAAKK,gBAAL,CAAsBL,GAAtB;;IAEA;IACA;IACA,YAAI,CAAC,KAAKhB,OAAL,CAAaE,QAAd,IAA0B,CAAC,KAAKC,WAApC,EAAiD;IAC7C,gBAAIa,IAAIb,WAAR,EAAqB;IACjB,qBAAKA,WAAL,GAAmBa,IAAIb,WAAvB;IACH,aAFD,MAEO,IAAIa,IAAIM,iBAAR,EAA2B;IAC9B,qBAAKnB,WAAL,GAAmBa,IAAIM,iBAAvB;IACH;IACJ;;IAED;IACA,YAAIC,UAAU,yBAAd;IACA,YAAIC,SAAJ;IACA,YAAI,KAAKrB,WAAL,IAAoB,CAAC,KAAKH,OAAL,CAAaE,QAAtC,EAAgD;IAC5C;IACAsB,wBAAY,KAAKrB,WAAL,CAAiBsB,UAA7B;IACA;IACAF,uBAAW,gDAAX;IACH,SALD,MAMK;IACD;IACAC,wBAAYE,YAAQC,MAAR,CAAe,KAAf,EAAsB,kCAAtB,CAAZ;IACH;IACD,aAAKC,UAAL,GAAkBF,YAAQC,MAAR,CAAe,GAAf,EAAoBJ,OAApB,EAA6BC,SAA7B,CAAlB;IACA,YAAI,KAAKxB,OAAL,CAAaI,MAAjB,EAAyB;IACvB,iBAAKyB,QAAL,GAAgB,IAAIZ,OAAJ,CAAY,KAAKjB,OAAL,CAAaK,IAAzB,EAA+BA,IAA/B,EAAhB;IACA,iBAAKuB,UAAL,CAAgBE,WAAhB,CAA4B,KAAKD,QAAL,CAAcE,EAA1C;IACD;IACD,eAAOP,SAAP;IACH,KA/D+B;;IAiEhCQ,cAAU,kBAAShB,GAAT,EAAc;IACpB,aAAKiB,qBAAL,CAA2BjB,GAA3B;IACA,aAAKkB,mBAAL,CAAyBlB,GAAzB;IACH,KApE+B;;IAsEhCmB,gBAAY,oBAAUnB,GAAV,EAAe;IACvB,YAAI,KAAKb,WAAL,IAAoB,CAAC,KAAKH,OAAL,CAAaE,QAAtC,EAAgD;IAC5C;IACA;IACA,iBAAKuB,UAAL,CAAgBW,WAAhB,CAA4B,KAAKR,UAAjC;IACA,iBAAKS,IAAL,GAAY,IAAZ;IACA,iBAAKL,QAAL,CAAchB,GAAd;IACA,mBAAO,IAAP;IACH,SAPD,MAQK;IACD;IACA;IACA,mBAAOlB,YAAQwC,SAAR,CAAkBH,UAAlB,CAA6BI,IAA7B,CAAkC,IAAlC,EAAwCvB,GAAxC,CAAP;IACH;IACJ,KApF+B;;IAsFhCwB,eAAW,mBAASC,EAAT,EAAa;IACpB,aAAK3B,YAAL,CAAkB2B,EAAlB,IAAwB,IAAxB;IACA,aAAKC,eAAL;IACH,KAzF+B;;IA2FhCC,kBAAc,sBAASF,EAAT,EAAa;IACvB,eAAO,KAAK3B,YAAL,CAAkB2B,EAAlB,CAAP;IACA,aAAKC,eAAL;IACH,KA9F+B;;IAgGhCA,qBAAiB,2BAAW;IACxB,YAAI,KAAKE,SAAL,EAAJ,EAAsB;IAClB,iBAAKC,cAAL;IACH,SAFD,MAGK;IACD,iBAAKC,cAAL;IACH;IACJ,KAvG+B;;IAyGhCF,eAAW,qBAAW;IAClB,eAAO,KAAKG,aAAL,KAAuB,CAA9B;IACH,KA3G+B;;IA6GhCA,mBAAe,yBAAW;IACtB,YAAIC,OAAO,CAAX;IAAA,YAAcC,GAAd;IACA,aAAKA,GAAL,IAAY,KAAKnC,YAAjB,EAA+B;IAC3B,gBAAI,KAAKA,YAAL,CAAkBoC,cAAlB,CAAiCD,GAAjC,CAAJ,EAA2CD;IAC9C;IACD,eAAOA,IAAP;IACH,KAnH+B;;IAqHhCH,oBAAgB,0BAAW;IACvB;IACAnB,oBAAQyB,QAAR,CAAiB,KAAKvB,UAAtB,EAAkC,YAAlC;;IAEA;IACA,YAAI,CAAC,KAAK5B,OAAL,CAAaE,QAAlB,EAA4B;IACxB,gBAAI,KAAKC,WAAL,YAA4BL,YAAQsD,IAAxC,EAA8C;IAC1C1B,4BAAQ2B,WAAR,CAAoB,KAAKlD,WAAL,CAAiBmD,cAArC,EAAqD,yBAArD;IACH,aAFD,MAGK,IAAI,OAAOxD,YAAQyD,UAAf,KAA8B,UAA9B,IAA4C,KAAKpD,WAAL,YAA4BL,YAAQyD,UAApF,EAAgG;IACjG7B,4BAAQ2B,WAAR,CAAoB,KAAKlD,WAAL,CAAiBqD,GAAjB,CAAqBC,OAAzC,EAAkD,yBAAlD;IACH;IACJ;IACJ,KAlI+B;;IAoIhCX,oBAAgB,0BAAW;IACvB;IACApB,oBAAQ2B,WAAR,CAAoB,KAAKzB,UAAzB,EAAqC,YAArC;;IAEA;IACA,YAAI,CAAC,KAAK5B,OAAL,CAAaE,QAAlB,EAA4B;IACxB,gBAAI,KAAKC,WAAL,YAA4BL,YAAQsD,IAAxC,EAA8C;IAC1C1B,4BAAQyB,QAAR,CAAiB,KAAKhD,WAAL,CAAiBmD,cAAlC,EAAkD,yBAAlD;IACH,aAFD,MAGK,IAAI,OAAOxD,YAAQyD,UAAf,KAA8B,UAA9B,IAA4C,KAAKpD,WAAL,YAA4BL,YAAQyD,UAApF,EAAgG;IACjG7B,4BAAQyB,QAAR,CAAiB,KAAKhD,WAAL,CAAiBqD,GAAjB,CAAqBC,OAAtC,EAA+C,yBAA/C;IACH;IACJ;IACJ,KAjJ+B;;IAmJhCC,oBAAgB,wBAASC,CAAT,EAAY;IACxB,aAAKnB,SAAL,CAAe,KAAKoB,UAAL,CAAgBD,CAAhB,CAAf;IACH,KArJ+B;;IAuJhCE,iBAAa,qBAASF,CAAT,EAAY;IACrB,aAAKhB,YAAL,CAAkB,KAAKiB,UAAL,CAAgBD,CAAhB,CAAlB;IACH,KAzJ+B;;IA2JhCC,gBAAY,oBAASD,CAAT,EAAY;IACpB,YAAIA,EAAElB,EAAN,EAAU;IACN,mBAAOkB,EAAElB,EAAT;IACH,SAFD,MAGK,IAAIkB,EAAEG,KAAN,EAAa;IACd,mBAAOH,EAAEG,KAAF,CAAQC,WAAf;IACH;IACD,eAAOJ,EAAEK,MAAF,CAASD,WAAhB;IACH,KAnK+B;;IAqKhCE,eAAW,mBAASN,CAAT,EAAY;IACnB,YAAI,CAACA,EAAEG,KAAH,IAAY,CAACH,EAAEG,KAAF,CAAQI,EAAzB,EAA6B;IAC7B,YAAI;IACAP,cAAEG,KAAF,CAAQI,EAAR,CAAW;IACPC,yBAAS,KAAKT,cADP;IAEPU,sBAAM,KAAKP;IAFJ,aAAX,EAGG,IAHH;IAIH,SALD,CAMA,OAAOQ,SAAP,EAAkB;IACdnD,oBAAQoD,IAAR,CAAa,gDACA,0BADb,EACyCX,EAAEG,KAD3C;IAEA5C,oBAAQoD,IAAR,CAAa,iCAAb,EAAgDD,SAAhD;IACH;IACJ,KAlL+B;;IAoLhCjD,wBAAoB,4BAASJ,GAAT,EAAc;IAC9B;IACA;IACAA,YAAIuD,SAAJ,CAAc,UAAST,KAAT,EAAgB;IAC1B,gBAAI,CAACA,MAAMI,EAAX,EAAe;IACfJ,kBAAMI,EAAN,CAAS;IACLC,yBAAS,KAAKT,cADT;IAELU,sBAAM,KAAKP;IAFN,aAAT,EAGG,IAHH;IAIH,SAND,EAMG,IANH;;IAQA;IACA;IACA7C,YAAIkD,EAAJ,CAAO,UAAP,EAAmB,KAAKD,SAAxB,EAAmC,IAAnC;IACH,KAlM+B;;IAoMhChC,2BAAuB,+BAASjB,GAAT,EAAc;IACjC;IACAA,YAAIuD,SAAJ,CAAc,UAAST,KAAT,EAAgB;IAC1B,gBAAI,CAACA,MAAMU,GAAX,EAAgB;IAChBV,kBAAMU,GAAN,CAAU;IACNL,yBAAS,KAAKT,cADR;IAENU,sBAAM,KAAKP;IAFL,aAAV,EAGG,IAHH;IAIH,SAND,EAMG,IANH;;IAQA;IACA7C,YAAIwD,GAAJ,CAAQ,UAAR,EAAoB,KAAKP,SAAzB,EAAoC,IAApC;IACH,KAhN+B;;IAkNhC5C,sBAAkB,0BAASL,GAAT,EAAc;IAC5B;IACA;IACA;IACAA,YAAIkD,EAAJ,CAAO;IACHO,yBAAa,KAAKf,cADf;IAEHgB,sBAAU,KAAKb,WAFZ;IAGHc,yBAAa,KAAKd;IAHf,SAAP,EAIG,IAJH;IAKH,KA3N+B;;IA6NhC3B,yBAAqB,6BAASlB,GAAT,EAAc;IAC/BA,YAAIwD,GAAJ,CAAQ;IACJC,yBAAa,KAAKf,cADd;IAEJgB,sBAAU,KAAKb,WAFX;IAGJc,yBAAa,KAAKd;IAHd,SAAR,EAIG,IAJH;IAKH;IAnO+B,CAAf,CAArB;;AAwOA/D,gBAAQ8E,OAAR,GAAkB/E,cAAlB;AACAC,gBAAQqE,OAAR,GAAkB,UAASnE,OAAT,EAAkB;IAChC,WAAO,IAAIF,YAAQ8E,OAAZ,CAAoB5E,OAApB,CAAP;IACH,CAFD;AAGA6E,YAAIC,WAAJ,CAAgB,YAAY;IACxB,QAAI,KAAK9E,OAAL,CAAaH,cAAjB,EAAiC;IAC7B,aAAKA,cAAL,GAAsB,IAAIA,cAAJ,EAAtB;IACA,aAAKkF,UAAL,CAAgB,KAAKlF,cAArB;IACH;IACJ,CALD;;ICpOA,IAAImF,iBAAiBlF,YAAQC,MAAR,CAAe;IAChCC,aAAS;IACLC,kBAAU;IADL,KADuB;;IAKhCc,WAAO,eAAUC,GAAV,EAAe;IAClB,YAAIiE,YAAY,kDAAhB;IAAA,YACIzD,YAAYE,YAAQC,MAAR,CAAe,KAAf,EAAsBsD,SAAtB,CADhB;;IAGA,aAAKC,aAAL,CAAmB,SAAnB,EAA8B,SAA9B,EAAyC,0EAAzC,EAAqH1D,SAArH,EAAgI,KAAK2D,cAArI,EAAqJ,IAArJ;;IAEA,eAAO3D,SAAP;IACH,KAZ+B;;IAchC0D,mBAAe,uBAAUE,IAAV,EAAgBC,KAAhB,EAAuBJ,SAAvB,EAAkCzD,SAAlC,EAA6C8D,EAA7C,EAAiDC,OAAjD,EAA0D;IACrE,YAAIC,OAAO9D,YAAQC,MAAR,CAAe,GAAf,EAAoBsD,SAApB,EAA+BzD,SAA/B,CAAX;IACAgE,aAAKC,SAAL,GAAiBL,IAAjB;IACAI,aAAKE,IAAL,GAAY,GAAZ;IACAF,aAAKH,KAAL,GAAaA,KAAb;;IAEAM,qBACKzB,EADL,CACQsB,IADR,EACc,OADd,EACuBG,aAASC,eADhC,EAEK1B,EAFL,CAEQsB,IAFR,EAEc,OAFd,EAEuBG,aAASE,cAFhC,EAGK3B,EAHL,CAGQsB,IAHR,EAGc,OAHd,EAGuBF,EAHvB,EAG2BC,OAH3B,EAIKrB,EAJL,CAIQsB,IAJR,EAIc,UAJd,EAI0BG,aAASC,eAJnC;;IAMA,eAAOJ,IAAP;IACH,KA3B+B;;IA6BhCL,oBAAgB,0BAAY;IACxB,aAAKW,UAAL,GAAkB,CAAC,KAAKA,UAAxB;;IAEA,YAAG,KAAKA,UAAR,EAAoB;IAChBpE,wBAAQyB,QAAR,CAAiB,KAAK1B,UAAtB,EAAkC,4BAAlC;IACA,iBAAKsE,eAAL;IACH,SAHD,MAGO;IACHrE,wBAAQ2B,WAAR,CAAoB,KAAK5B,UAAzB,EAAqC,4BAArC;IACA,iBAAKuE,cAAL;IACH;IACJ,KAvC+B;;IAyChCD,qBAAiB,2BAAW;IACxB,aAAKE,UAAL,GAAkB,KAAK5D,IAAL,CAAUZ,UAAV,CAAqByE,KAArB,CAA2BC,MAA7C;IACA,aAAK9D,IAAL,CAAUZ,UAAV,CAAqByE,KAArB,CAA2BC,MAA3B,GAAoC,WAApC;;IAEA,aAAKC,gBAAL,GAAwB,KAAK/D,IAAL,CAAUgE,eAAV,CAA0BC,OAA1B,EAAxB;IACA,aAAKjE,IAAL,CAAUgE,eAAV,CAA0BE,OAA1B;;IAEAZ,qBACKzB,EADL,CACQ,KAAK7B,IADb,EACmB,WADnB,EACgC,KAAKmE,UADrC,EACiD,IADjD,EAEKtC,EAFL,CAEQ,KAAK7B,IAFb,EAEmB,OAFnB,EAE4B,KAAKoE,WAFjC,EAE8C,IAF9C,EAGKvC,EAHL,CAGQ,KAAK7B,IAHb,EAGmB,UAHnB,EAG+B,KAAKqE,WAHpC,EAGiD,IAHjD,EAIKxC,EAJL,CAIQyC,QAJR,EAIkB,SAJlB,EAI6B,KAAKC,UAJlC,EAI8C,IAJ9C;;IAMA,YAAG,CAAC,KAAKC,WAAT,EAAsB;IAClB,iBAAKA,WAAL,GAAmBC,iBAAaC,KAAb,CAAmB,KAAK1E,IAAxB,CAAnB;IACH;;IAED,YAAG,CAAC,KAAK2E,OAAT,EAAkB;IACd,iBAAKA,OAAL,GAAe,EAAf;IACH;IACJ,KA7D+B;;IA+DhChB,oBAAgB,0BAAW;IACvB,aAAK3D,IAAL,CAAUZ,UAAV,CAAqByE,KAArB,CAA2BC,MAA3B,GAAoC,KAAKF,UAAzC;;IAEAN,qBACKnB,GADL,CACSmC,QADT,EACmB,SADnB,EAC8B,KAAKC,UADnC,EAC+C,IAD/C,EAEKpC,GAFL,CAES,KAAKnC,IAFd,EAEoB,WAFpB,EAEiC,KAAKmE,UAFtC,EAEkD,IAFlD,EAGKhC,GAHL,CAGS,KAAKnC,IAHd,EAGoB,OAHpB,EAG6B,KAAKoE,WAHlC,EAG+C,IAH/C,EAIKjC,GAJL,CAIS,KAAKnC,IAJd,EAIoB,UAJpB,EAIgC,KAAKoE,WAJrC,EAIkD,IAJlD;;IAMA,YAAG,KAAKL,gBAAR,EAA0B;IACtB,iBAAK/D,IAAL,CAAUgE,eAAV,CAA0BY,MAA1B;IACH;;IAED,YAAG,KAAKJ,WAAR,EAAqB;IACjB,iBAAKA,WAAL,CAAiBK,WAAjB;IACH;;IAED,aAAKC,YAAL;IACH,KAjF+B;;IAmFhCX,gBAAY,oBAAS7C,CAAT,EAAY;IACpB,YAAG,CAACA,EAAEyD,MAAH,IAAa,CAAC,KAAKC,UAAtB,EAAkC;IAC9B;IACH;;IAED,YAAG,CAAC,KAAKC,mBAAT,EAA8B;IAC1B,iBAAKA,mBAAL,GAA2BC,aAAS,CAAC,KAAKF,UAAN,EAAkB1D,EAAEyD,MAApB,CAAT,EAAsC;IAC7DI,uBAAO,OADsD;IAE7DC,wBAAQ,GAFqD;IAG7DC,2BAAW,KAHkD;IAI7DC,2BAAW;IAJkD,aAAtC,EAKxBZ,KALwB,CAKlB,KAAKF,WALa,CAA3B;IAMH,SAPD,MAOO;IACH,iBAAKS,mBAAL,CAAyBM,aAAzB,CAAuC,CAAvC,EAA0C,CAA1C,EAA6C,KAAKP,UAAlD,EAA8D1D,EAAEyD,MAAhE;IACH;;IAED,YAAG,KAAKS,QAAR,EAAkB;IACd,gBAAG,CAAC,KAAKC,SAAT,EAAoB;IAChB,qBAAKA,SAAL,GAAiB,CAAjB;IACH;;IAED,iBAAKC,sBAAL,CAA4BpE,EAAEyD,MAA9B;;IAEA,gBAAIY,WAAWrE,EAAEyD,MAAF,CAASa,UAAT,CAAoB,KAAKZ,UAAzB,CAAf;IACA,iBAAKa,sBAAL,CAA4B,KAAKJ,SAAL,GAAiBE,QAA7C,EAAuDA,QAAvD;IACH;IACJ,KA7G+B;;IA+GhCvB,iBAAa,qBAAS9C,CAAT,EAAY;IACrB;IACA,YAAG,CAACA,EAAEyD,MAAN,EAAc;IACV;IACH;;IAED;IACA,YAAG,KAAKC,UAAL,IAAmB,KAAKQ,QAA3B,EAAqC;IACjC,gBAAG,CAAC,KAAKC,SAAT,EAAoB;IAChB,qBAAKA,SAAL,GAAiB,CAAjB;IACH;;IAED,iBAAKC,sBAAL,CAA4BpE,EAAEyD,MAA9B;;IAEA,gBAAIY,WAAWrE,EAAEyD,MAAF,CAASa,UAAT,CAAoB,KAAKZ,UAAzB,CAAf;IACA,iBAAKa,sBAAL,CAA4B,KAAKJ,SAAL,GAAiBE,QAA7C,EAAuDA,QAAvD;;IAEA,iBAAKF,SAAL,IAAkBE,QAAlB;IACH;IACD,aAAKG,cAAL,CAAoBxE,EAAEyD,MAAtB;;IAGA;IACA,YAAG,KAAKC,UAAL,IAAmB,CAAC,KAAKe,eAA5B,EAA6C;IACzC,iBAAKA,eAAL,GAAuBb,aAAS,CAAC,KAAKF,UAAN,CAAT,EAA4B;IAC/CG,uBAAO,OADwC;IAE/CC,wBAAQ,CAFuC;IAG/CC,2BAAW;IAHoC,aAA5B,EAIpBX,KAJoB,CAId,KAAKF,WAJS,CAAvB;IAKH;;IAED,YAAG,KAAKuB,eAAR,EAAyB;IACrB,iBAAKA,eAAL,CAAqBC,SAArB,CAA+B1E,EAAEyD,MAAjC;IACH;;IAED;IACA,YAAG,KAAKkB,WAAR,EAAqB;IACjB,iBAAKzB,WAAL,CAAiB0B,WAAjB,CAA6B,KAAKD,WAAlC;IACH;;IAED,aAAKA,WAAL,GAAmB,IAAIE,gBAAJ,CAAiB7E,EAAEyD,MAAnB,EAA2B;IAC1CI,mBAAO,OADmC;IAE1CiB,qBAAS,CAFiC;IAG1ChB,oBAAQ,CAHkC;IAI1CiB,kBAAM,IAJoC;IAK1CC,yBAAa,CAL6B;IAM1ClI,oBAAO,CANmC;IAO1CiH,uBAAW,KAAKY,WAAL,GAAmB,IAAnB,GAA0B;IAPK,SAA3B,EAQhBvB,KARgB,CAQV,KAAKF,WARK,CAAnB;;IAUA,aAAKyB,WAAL,CAAiBpE,EAAjB,CAAoB,OAApB,EAA6B,YAAW;IAAE,iBAAKwC,WAAL;IAAqB,SAA/D,EAAiE,IAAjE;;IAEA;IACA,aAAKW,UAAL,GAAkB1D,EAAEyD,MAApB;IACH,KArK+B;;IAuKhCV,iBAAa,uBAAW;IACpB;IACA,YAAG,KAAK4B,WAAR,EAAqB;IACjB,iBAAKzB,WAAL,CAAiB0B,WAAjB,CAA6B,KAAKD,WAAlC;IACH;IACD,YAAG,KAAKT,QAAR,EAAkB;IACd,iBAAKhB,WAAL,CAAiB0B,WAAjB,CAA6B,KAAKV,QAAlC;IACH;IACD,YAAG,KAAKhB,WAAL,IAAoB,KAAKS,mBAA5B,EAAiD;IAC7C,iBAAKT,WAAL,CAAiB0B,WAAjB,CAA6B,KAAKjB,mBAAlC;IACH;;IAED;IACA,aAAKH,YAAL;IACH,KArL+B;;IAuLhCA,kBAAc,wBAAW;IACrB,aAAKW,SAAL,GAAiB,CAAjB;IACA,aAAKD,QAAL,GAAgBe,SAAhB;IACA,aAAKN,WAAL,GAAmBM,SAAnB;IACA,aAAKvB,UAAL,GAAkBuB,SAAlB;IACA,aAAKR,eAAL,GAAuBQ,SAAvB;IACA,aAAKtB,mBAAL,GAA2BsB,SAA3B;IACH,KA9L+B;;IAgMhCT,oBAAgB,wBAASlI,QAAT,EAAmB;IAC/B,YAAI4I,OAAOC,YAAQ;IACf7D,uBAAW,yBADI;IAEf8D,wBAAY,CAAC,CAAC,CAAF,EAAK,CAAC,CAAN;IAFG,SAAR,CAAX;IAIA,aAAKlB,QAAL,GAAgBmB,WAAO/I,QAAP,EAAiB;IAC7B4I,kBAAMA,IADuB;IAE7BnB,uBAAW;IAFkB,SAAjB,EAGbX,KAHa,CAGP,KAAKF,WAHE,CAAhB;IAIH,KAzM+B;;IA2MhCkB,4BAAwB,gCAAS9H,QAAT,EAAmB;IACvC,aAAK4H,QAAL,CAAcoB,SAAd,CAAwBhJ,QAAxB;IACH,KA7M+B;;IA+MhCiI,4BAAwB,gCAASgB,KAAT,EAAgBC,UAAhB,EAA4B;IAChD,YAAIC,aAAa,KAAKC,MAAL,CAAYH,KAAZ,CAAjB;IAAA,YACII,kBAAkB,KAAKD,MAAL,CAAYF,UAAZ,CADtB;;IAGA,YAAII,OAAO,gDAAgDH,UAAhD,GAA6D,WAAxE;IACA,YAAGE,kBAAkB,CAAlB,IAAuBF,cAAcE,eAAxC,EAAyD;IACrDC,oBAAQ,uDAAuDD,eAAvD,GAAyE,YAAjF;IACH;;IAED,aAAKzB,QAAL,CAAc2B,KAAd,CAAoB/D,SAApB,GAAgC8D,IAAhC;IACH,KAzN+B;;IA2NhCF,YAAQ,gBAASI,GAAT,EAAc;IAClB,eAAOC,KAAKC,KAAL,CAAYF,MAAM,IAAP,GAAe,EAA1B,IAAgC,EAAvC;IACH,KA7N+B;;IA+NhC7C,gBAAY,oBAAUjD,CAAV,EAAa;IACrB,YAAGA,EAAEiG,OAAF,IAAa,EAAhB,EAAoB;IAChB;IACA,gBAAG,CAAC,KAAKvC,UAAT,EAAqB;IACjB,qBAAKlC,cAAL;IACH,aAFD,MAEO;IACH,qBAAKuB,WAAL;IACH;IACJ;IACJ;IAxO+B,CAAf,CAArB;;AA2OA5G,gBAAQ+J,OAAR,GAAkB7E,cAAlB;AACA8E,gBAAQC,OAAR,GAAkB,UAAU/J,OAAV,EAAmB;IACjC,WAAO,IAAIF,YAAQ+J,OAAZ,CAAoB7J,OAApB,CAAP;IACH,CAFD;;AAIA6E,YAAImF,YAAJ,CAAiB;IACbhF,oBAAgB;IADH,CAAjB;;AAIAH,YAAIC,WAAJ,CAAgB,YAAY;IACxB,QAAI,KAAK9E,OAAL,CAAagF,cAAjB,EAAiC;IAC7B,aAAKA,cAAL,GAAsB,IAAIA,cAAJ,EAAtB;IACA,aAAKD,UAAL,CAAgB,KAAKC,cAArB;IACH;IACJ,CALD;;IC3PA,IAAIiF,kBAAkBnK,YAAQC,MAAR,CAAe;IACnCC,WAAS;IACPC,cAAU,YADH;IAEPiK,eAAW,KAFJ;IAGPC,iBAAa,aAHN;IAIPC,cAAU,KAJH;IAKPC,eAAW,CALJ;IAMPC,kBAAc1B,SANP;IAOP2B,kBAAc3B,SAPP;IAQP4B,YAAQ;IARD,GAD0B;;IAYnCzJ,SAAO,eAAUC,GAAV,EAAe;IACpB,SAAKS,UAAL,GAAkBC,YAAQC,MAAR,CAAe,KAAf,EAAsB,+BAAtB,CAAlB;IACAgE,iBAAS8E,uBAAT,CAAiC,KAAKhJ,UAAtC;IACAT,QAAIkD,EAAJ,CAAO,WAAP,EAAoB,KAAKwG,YAAzB,EAAuC,IAAvC;IACA,SAAKjJ,UAAL,CAAgBgE,SAAhB,GAA0B,KAAKzF,OAAL,CAAamK,WAAvC;IACA,WAAO,KAAK1I,UAAZ;IACD,GAlBkC;;IAoBnCO,YAAU,kBAAUhB,GAAV,EAAe;IACvBA,QAAIwD,GAAJ,CAAQ,WAAR,EAAqB,KAAKkG,YAA1B;IACD,GAtBkC;;IAwBnCA,gBAAc,sBAAU/G,CAAV,EAAa;IACzB,QAAIgH,MAAM,KAAK3K,OAAL,CAAasK,YAAb,GAA4B,KAAKtK,OAAL,CAAasK,YAAb,CAA0B3G,EAAEyD,MAAF,CAASuD,GAAnC,CAA5B,GAAsEC,SAAKC,SAAL,CAAelH,EAAEyD,MAAF,CAASuD,GAAxB,EAA6B,KAAK3K,OAAL,CAAaqK,SAA1C,CAAhF;IACA,QAAIS,MAAM,KAAK9K,OAAL,CAAauK,YAAb,GAA4B,KAAKvK,OAAL,CAAauK,YAAb,CAA0B5G,EAAEyD,MAAF,CAAS0D,GAAnC,CAA5B,GAAsEF,SAAKC,SAAL,CAAelH,EAAEyD,MAAF,CAAS0D,GAAxB,EAA6B,KAAK9K,OAAL,CAAaqK,SAA1C,CAAhF;IACA,QAAIU,QAAQ,KAAK/K,OAAL,CAAaoK,QAAb,GAAwBO,MAAM,KAAK3K,OAAL,CAAakK,SAAnB,GAA+BY,GAAvD,GAA6DA,MAAM,KAAK9K,OAAL,CAAakK,SAAnB,GAA+BS,GAAxG;IACA,QAAIK,iBAAiB,KAAKhL,OAAL,CAAawK,MAAb,GAAsB,GAAtB,GAA4BO,KAAjD;IACA,SAAKtJ,UAAL,CAAgBgE,SAAhB,GAA4BuF,cAA5B;IACD;;IA9BkC,CAAf,CAAtB;;AAmCAlL,gBAAQmL,aAAR,GAAyBhB,eAAzB;AACAH,gBAAQoB,aAAR,GAAwB,UAAUlL,OAAV,EAAmB;IACvC,SAAO,IAAIF,YAAQmL,aAAZ,CAA0BjL,OAA1B,CAAP;IACH,CAFD;;AAIA6E,YAAImF,YAAJ,CAAiB;IACbC,mBAAiB;IADJ,CAAjB;;AAIApF,YAAIC,WAAJ,CAAgB,YAAY;IACxB,MAAI,KAAK9E,OAAL,CAAaiK,eAAjB,EAAkC;IAC9B,SAAKA,eAAL,GAAuB,IAAIA,eAAJ,EAAvB;IACA,SAAKlF,UAAL,CAAgB,KAAKkF,eAArB;IACH;IACJ,CALD;;IC5CA,IAAMkB,eAAeC,2BAAkBD,YAAvC;IACA,IAAME,eAAeD,2BAAkBC,YAAvC;IACA,IAAMC,aAAaF,2BAAkBG,gBAArC;IACA,IAAMC,SAASJ,2BAAkBI,MAAjC;;IAEA;;;;AAIA,cAAe;;IAEX;;;;IAIAC,UAAO,cAAS3H,KAAT,EAAgB;IACnB,eAAQA,SACAA,MAAM4H,aADN,IAEA5H,MAAM4H,aAAN,CAAoBnL,MAFpB,IAGA,CAACuD,MAAM4H,aAAN,CAAoBC,OAApB,CAA4B,mDAA5B,CAHT;IAIH,KAXU;;IAaXC,SAAM,aAASC,YAAT,EAAuB;IACzB,YAAIC,QAAQX,eACPY,MADO,CACA,GADA,EAEPL,aAFO,CAEO,mDAFP,CAAZ;IAGA,YAAG,CAACG,YAAJ,EACIA,eAAe,IAAIR,YAAJ,CAAiBG,OAAOQ,MAAxB,EAAgC,IAAIV,UAAJ,EAAhC,CAAf;IACJ,eAAOO,aAAaI,MAAb,CAAoBH,KAApB,EACNI,IADM,CACA;IAAA,mBAAYC,SAASC,OAAT,CAAiB7L,MAAjB,GAA0B4L,SAASC,OAAT,CAAiB,CAAjB,CAA1B,GAAgD,IAA5D;IAAA,SADA,EAENC,KAFM,CAEC;IAAA,mBAAKC,EAAEC,MAAF,CAAS5I,CAAT,CAAL;IAAA,SAFD,CAAP;IAGH;;IAtBU,CAAf;;ICRA,IAAM0H,iBAAeD,2BAAkBC,YAAvC;IACA,IAAMC,eAAaF,2BAAkBG,gBAArC;;IAEA,IAAMiB,qBAAqB,kCAA3B;;IAEA,IAAIC,mBAAmB;;IAEnBb,SAAK,aAASC,YAAT,EAAuB;IACxB,YAAG,CAACA,YAAJ,EAAkB;IACdA,2BAAe,IAAIR,cAAJ,CAAiBD,2BAAkBI,MAAlB,CAAyBQ,MAA1C,EAAkD,IAAIV,YAAJ,EAAlD,CAAf;IACH;IACD,YAAIoB,cAActB,2BAAkBI,MAAlB,CAAyBmB,kBAAzB,IAA+CH,kBAAjE;IACA,eAAOX,aAAaD,GAAb,CAAiBc,WAAjB,EAA8BL,KAA9B,CAAoC;IAAA,mBAAKC,EAAEM,OAAF,CAAWC,IAAIjB,GAAJ,EAAX,CAAL;IAAA,SAApC,CAAP;IACH,KARkB;;IAUnBkB,SAAK,aAAShJ,KAAT,EAAgB;IACjB,YAAIrB,KAAK,IAAT;IACA,YAAGqB,SAASA,MAAMrB,EAAlB,EAAsBA,KAAKqB,MAAMrB,EAAX,CAAtB,KACK,IAAGqB,SAAS,OAAOA,KAAP,KAAkB,QAA9B,EAAwCrB,KAAKqB,KAAL;IAC7C,YAAGrB,EAAH,EAAO;IACH2I,uCAAkBI,MAAlB,CAAyBuB,SAAzB,CAAmC,EAAC,sBAAsBjJ,MAAMrB,EAA7B,EAAnC;IACH;IACJ;IAjBkB,CAAvB;;ICDA,IAAMuK,UAAU,qBAAhB;IACA,IAAMC,WAAW,+BAAjB;IACA,IAAMC,QAAQ,SAARA,KAAQ,CAACC,IAAD,EAAOC,GAAP,EAAe;IACzB,QAAIC,IAAIF,KAAKG,IAAL,CAAUF,GAAV,CAAR;IACA,WAAQC,KAAKA,EAAE9M,MAAR,GAAkB8M,EAAE,CAAF,CAAlB,GAAyB,IAAhC;IACH,CAHD;;IAKA,IAAIE,QAAQ;;IAERC,yBAAqB;IACjB,cAAK,kCADY;IAEjB,eAAM,mDAFW;IAGjB,gBAAO,cAHU;IAIjB,uBAAc,qCAJG;IAKjB,iBAAQ;IALS,KAFb;;IAURC,uBAAmB;IACf,cAAK,kCADU;IAEf,eAAM,iDAFS;IAGf,gBAAO,cAHQ;IAIf,uBAAc,mCAJC;IAKf,iBAAQ;IALO,KAVX;;IAkBRC,qBAAiB;IACb,cAAK,kCADQ;IAEb,eAAM,+CAFO;IAGb,gBAAO,cAHM;IAIb,uBAAc,iCAJD;IAKb,iBAAQ;IALK,KAlBT;;IA0BRC,sBAAkB;IACd,cAAM,kCADQ;IAEd,eAAO,gDAFO;IAGd,gBAAQ,cAHM;IAId,uBAAe,kCAJD;IAKd,iBAAS;IALK,KA1BV;;IAkCRC,SAAK;IACD,cAAK,kCADJ;IAED,eAAM,6BAFL;IAGD,gBAAO,cAHN;IAID,uBAAc,mCAJb;IAKD,iBAAQ;IALP,KAlCG;;IA0CRC,SAAK;IACD,cAAK,kCADJ;IAED,eAAM,6BAFL;IAGD,gBAAO,cAHN;IAID,uBAAc,+BAJb;IAKD,iBAAQ;IALP,KA1CG;;IAkDRC,SAAK;IACD,cAAK,kCADJ;IAED,eAAM,6BAFL;IAGD,gBAAO,cAHN;IAID,uBAAc,gCAJb;IAKD,iBAAQ;IALP,KAlDG;;IA0DRC,SAAK;IACD,cAAK,kCADJ;IAED,eAAM,6BAFL;IAGD,gBAAO,cAHN;IAID,uBAAc,+BAJb;IAKD,iBAAQ;IALP,KA1DG;;IAkERC,SAAK;IACD,cAAK,kCADJ;IAED,eAAM,6BAFL;IAGD,gBAAO,cAHN;IAID,uBAAc,2BAJb;IAKD,iBAAQ;IALP,KAlEG;;IA0ERC,UAAM;IACF,cAAK,kCADH;IAEF,eAAM,8BAFJ;IAGF,gBAAO,cAHL;IAIF,uBAAc,iCAJZ;IAKF,iBAAQ;IALN,KA1EE;;IAkFRC,UAAM;IACF,cAAM,kCADJ;IAEF,eAAO,2CAFL;IAGF,gBAAQ,cAHN;IAIF,uBAAe,sEAJb;IAKF,iBAAS;IALP,KAlFE;;IA0FRC,UAAM;IACF,cAAM,kCADJ;IAEF,eAAO,sCAFL;IAGF,gBAAQ,cAHN;IAIF,uBAAe,6GAJb;IAKF,iBAAS;IALP,KA1FE;;IAkGR;IACA;IACAC,aAASC;IApGD,CAAZ;;IAuGA,SAASA,UAAT,CAAoBC,OAApB,EAA6B;;IAEzB,QAAIC,MAAM/C,yBAAOQ,MAAjB;IACA,QAAG,CAACuC,GAAJ,EAAS;IACLrN,gBAAQsN,GAAR,CAAY,uFAAZ;IACH,KAFD,MAEO;;IAEH,YAAI1C,QAAQX,iCACPoC,KADO,CACD,cADC,EAEP7B,aAFO,CAEO,aAFP,EAGP+C,QAHO,CAGE,EAHF,CAAZ;;IAMA,YAAIC,MAAM,IAAV;IACA;IACA,YAAGJ,WAAW,OAAOA,QAAQrC,MAAf,KAA2B,WAAzC,EAAsD;IAClDyC,kBAAMJ,OAAN;IACH,SAFD,MAEO;IAAE;IACLI,kBAAM,IAAIC,6BAAJ,CAAgBJ,GAAhB,EAAqB,IAAIhD,kCAAJ,EAArB,CAAN;IACH;;IAEDmD,YAAIzC,MAAJ,CAAWH,KAAX,EAAkBI,IAAlB,CAAwB,gBAAQ;;IAE5B,iBAAI,IAAI0C,IAAE,CAAV,EAAaA,IAAEC,KAAKzC,OAAL,CAAa7L,MAA5B,EAAoC,EAAEqO,CAAtC,EAAyC;;IAErC,oBAAIE,OAAOD,KAAKzC,OAAL,CAAawC,CAAb,CAAX;IAAA,oBACI3L,MAAM,IADV;IAAA,oBAEI8L,QAAQD,KAAKC,KAFjB;;IAIA,oBAAG,CAACA,MAAMpD,OAAN,CAAc,OAAd,CAAJ,EAA4B;IACxB1I,0BAAM,MAAN;IACA6L,yBAAKE,SAAL,GAAiB,IAAjB;IAEH,iBAJD,MAIO,IAAG,CAACD,MAAMpD,OAAN,CAAc,KAAd,CAAJ,EAA0B;IAC7B1I,0BAAMiK,MAAMF,OAAN,EAAe+B,KAAf,CAAN;IACAD,yBAAKE,SAAL,GAAiB,UAAU/L,GAAV,IAAiB,WAAWA,GAA7C;IAEH,iBAJM,MAIA,IAAG,CAAC8L,MAAMpD,OAAN,CAAc,MAAd,CAAJ,EAA2B;IAC9B1I,0BAAMiK,MAAMD,QAAN,EAAgB8B,KAAhB,CAAN;IACAD,yBAAKE,SAAL,GAAiB,IAAjB;IACA/L,0BAAM,UAAUA,IAAIgM,WAAJ,EAAV,GAA8B,SAApC;IAEH,iBALM,MAKA,IAAG,CAACF,MAAMpD,OAAN,CAAc,MAAd,CAAJ,EAA2B;IAC9B1I,0BAAM,MAAN;IACA6L,yBAAKE,SAAL,GAAiB,IAAjB;IAEH,iBAJM,MAIA;IACH/L,0BAAM8L,KAAN;IAEH;;IAEDxB,sBAAMtK,GAAN,IAAa6L,IAAb;IACH;IACD;IACH,SAjCD,EAkCCzC,KAlCD,CAkCQ,iBAAS;IACbnL,oBAAQsN,GAAR,CAAY,4CAA4CrN,MAAM+N,OAA9D;IACH,SApCD;IAqCH;IACJ;;;;IChLD,SAASC,oBAAT,CAA8BC,OAA9B,EAAuC;;IAEnC,QAAIC,QAAQC,OAAOC,IAAP,CAAYH,QAAQI,UAApB,CAAZ;;IAEA,QAAMC,MAAM,SAANA,GAAM,CAASC,IAAT,EAAeC,KAAf,EAAsB;IAC9B,YAAG,CAACD,IAAD,IAAS,CAACA,KAAKE,IAAlB,EAAwB,OAAO,IAAP;IACxB,YAAIC,QAAQH,KAAKE,IAAL,CAAW,gBAAQ;IAC3B,gBAAIE,KAAKC,KAAKC,WAAL,EAAT;IACA,mBAAOL,MAAMhE,OAAN,CAAcmE,EAAd,KAAmB,CAA1B;IACH,SAHW,CAAZ;IAIA,eAAOD,KAAP;IACH,KAPD;;IASA,QAAII,YAAYR,IAAIJ,KAAJ,EAAW,CAAC,OAAD,EAAS,MAAT,EAAgB,OAAhB,CAAX,CAAhB;IACA,QAAIhK,QAAQ4K,YAAYb,QAAQI,UAAR,CAAmBS,SAAnB,CAAZ,GAA4C,UAAxD;;IAEA,QAAIC,WAAWT,IAAIJ,KAAJ,EAAW,CAAC,aAAD,EAAgB,SAAhB,EAA2B,UAA3B,CAAX,CAAf;IACA,QAAIc,cAAcD,WAAWd,QAAQI,UAAR,CAAmBU,QAAnB,CAAX,GAA0C,yBAA5D;;IAEA,QAAIE,SAAS,gCACT,MADS,GACA/K,KADA,GACQ,OADR,GAET,KAFS,GAED8K,WAFC,GAEa,MAF1B;;IAIA,QAAGf,QAAQI,UAAR,CAAmBa,QAAtB,EAAgC;IAC5B,YAAIA,WAAW,IAAIC,IAAJ,CAASlB,QAAQI,UAAR,CAAmBa,QAA5B,CAAf;IACAD,kBAAU,gEACNC,SAASE,YAAT,EADM,GACoB,eAD9B;IAEH;;IAED,QAAGnB,QAAQI,UAAR,CAAmB,eAAnB,CAAH,EAAwC;IACpC,YAAIgB,OAAO,IAAIF,IAAJ,CAASlB,QAAQI,UAAR,CAAmB,eAAnB,CAAT,CAAX;IACAY,kBAAU,UACN,sCADM,GAEN,sBAFM,GAGNI,KAAKD,YAAL,EAHM,GAGgB,GAHhB,GAGsBC,KAAKC,YAAL,EAHtB,GAIN,SAJM,GAKN,QALJ;IAMH;IACD,QAAGrB,QAAQI,UAAR,CAAmB,aAAnB,CAAH,EAAsC;IAClC,YAAIgB,QAAO,IAAIF,IAAJ,CAASlB,QAAQI,UAAR,CAAmB,aAAnB,CAAT,CAAX;IACAY,kBAAU,UACN,oCADM,GAEN,sBAFM,GAGNI,MAAKD,YAAL,EAHM,GAGgB,GAHhB,GAGsBC,MAAKC,YAAL,EAHtB,GAIN,SAJM,GAKN,QALJ;IAMH;;IAED,QAAIC,WAAWjB,IAAIJ,KAAJ,EAAW,CAAC,aAAD,EAAe,MAAf,EAAsB,SAAtB,CAAX,CAAf;IACA,QAAGqB,QAAH,EAAa;IACTN,kBAAU,MAAV;IACAA,kBAAU,cAAchB,QAAQI,UAAR,CAAmBkB,QAAnB,CAAd,GAA6C,4BAAvD;IACH;;IAEDN,cAAU,MAAV;;IAEA,SAAI,IAAIO,IAAR,IAAgBvB,QAAQI,UAAxB,EAAoC;IAChC,YAAGS,cAAcU,IAAd,IAAsBT,aAAaS,IAAnC,IACCD,aAAaC,IADd,IACsB,eAAeA,IADxC,EAEI;IACJ,YAAI5F,QAAQqE,QAAQI,UAAR,CAAmBmB,IAAnB,CAAZ;IACA,YAAG,QAAO5F,KAAP,yCAAOA,KAAP,OAAkB,QAArB,EAA+B;IAC3B,iBAAI,IAAI6F,CAAR,IAAa7F,KAAb,EAAoB;IAChBqF,0BAAU,UACN,sBADM,GACmBO,IADnB,GAC0B,GAD1B,GACgCC,CADhC,GACoC,SADpC,GAEN,sBAFM,GAEmB7F,MAAM6F,CAAN,CAFnB,GAE8B,SAF9B,GAGN,QAHJ;IAIH;IACJ,SAPD,MAOO;IACHR,sBAAU,UACN,sBADM,GACmBO,IADnB,GAC0B,SAD1B,GAEN,sBAFM,GAEmB5F,KAFnB,GAE2B,SAF3B,GAGN,QAHJ;IAIH;IACJ;IACDqF,cAAU,QAAV;IACA,WAAOA,MAAP;IACH;;IChED;;;;;;IAMA,IAAIS,eAAeC,iBAAA,CAAkB/Q,MAAlB,CAAyB;;IAExCgR,cAAW,EAAEvJ,OAAO,MAAT,EAAiBC,QAAQ,CAAzB,EAA4BuJ,WAAW,MAAvC,EAA+CrI,aAAa,GAA5D,EAF6B;;IAIxC;;;;;IAKAsI,oBAAgB,wBAAU7B,OAAV,EAAmBhI,MAAnB,EAA2B;;IAEvC;;IAEA,YAAIlB,QAAQkJ,WAAWA,QAAQI,UAAnB,GAAgCJ,QAAQI,UAAR,CAAmBtJ,KAAnD,GAA2D,IAAvE;IACA,YAAG,CAACA,KAAD,IAAU,OAAO,KAAKlG,OAAL,CAAakG,KAApB,KAA8B,UAA3C,EAAuD;IACnD;IACA,gBAAI;IACAA,wBAAQ,KAAKlG,OAAL,CAAakG,KAAb,CAAmBkJ,OAAnB,CAAR;IACH,aAFD,CAEE,OAAMzL,CAAN,EAAS;IACPzC,wBAAQsN,GAAR,CAAY,0DAA0D7K,EAAEuL,OAAxE;IACH;IACJ;;IAEDhJ,gBAAQA,SAAS,KAAKlG,OAAL,CAAakG,KAAtB,IAA+B,EAAvC;;IAEA,YAAI8C,SAAS,IAAb;IACA,YAAG9C,MAAMgL,KAAN,KAAgB,OAAnB,EAA4B;IACxB,gBAAI1Q,QAAQ0F,MAAM1F,KAAN,IAAe,EAA3B;IACA,gBAAI2Q,SAASjL,MAAMiL,MAAN,IAAgB,EAA7B;IACA,gBAAItI,OAAOuI,SAAQ;IACfC,yBAASnL,MAAMoL,OADA;IAEfC,0BAAU,CAAC/Q,KAAD,EAAQ2Q,MAAR,CAFK;IAGfpI,4BAAY,CAACvI,QAAM,GAAP,EAAY2Q,SAAO,GAAnB,CAHG;IAIfK,6BAAa,CAAC,CAAD,EAAI,CAAC,EAAL;IAJE,aAAR,CAAX;IAMA,gBAAIC,QAAQ,EAAE5I,MAAMA,IAAR,EAAZ;IACA,gBAAG2C,yBAAOkG,WAAV,EAAuBD,MAAME,IAAN,GAAanG,yBAAOkG,WAApB;IACvB1I,qBAAS4I,WAAUxK,MAAV,EAAkBqK,KAAlB,CAAT;IAEH,SAbD,MAaO;IACHvL,kBAAMzF,MAAN,GAAeyF,MAAMzF,MAAN,IAAgByF,MAAM,cAAN,CAAhB,IAAyC,CAAxD;IACAA,kBAAMuB,MAAN,GAAevB,MAAMuB,MAAN,IAAgBvB,MAAM,cAAN,CAAhB,IAAyC,CAAxD;IACAA,kBAAMsB,KAAN,GAActB,MAAMsB,KAAN,IAAetB,MAAM2L,MAArB,IAA+B,MAA7C;IACA3L,kBAAMuC,OAAN,GAAgBvC,MAAMuC,OAAN,IAAiBvC,MAAM,gBAAN,CAAjB,IAA4C,GAA5D;IACAA,kBAAMyC,WAAN,GAAoBzC,MAAMuC,OAAN,IAAiBvC,MAAM,cAAN,CAAjB,IAA0C,GAA9D;IACAA,kBAAM8K,SAAN,GAAkB9K,MAAMsB,KAAN,IAAetB,MAAMwC,IAAvC;IACAxC,kBAAM4L,QAAN,GAAiB,KAAK9R,OAAL,CAAa8R,QAA9B,CAPG;IAQH9I,qBAAS+I,iBAAe3K,MAAf,EAAuBlB,KAAvB,CAAT;IACH;;IAED,YAAI8L,gBAAgB,KAAKhS,OAAL,CAAagS,aAAb,IAA8B7C,oBAAlD;IACAnG,eAAOiJ,SAAP,CAAiBD,cAAc5C,OAAd,CAAjB;IACA,eAAOpG,MAAP;IACH,KArDuC;;IAuDxC;;;;;IAKAkJ,mBAAe,uBAAS9C,OAAT,EAAkBtL,KAAlB,EAAyB;IACpC,YAAG,CAACsL,OAAD,IAAY,CAACA,QAAQ+C,QAArB,IAAiC/C,QAAQ+C,QAAR,CAAiBrD,IAAjB,KAA0B,OAA9D,EAAuE;IACnE;IACH;IACDhL,cAAMmO,SAAN,CAAgB9C,qBAAqBC,OAArB,CAAhB;IACH,KAjEuC;;IAqExCxO,gBAAY,oBAAUZ,OAAV,EAAmB;IAAA;IAG3BA,kBAAUA,WAAW,EAArB;;IAEA,YAAGwL,yBAAOkG,WAAV,EACI1R,QAAQ2R,IAAR,GAAenG,yBAAOkG,WAAtB;;IAEJ,YAAIU,aAAa,SAAbA,UAAa,GAAM;IAAE,mBAAO,MAAKrB,QAAZ;IAAuB,SAAhD;IACA/Q,gBAAQkG,KAAR,GAAgBlG,QAAQkG,KAAR,IAAiBkM,YAAjC;;IAEA;IACA;IACA,YAAIC,UAAU,EAAd;IACA,YAAG7G,yBAAOkG,WAAV,EACIW,QAAQV,IAAR,GAAenG,yBAAOkG,WAAtB;IACJ,YAAII,WAAYQ,WAAOC,QAAIF,OAAJ,CAAR,IAA0BG,cAAUC,YAAnD;IACAzS,gBAAQ8R,QAAR,GAAmBA,QAAnB;;IAEA9R,gBAAQ0S,YAAR,GAAuBC,SAAK,KAAK1B,cAAV,EAA0B,IAA1B,CAAvB;IACAjR,gBAAQ4S,aAAR,GAAwBD,SAAK,KAAKT,aAAV,EAAyB,IAAzB,CAAxB;;IAEA;;IAEArB,qBAAavO,SAAb,CAAuB1B,UAAvB,CAAkC2B,IAAlC,CAAuC,IAAvC,EAA6CvC,OAA7C;;IAEA,aAAKkE,EAAL,CAAQ,MAAR,EAAgB,YAAW;IACvB,gBAAG,OAAO,KAAKlE,OAAL,CAAa6S,MAApB,KAA+B,WAAlC,EACI,KAAKC,SAAL,CAAe,KAAK9S,OAAL,CAAa6S,MAA5B;IACP,SAHD;IAKH,KApGuC;;IAsGxCC,eAAY,mBAAUC,KAAV,EAAiB;IACzB,aAAK/S,OAAL,CAAa6S,MAAb,GAAsBE,KAAtB;IACA,aAAI,IAAItQ,EAAR,IAAc,KAAKuQ,OAAnB;IACI,iBAAKA,OAAL,CAAavQ,EAAb,EAAiBqQ,SAAjB,CAA2BC,KAA3B;IADJ;IAEH,KA1GuC;;IA4GxCE,sBAAkB,4BAAW;IACzB,aAAI,IAAIxQ,EAAR,IAAc,KAAKuQ,OAAnB,EAA4B;IACxB,gBAAIlP,QAAQ,KAAKkP,OAAL,CAAavQ,EAAb,CAAZ;IACA,gBAAGqB,MAAMmP,gBAAT,EACI,KAAKD,OAAL,CAAavQ,EAAb,EAAiBwQ,gBAAjB;IACP;IACJ,KAlHuC;;IAoHxCC,gBAAY,oBAASzK,OAAT,EAAkB;IAC1B,aAAI,IAAIhG,EAAR,IAAc,KAAKuQ,OAAnB,EAA4B;IACxB,gBAAIlP,QAAQ,KAAKkP,OAAL,CAAavQ,EAAb,CAAZ;IACA,gBAAGqB,MAAMoP,UAAT,EACIpP,MAAMoP,UAAN,CAAiBzK,OAAjB;IACP;IACJ,KA1HuC;;IA4HxC0K,eAAW,mBAASC,SAAT,EAAoB;IAAA;;IAG3B,YAAG,KAAKpT,OAAL,CAAaqT,WAAhB,EAA6B;IACzB,iBAAKrT,OAAL,CAAaqT,WAAb,CAAyBD,SAAzB,EACClH,IADD,CACO,gBAAQ;;IAEX,oBAAG,CAACoH,IAAJ,EAAU;;IAEV,oBAAIpN,QAAQ,IAAZ;;IAEA,oBAAGoN,QAAQA,KAAKC,MAAhB,EAAwB;;IAEpB,wBAAIC,UAAU5I,SAAK+H,IAAL,CAAU,UAASvD,OAAT,EAAkB;;IAEtC,4BAAIqE,WAAW,KAAKA,QAAL,IAAiB,KAAKC,MAArC;IACA,4BAAIC,IAAIvE,QAAQqE,QAAR,MAAsBrE,QAAQI,UAAR,GAAqBJ,QAAQI,UAAR,CAAmBiE,QAAnB,CAArB,GAAoD,IAA1E,CAAR;IACA,4BAAIvN,QAAQ,IAAZ;IACA,4BAAG,KAAKqN,MAAR,EAAgB;IACZ,gCAAIK,UAAU,KAAKL,MAAL,CAAY3D,IAAZ,CAAkB;IAAA,uCAAMiE,GAAG9I,KAAH,KAAa4I,CAAnB;IAAA,6BAAlB,CAAd;IACA,gCAAGC,OAAH,EAAY;IACR1N,wCAAQ0N,QAAQ1N,KAAhB;IACAA,sCAAMzF,MAAN,GAAeyF,MAAMzF,MAAN,IAAgByF,MAAM,cAAN,CAAhB,IAAyC,CAAxD;IACAA,sCAAMuB,MAAN,GAAevB,MAAMuB,MAAN,IAAgBvB,MAAM,cAAN,CAAhB,IAAyC,CAAxD;IACAA,sCAAMsB,KAAN,GAActB,MAAMsB,KAAN,IAAiBtB,MAAM2L,MAAvB,IAAiC,MAA/C;IACA3L,sCAAMuC,OAAN,GAAgBvC,MAAMuC,OAAN,IAAiBvC,MAAM,gBAAN,CAAjB,IAA4C,GAA5D;IACAA,sCAAMyC,WAAN,GAAoBzC,MAAMuC,OAAN,IAAiBvC,MAAM,cAAN,CAAjB,IAA0C,GAA9D;IACAA,sCAAM8K,SAAN,GAAkB9K,MAAMsB,KAAN,IAAetB,MAAMwC,IAAvC;IACH;IACJ;IACD;IACA,+BAAOxC,KAAP;IACH,qBAnBa,EAmBXoN,IAnBW,CAAd;IAoBA,2BAAKtT,OAAL,CAAakG,KAAb,GAAqBsN,OAArB;IACA,2BAAKM,QAAL,CAAcN,OAAd;IACA;IAEH,iBA1BD,MA0BO,IAAGF,QAAQ,OAAOA,KAAKS,IAAZ,KAAsB,WAAjC,EAA8C;IACjD;IACA7N,4BAAQoN,KAAK,CAAL,CAAR,CAFiD;IAIpD,iBAJM,MAIA,IAAGA,IAAH,EAAS;IACZpN,4BAAQoN,IAAR;IAEH,iBAHM,MAGA;IACH,2BADG;IAEN;;IAED,oBAAGpN,MAAMgL,KAAT,EAAgB;IACZ,wBAAI8C,MAAMC,OAAOlU,MAAP,CAAc,EAAd,EAAkBmG,KAAlB,CAAV;IACA8N,wBAAI9N,KAAJ,GAAYA,KAAZ;IACA,2BAAK6K,QAAL,GAAgB7K,KAAhB;;IAEA;IACA;IACA;IACA;IACA,yBAAI,IAAIzD,EAAR,IAAc,OAAKuQ,OAAnB;IACI,+BAAKA,OAAL,CAAavQ,EAAb,EAAiBqR,QAAjB,CAA0BE,GAA1B;IADJ;IAGH;IACJ,aAzDD,EA0DC3H,KA1DD,CA0DQ,aAAK;IACTnL,wBAAQsN,GAAR,CAAY,oCAAZ;IACAtN,wBAAQsN,GAAR,CAAY7K,CAAZ;IACH,aA7DD;IA8DH;IACJ;;IA/LuC,CAAzB,CAAnB;;ICTA,IAAIkN,iBAAeC,mBAAA,CAAoB/Q,MAApB,CAA2B;;IAE5CmU,WAAS;IACPC,YAAQ,8EADD;IAEPC,mBAAe;IAFR,GAFmC;;IAO5C;;;;IAIAxT,cAAY,oBAAUZ,OAAV,EAAmB;IAC7B8Q,uBAAA,CAAoBxO,SAApB,CAA8B1B,UAA9B,CAAyC2B,IAAzC,CAA8C,IAA9C,EAAoDvC,OAApD;;IAEAA,cAAUa,eAAW,IAAX,EAAiBb,OAAjB,CAAV;;IAEA,SAAKgT,OAAL,GAAe,EAAf;IACA,SAAKqB,WAAL,GAAmB,EAAnB;;IAEA,SAAKC,OAAL,GAAe,IAAIC,EAAEC,kBAAN,CAAyBxU,OAAzB,CAAf;IACA,SAAKyU,IAAL,GAAY,MAAM,CAAC/K,KAAKgL,MAAL,KAAgB,GAAjB,EAAsBC,QAAtB,CAA+B,EAA/B,EAAmCC,OAAnC,CAA2C,GAA3C,EAAgD,GAAhD,CAAlB;;IAEA,SAAKN,OAAL,CAAaO,cAAb,CAA4B,IAA5B;IACD,GAvB2C;;IAyB5C;;;;IAIA9T,SAAO,eAAUC,GAAV,EAAe;IACpB8P,uBAAA,CAAoBxO,SAApB,CAA8BvB,KAA9B,CAAoCwB,IAApC,CAAyC,IAAzC,EAA+CvB,GAA/C;IACA,SAAKqB,IAAL,CAAUyS,QAAV,CAAmB,KAAKR,OAAxB;;IAEA;IACA;IACA;IACD,GApC2C;;IAsC5CtS,YAAU,kBAAUhB,GAAV,EAAe;IACvB8P,uBAAA,CAAoBxO,SAApB,CAA8BN,QAA9B,CAAuCO,IAAvC,CAA4C,IAA5C,EAAkDvB,GAAlD;IACA,SAAKqB,IAAL,CAAUkG,WAAV,CAAsB,KAAK+L,OAA3B;IACD,GAzC2C;;IA2C5C;;;;IAIAS,gBAAc,sBAAUC,QAAV,EAAoB;IAChC,QAAIC,UAAU,EAAd;;IAEA,SAAK,IAAIrG,IAAIoG,SAASzU,MAAT,GAAkB,CAA/B,EAAkCqO,KAAK,CAAvC,EAA0CA,GAA1C,EAA+C;IAC7C,UAAIsG,UAAUF,SAASpG,CAAT,CAAd;IACA,UAAI9K,QAAQ,KAAKkP,OAAL,CAAakC,QAAQzS,EAArB,CAAZ;;IAEA,UAAI,CAACqB,KAAL,EAAY;IACV,YAAIqR,WAAWC,YAAQC,eAAR,CAAwBH,OAAxB,EAAiC,KAAKlV,OAAtC,CAAf;IACAmV,iBAAS/F,OAAT,GAAmBgG,YAAQE,SAAR,CAAkBJ,OAAlB,CAAnB;IACAC,iBAASI,cAAT,GAA0BJ,SAASnV,OAAnC;IACAmV,iBAASpR,WAAT,GAAuB,KAAK0Q,IAAL,GAAY,GAAZ,GAAkBS,QAAQzS,EAAjD;;IAEA,aAAK+S,UAAL,CAAgBL,SAAS/F,OAAT,CAAiB3M,EAAjC;;IAEA;IACA,aAAKuQ,OAAL,CAAamC,SAAS/F,OAAT,CAAiB3M,EAA9B,IAAoC0S,QAApC;;IAEA,aAAKd,WAAL,CAAiBc,SAASpR,WAA1B,IAAyCmR,QAAQzS,EAAjD;;IAEA,YAAI,KAAKzC,OAAL,CAAa4S,aAAjB,EAAgC;IAC9B,eAAK5S,OAAL,CAAa4S,aAAb,CAA2BuC,SAAS/F,OAApC,EAA6C+F,QAA7C;IACD;;IAED,aAAKM,IAAL,CAAU,eAAV,EAA2B;IACzBrG,mBAAS+F,SAAS/F;IADO,SAA3B;;IAIA;IACA,YAAI,CAAC,KAAKpP,OAAL,CAAa0V,SAAd,IAA4B,KAAK1V,OAAL,CAAa0V,SAAb,IAA0B,KAAKC,uBAAL,CAA6BT,OAA7B,CAA1D,EAAkG;IAChGD,kBAAQlB,IAAR,CAAaoB,QAAb;IACD;IACF;IACF;;IAED,QAAIF,QAAQ1U,MAAZ,EAAoB;IAClB,WAAK+T,OAAL,CAAasB,SAAb,CAAuBX,OAAvB;IACD;IACF,GArF2C;;IAuF5CW,aAAW,mBAAUC,GAAV,EAAe;IACxB,QAAIC,cAAc,EAAlB;IACA,SAAK,IAAIlH,IAAIiH,IAAItV,MAAJ,GAAa,CAA1B,EAA6BqO,KAAK,CAAlC,EAAqCA,GAArC,EAA0C;IACxC,UAAI9K,QAAQ,KAAKkP,OAAL,CAAa6C,IAAIjH,CAAJ,CAAb,CAAZ;IACA,WAAK6G,IAAL,CAAU,YAAV,EAAwB;IACtBrG,iBAAStL,MAAMsL;IADO,OAAxB;IAGA0G,kBAAY/B,IAAZ,CAAiBjQ,KAAjB;IACD;IACD,SAAKwQ,OAAL,CAAasB,SAAb,CAAuBE,WAAvB;IACD,GAjG2C;;IAmG5CC,gBAAc,sBAAUF,GAAV,EAAeG,SAAf,EAA0B;IACtC,QAAIC,iBAAiB,EAArB;IACA,SAAK,IAAIrH,IAAIiH,IAAItV,MAAJ,GAAa,CAA1B,EAA6BqO,KAAK,CAAlC,EAAqCA,GAArC,EAA0C;IACxC,UAAInM,KAAKoT,IAAIjH,CAAJ,CAAT;IACA,UAAI9K,QAAQ,KAAKkP,OAAL,CAAavQ,EAAb,CAAZ;IACA,WAAKgT,IAAL,CAAU,eAAV,EAA2B;IACzBrG,iBAAStL,MAAMsL,OADU;IAEzB4G,mBAAWA;IAFc,OAA3B;IAIAC,qBAAelC,IAAf,CAAoBjQ,KAApB;IACA,UAAI,KAAKkP,OAAL,CAAavQ,EAAb,KAAoBuT,SAAxB,EAAmC;IACjC,eAAO,KAAKhD,OAAL,CAAavQ,EAAb,CAAP;IACD;IACF;IACD,SAAK6R,OAAL,CAAayB,YAAb,CAA0BE,cAA1B;IACD,GAlH2C;;IAoH5C;;;;IAIAT,cAAY,oBAAU/S,EAAV,EAAc;IACxB,QAAIqB,QAAQ,KAAKkP,OAAL,CAAavQ,EAAb,CAAZ;;IAEA,QAAIqB,KAAJ,EAAW;IACTA,YAAM9D,OAAN,GAAgB8D,MAAMyR,cAAtB;IACA,WAAKW,eAAL,CAAqBpS,MAAMsL,OAAN,CAAc3M,EAAnC,EAAuC,KAAKzC,OAAL,CAAakG,KAApD;IACD;;IAED,WAAO,IAAP;IACD,GAjI2C;;IAmI5C4N,YAAU,kBAAU5N,KAAV,EAAiB;IACzB,SAAKiQ,WAAL,CAAiB,UAAUrS,KAAV,EAAiB;IAChC,WAAKoS,eAAL,CAAqBpS,MAAMsL,OAAN,CAAc3M,EAAnC,EAAuCyD,KAAvC;IACD,KAFD,EAEG,IAFH;IAGA,WAAO,IAAP;IACD,GAxI2C;;IA0I5CgQ,mBAAiB,yBAAUzT,EAAV,EAAcyD,KAAd,EAAqB;IACpC,QAAIpC,QAAQ,KAAKkP,OAAL,CAAavQ,EAAb,CAAZ;;IAEA,QAAI,OAAOyD,KAAP,KAAiB,UAArB,EAAiC;IAC/BA,cAAQA,MAAMpC,MAAMsL,OAAZ,CAAR;IACD;IACD,QAAItL,MAAMgQ,QAAV,EAAoB;IAClBhQ,YAAMgQ,QAAN,CAAe5N,KAAf;IACD;IACF,GAnJ2C;;IAqJ5C;;;;IAIAiQ,eAAa,qBAAU7Q,EAAV,EAAcC,OAAd,EAAuB;IAClC,SAAK,IAAIqJ,CAAT,IAAc,KAAKoE,OAAnB,EAA4B;IAC1B1N,SAAG/C,IAAH,CAAQgD,OAAR,EAAiB,KAAKyN,OAAL,CAAapE,CAAb,CAAjB;IACD;IACD,WAAO,IAAP;IACD,GA9J2C;;IAgK5CwH,cAAY,oBAAU3T,EAAV,EAAc;IACxB,WAAO,KAAKuQ,OAAL,CAAavQ,EAAb,CAAP;IACD;IAlK2C,CAA3B,CAAnB;;IAqKA,SAAS4T,YAAT,CAAuBrW,OAAvB,EAAgC;IAC9B,SAAO,IAAI6Q,cAAJ,CAAiB7Q,OAAjB,CAAP;IACD;;IC9KD;;;;IAIA,SAASsW,oBAAT,CAA8B7T,EAA9B,EAAkC;IAC9B,QAAI8T,WAAWjK,EAAEkK,KAAF,EAAf;IACA,QAAG,CAACvC,MAAJ,EAAY;IACRsC,iBAAShK,MAAT,CAAgB,IAAIkK,KAAJ,CAAU,6DAAV,CAAhB;IACA,eAAOF,SAASG,OAAhB;IACH;IACDzC,WAAO0C,IAAP,CAAY;IACTpI,aAAK/C,yBAAOQ,MAAP,GAAgB,cAAhB,GAAiCvJ,EAAjC,GAAsC,QADlC;IAETmU,kBAAU,MAFD;IAGTC,iBAAS,iBAAShI,IAAT,EAAe;IACpB0H,qBAAS3J,OAAT,CAAiBiC,IAAjB;IACH,SALQ;IAMT1N,eAAO,eAAS2V,GAAT,EAAcC,MAAd,EAAsB7H,OAAtB,EAA+B;IAClC,gBAAI8H,6FAC4CvU,EAD5C,WACoDyM,OADxD;IAEA,gBAAI/N,QAAQ,IAAIsV,KAAJ,CAAUO,EAAV,CAAZ;IACAT,qBAAShK,MAAT,CAAgBpL,KAAhB;IACH;IAXQ,KAAZ;IAaA,WAAOoV,SAASG,OAAhB;IACH;;ICTD;;;;;;IAMA,IAAIO,wBAAwBC,eAAwBnX,MAAxB,CAA+B;;IAEvDoX,uBAAmB,IAFoC;IAGvDC,oBAAgB,GAHuC;;IAKvDrG,cAAW,EAAEvJ,OAAO,MAAT,EAAiBC,QAAQ,CAAzB,EAA4BuJ,WAAW,MAAvC,EAA+CrI,aAAa,GAA5D,EAL4C;;IAOvD;;;;;IAKAsI,oBAAgB,wBAAU7B,OAAV,EAAmBhI,MAAnB,EAA2B;;IAEvC,YAAIlB,QAAQkJ,WAAWA,QAAQI,UAAnB,GAAgCJ,QAAQI,UAAR,CAAmBtJ,KAAnD,GAA2D,IAAvE;IACA,YAAG,CAACA,KAAD,IAAU,OAAO,KAAKlG,OAAL,CAAakG,KAApB,KAA8B,UAA3C,EAAuD;IACnD;IACA,gBAAI;IACAA,wBAAQ,KAAKlG,OAAL,CAAakG,KAAb,CAAmBkJ,OAAnB,CAAR;IACH,aAFD,CAEE,OAAMzL,CAAN,EAAS;IACPzC,wBAAQsN,GAAR,CAAY,0DAA0D7K,EAAEuL,OAAxE;IACH;IACJ;;IAEDhJ,gBAAQA,SAAS,KAAKlG,OAAL,CAAakG,KAAtB,IAA+B,EAAvC;IACAA,cAAMzF,MAAN,GAAoByF,MAAM,cAAN,KAAyBA,MAAMzF,MAA/B,IAAyC,CAA7D;IACAyF,cAAMuB,MAAN,GAAoBvB,MAAM,cAAN,KAAyBA,MAAMuB,MAA/B,IAAyC,CAA7D;IACAvB,cAAMsB,KAAN,GAAoBtB,MAAM2L,MAAN,IAAgB3L,MAAMsB,KAAtB,IAA+B,MAAnD;IACAtB,cAAMuC,OAAN,GAAoBvC,MAAM,gBAAN,KAA2BA,MAAMuC,OAAjC,IAA4C,GAAhE;IACAvC,cAAMyC,WAAN,GAAoBzC,MAAM,cAAN,KAAyBA,MAAMuC,OAA/B,IAA0C,GAA9D;IACAvC,cAAM8K,SAAN,GAAoB9K,MAAMwC,IAAN,IAAcxC,MAAMsB,KAApB,IAA6B,MAAjD;IACAtB,cAAM4L,QAAN,GAAoB,KAAK9R,OAAL,CAAa8R,QAAjC,CAnBuC;;IAqBvC,YAAI9I,SAAS,IAAb;IACA,YAAG9C,MAAMgL,KAAN,KAAgB,OAAnB,EAA4B;IACxB,gBAAI1Q,QAAQ0F,MAAM1F,KAAN,IAAe,EAA3B;IACA,gBAAI2Q,SAASjL,MAAMiL,MAAN,IAAgB,EAA7B;IACA,gBAAItI,OAAOuI,SAAQ;IACfC,yBAASnL,MAAMoL,OADA;IAEfC,0BAAU,CAAC/Q,KAAD,EAAQ2Q,MAAR,CAFK;IAGfpI,4BAAY,CAACvI,QAAM,GAAP,EAAY2Q,SAAO,GAAnB,CAHG;IAIfK,6BAAa,CAAC,CAAD,EAAI,CAAC,EAAL;IAJE,aAAR,CAAX;IAMA,gBAAIC,QAAQ,EAAE5I,MAAMA,IAAR,EAAZ;IACA,gBAAG2C,yBAAOkG,WAAV,EAAuBD,MAAME,IAAN,GAAanG,yBAAOkG,WAApB;IACvB1I,qBAAS4I,WAAUxK,MAAV,EAAkBqK,KAAlB,CAAT;IACH,SAZD,MAYO;IACHzI,qBAAS+I,iBAAe3K,MAAf,EAAuBlB,KAAvB,CAAT;IACH;;IAED,YAAI8L,gBAAgB,KAAKhS,OAAL,CAAagS,aAAb,IAA8B7C,oBAAlD;IACAnG,eAAOiJ,SAAP,CAAiBD,cAAc5C,OAAd,CAAjB;;IAEA,eAAOpG,MAAP;IACH,KAtDsD;;IAwDvD;;;;;IAKAkJ,mBAAe,uBAAS9C,OAAT,EAAkBtL,KAAlB,EAAyB;IACpC,YAAG,CAACsL,OAAD,IAAY,CAACA,QAAQ+C,QAArB,IAAiC/C,QAAQ+C,QAAR,CAAiBrD,IAAjB,KAA0B,OAA9D,EAAuE;IACnE;IACH;IACDhL,cAAMmO,SAAN,CAAgB9C,qBAAqBC,OAArB,CAAhB;IACH,KAlEsD;;IAsEvDxO,gBAAY,oBAAUZ,OAAV,EAAmB;IAAA;;IAI3BA,kBAAUA,WAAW,EAArB;;IAEA,YAAGwL,yBAAOkG,WAAV,EACI1R,QAAQ2R,IAAR,GAAenG,yBAAOkG,WAAtB;;IAEJ1R,gBAAQ0S,YAAR,GAAuBC,SAAK,KAAK1B,cAAV,EAA0B,IAA1B,CAAvB;IACAjR,gBAAQ4S,aAAR,GAAwBD,SAAK,KAAKT,aAAV,EAAyB,IAAzB,CAAxB;IACA;;IAEA;IACA;IACA;IACAlS,gBAAQqX,0BAAR,GAAqC,CAArC;;IAEA,YAAIjF,aAAa,SAAbA,UAAa,GAAM;IAAE,mBAAO,MAAKrB,QAAZ;IAAuB,SAAhD;IACA/Q,gBAAQkG,KAAR,GAAgBlG,QAAQkG,KAAR,IAAiBkM,UAAjC;IACA,YAAGpS,QAAQsX,aAAX,EAA0B;IACtB,iBAAKA,aAAL,GAAqBtX,QAAQsX,aAA7B;IACH;;IAED;IACA;IACA,YAAIjF,UAAU,EAAd;IACA,YAAG7G,yBAAOkG,WAAV,EACIW,QAAQV,IAAR,GAAenG,yBAAOkG,WAAtB;IACJ,YAAII,WAAYQ,WAAOC,QAAIF,OAAJ,CAAR,IAA0BG,cAAUC,YAAnD;IACAzS,gBAAQ8R,QAAR,GAAmBA,QAAnB;;IAEAoF,uBAAwB5U,SAAxB,CAAkC1B,UAAlC,CAA6C2B,IAA7C,CAAkD,IAAlD,EAAwDvC,OAAxD;;IAEA,aAAKkE,EAAL,CAAQ,MAAR,EAAgB,YAAW;IACvB,gBAAG,OAAO,KAAKlE,OAAL,CAAa6S,MAApB,KAA+B,WAAlC,EACI,KAAKC,SAAL,CAAe,KAAK9S,OAAL,CAAa6S,MAA5B;IACP,SAHD;IAKH,KA7GsD;;IA+GvD9R,WAAO,eAASC,GAAT,EAAc;IACjBkW,uBAAwB5U,SAAxB,CAAkCvB,KAAlC,CAAwCwB,IAAxC,CAA6C,IAA7C,EAAmDvB,GAAnD;;IAEA,YAAG,KAAKhB,OAAL,CAAauX,OAAhB,EAAyB;IACrB,iBAAKpE,SAAL,CAAe,KAAKnT,OAAL,CAAauX,OAA5B;IACH;IACJ,KArHsD;;IAuHvD;IACAxC,kBAAc,sBAAUC,QAAV,EAAoB;IAC9BkC,uBAAwB5U,SAAxB,CAAkCyS,YAAlC,CAA+CxS,IAA/C,CAAoD,IAApD,EAA0DyS,QAA1D;IACA,aAAKwC,aAAL,CAAmB,KAAKL,iBAAxB;IACA,aAAKjE,UAAL,CAAgB,KAAKkE,cAArB;IACH,KA5HsD;;IA8HvD;;;IAGAtE,eAAY,mBAAUC,KAAV,EAAiB;IACzB,aAAK/S,OAAL,CAAa6S,MAAb,GAAsBE,KAAtB;IACA,aAAI,IAAItQ,EAAR,IAAc,KAAKuQ,OAAnB,EAA4B;;IAExB,gBAAIyE,MAAM,KAAKzE,OAAL,CAAavQ,EAAb,CAAV;IACA,gBAAGgV,IAAI3E,SAAP,EACI2E,IAAI3E,SAAJ,CAAcC,KAAd,EADJ,KAEK,IAAG0E,IAAIC,aAAP,EACDD,IAAIC,aAAJ,CAAkB3E,KAAlB,EADC,KAEA,IAAG0E,IAAIE,SAAJ,IAAiBF,IAAIE,SAAJ,CAAclW,UAAlC,EAA6C;IAC9CgW,oBAAIE,SAAJ,CAAclW,UAAd,CAAyByE,KAAzB,CAA+B2M,MAA/B,GAAwCE,KAAxC;IACH,aAFI,MAEE;IACH;IACH;IACJ;IACJ,KAhJsD;;IAkJvD;IACAE,sBAAkB,4BAAW;;IAEzB,aAAKkE,iBAAL,GAAyB,CAAC,KAAKA,iBAA/B;IACA,aAAKK,aAAL,CAAmB,KAAKL,iBAAxB;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACH,KAvKsD;;IAyKvD;;;IAGAK,mBAAe,uBAASI,IAAT,EAAe;;IAE1B,aAAKT,iBAAL,GAAyB,CAAC,CAACS,IAA3B;;IAEA;IACA,YAAG,KAAKtD,OAAL,IAAgB,KAAKA,OAAL,CAAauD,aAA7B,IAA8C,KAAKvD,OAAL,CAAauD,aAAb,CAA2B7E,OAA5E,EAAqF;IACjF,iBAAI,IAAIvQ,EAAR,IAAc,KAAK6R,OAAL,CAAauD,aAAb,CAA2B7E,OAAzC,EAAkD;IAC9C,oBAAIlP,QAAQ,KAAKwQ,OAAL,CAAauD,aAAb,CAA2B7E,OAA3B,CAAmCvQ,EAAnC,CAAZ;IACA,oBAAGqB,MAAM0F,KAAT,EAAgB;IACZ;IACA;IACA;IACA;IACA,wBAAIX,OAAOoL,OAAOnQ,MAAM0F,KAAb,CAAX;IACA,wBAAGoO,IAAH,EAAS/O,KAAKxF,WAAL,CAAiB,WAAjB,EAAT,KACKwF,KAAK1F,QAAL,CAAc,WAAd;IACR;IACJ;IACJ;;IAED;IACA,YAAG,KAAK6P,OAAR,EAAiB;IACb,iBAAI,IAAIvQ,GAAR,IAAc,KAAKuQ,OAAnB,EAA4B;IACxB,oBAAIlP,SAAQ,KAAKkP,OAAL,CAAavQ,GAAb,CAAZ;IACA,oBAAGqB,OAAM0T,aAAT,EACI1T,OAAM0T,aAAN,CAAoBI,IAApB,EADJ,KAEK,IAAG9T,OAAMgQ,QAAT,EACDhQ,OAAMgQ,QAAN,CAAe,EAACgE,SAASF,OAAO,EAAP,GAAU,MAApB,EAAf;IACP;IACJ;IACJ,KA1MsD;;IA4MvD;;;IAGA1E,gBAAY,oBAASzK,OAAT,EAAkB;;IAE1B,aAAK2O,cAAL,GAAsBW,MAAMtP,OAAN,IAAiB,GAAjB,GAAuBA,UAAQ,CAArD;;IAEA;IACA,YAAG,KAAK6L,OAAL,IAAgB,KAAKA,OAAL,CAAauD,aAA7B,IAA8C,KAAKvD,OAAL,CAAauD,aAAb,CAA2B7E,OAA5E,EAAqF;IACjF,iBAAI,IAAIvQ,EAAR,IAAc,KAAK6R,OAAL,CAAauD,aAAb,CAA2B7E,OAAzC,EAAkD;IAC9C,oBAAIlP,QAAQ,KAAKwQ,OAAL,CAAauD,aAAb,CAA2B7E,OAA3B,CAAmCvQ,EAAnC,CAAZ;IACA,oBAAGqB,MAAM0F,KAAT,EAAgB;IACZyK,2BAAOnQ,MAAM0F,KAAb,EAAoBwO,GAApB,CAAwB,EAACvP,SAASA,OAAV,EAAxB;IACH;IACJ;IACJ;;IAED;IACA,YAAG,KAAKuK,OAAR,EAAiB;IACb,iBAAI,IAAIvQ,IAAR,IAAc,KAAKuQ,OAAnB,EAA4B;IACxB,oBAAIlP,UAAQ,KAAKkP,OAAL,CAAavQ,IAAb,CAAZ;IACA,oBAAGqB,QAAMoP,UAAT,EACIpP,QAAMoP,UAAN,CAAiBzK,OAAjB;IACP;IACJ;IACJ,KArOsD;;IAuOvDqL,cAAU,kBAAS5N,KAAT,EAAgB;IACtB,aAAKiQ,WAAL,CAAiB,UAAUrS,KAAV,EAAiB;IAC9B,iBAAKoS,eAAL,CAAqBpS,MAAMsL,OAAN,CAAc3M,EAAnC,EAAuCyD,KAAvC;IACH,SAFD,EAEG,IAFH;IAGH,KA3OsD;;IA6OvDiN,eAAW,mBAASC,SAAT,EAAoB;IAAA;;IAE3B,YAAG,KAAKpT,OAAL,CAAaqT,WAAhB,EAA6B;IACzB,iBAAKrT,OAAL,CAAaqT,WAAb,CAAyBD,SAAzB,EACClH,IADD,CACO,gBAAQ;;IAEX,oBAAG,CAACoH,IAAJ,EAAU;;IAEV,oBAAIpN,QAAQ,IAAZ;;IAEA,oBAAGoN,QAAQA,KAAKC,MAAhB,EAAwB;;IAEpB,wBAAIC,UAAU5I,SAAK+H,IAAL,CAAU,UAASvD,OAAT,EAAkB;;IAEtC,4BAAIqE,WAAW,KAAKA,QAAL,IAAiB,KAAKC,MAArC;IACA,4BAAIC,IAAIvE,QAAQqE,QAAR,MAAsBrE,QAAQI,UAAR,GAAqBJ,QAAQI,UAAR,CAAmBiE,QAAnB,CAArB,GAAoD,IAA1E,CAAR;IACA,4BAAIvN,QAAQ,IAAZ;IACA,4BAAG,KAAKqN,MAAR,EAAgB;IACZ,gCAAIK,UAAU,KAAKL,MAAL,CAAY3D,IAAZ,CAAkB;IAAA,uCAAMiE,GAAG9I,KAAH,KAAa4I,CAAnB;IAAA,6BAAlB,CAAd;IACA,gCAAGC,OAAH,EAAY;IACR1N,wCAAQ0N,QAAQ1N,KAAhB;IACAA,sCAAMzF,MAAN,GAAeyF,MAAM,cAAN,KAAyBA,MAAMzF,MAA/B,IAAyC,CAAxD;IACAyF,sCAAMuB,MAAN,GAAevB,MAAM,cAAN,KAAyBA,MAAMuB,MAA/B,IAAyC,CAAxD;IACAvB,sCAAMsB,KAAN,GAActB,MAAM2L,MAAN,IAAgB3L,MAAMsB,KAAtB,IAA+B,MAA7C;IACAtB,sCAAMuC,OAAN,GAAgBvC,MAAM,gBAAN,KAA2BA,MAAMuC,OAAjC,IAA4C,GAA5D;IACAvC,sCAAMyC,WAAN,GAAoBzC,MAAM,cAAN,KAAyBA,MAAMuC,OAA/B,IAA0C,GAA9D;IACAvC,sCAAM8K,SAAN,GAAkB9K,MAAMwC,IAAN,IAAcxC,MAAMsB,KAApB,IAA6B,MAA/C;IACH,6BARD,MAQO;IACHtG,wCAAQsN,GAAR,CAAY,2BAA2ByJ,KAAKC,SAAL,CAAe9I,QAAQI,UAAvB,CAAvC;IACH;IACJ;IACD;IACA,+BAAOtJ,KAAP;IACH,qBArBa,EAqBXoN,IArBW,CAAd;IAsBA,2BAAKtT,OAAL,CAAakG,KAAb,GAAqBsN,OAArB;IACA2E,+BAAY,UAACrU,KAAD,EAAQoC,KAAR,EAAkB;IAAEpC,8BAAMgQ,QAAN,CAAe5N,KAAf;IAAwB,qBAAxD,EAA0D,IAA1D,EAAgE,MAAhE,EAAsEsN,OAAtE;IACA;IAEH,iBA5BD,MA4BO,IAAGF,QAAQ,OAAOA,KAAKS,IAAZ,KAAsB,WAAjC,EAA8C;IACjD;IACA7N,4BAAQoN,KAAK,CAAL,CAAR,CAFiD;IAIpD,iBAJM,MAIA,IAAGA,IAAH,EAAS;IACZpN,4BAAQoN,IAAR;IAEH,iBAHM,MAGA;IACH,2BADG;IAEN;;IAED,oBAAGpN,MAAMgL,KAAT,EAAgB;IACZ,wBAAI8C,MAAMC,OAAOlU,MAAP,CAAc,EAAd,EAAkBmG,KAAlB,CAAV;IACA8N,wBAAI9N,KAAJ,GAAYA,KAAZ;IACA,2BAAK6K,QAAL,GAAgB7K,KAAhB;;IAEA;IACA;IACA;IACA;IACA,yBAAI,IAAIzD,EAAR,IAAc,OAAKuQ,OAAnB;IACI,+BAAKA,OAAL,CAAavQ,EAAb,EAAiBqR,QAAjB,CAA0BE,GAA1B;IADJ;IAGH;IACJ,aA3DD,EA4DC3H,KA5DD,CA4DQ,aAAK;IACTnL,wBAAQsN,GAAR,CAAY,oCAAZ;IACAtN,wBAAQsN,GAAR,CAAY7K,CAAZ;IACH,aA/DD;IAgEH;IACJ;IAjTsD,CAA/B,CAA5B;;IAuTA;;;;;IAKA,SAASyU,iBAAT,CAA2BtU,KAA3B,EAAkC9D,OAAlC,EAA2C;;IAEvC,QAAIsO,UAAUxK,MAAMuU,QAAN,IAAkBvU,MAAMuU,QAAN,CAAe9X,MAAjC,GACVuD,MAAMuU,QAAN,CAAe,CAAf,CADU,GACU,IADxB;IAEA,QAAG,CAAC/J,OAAJ,EAAa;IACT,YAAIgK,kIAAJ;IAGA,cAAM,IAAI7B,KAAJ,CAAU6B,GAAV,CAAN;IACH;;IAED,QAAI/J,MAAUD,QAAQ5I,IAAtB;IAAA,QACI6S,SAAUzU,MAAM0U,gBAAN,GAAyB1U,MAAM0U,gBAAN,CAAuB,CAAvB,CAAzB,GAAqD,IADnE;;IAGA,QAAIlB,gBAAgBtX,WAAWA,QAAQsX,aAAnB,GAChBtX,QAAQsX,aADQ,GACQhB,oBAD5B;;IAGA,QAAImC,OAAO;IACPlK,aAAKA,MAAM,GAAN,GAAYzK,MAAM4U,SADhB;IAEPrF,qBAAaiE,aAFN;IAGPC,iBAASzT,MAAMrB;IAHR,KAAX;;IAMA,QAAG+I,yBAAOkG,WAAV,EAAuB+G,KAAK9G,IAAL,GAAYnG,yBAAOkG,WAAnB;IACvB,QAAG1R,WAAWA,QAAQ0R,WAAtB,EAAmC+G,KAAK9G,IAAL,GAAY3R,QAAQ0R,WAApB;;IAEnC,WAAO,IAAIuF,qBAAJ,CAA0BwB,IAA1B,CAAP;IACH;;IAID;;;;;IAKA,SAASE,WAAT,CAAqB7U,KAArB,EAA4B9D,OAA5B,EAAqC;;IAEjC,QAAIsO,UAAUxK,MAAMuU,QAAN,IAAkBvU,MAAMuU,QAAN,CAAe9X,MAAjC,GACVuD,MAAMuU,QAAN,CAAe,CAAf,CADU,GACU,IADxB;IAEA,QAAG,CAAC/J,OAAJ,EAAa;IACT,YAAIgK,4HAAJ;IAGA,cAAM,IAAI7B,KAAJ,CAAU6B,GAAV,CAAN;IACH;;IAED,QAAI/J,MAAUD,QAAQ5I,IAAtB;IAAA,QACI6S,SAAUzU,MAAM0U,gBAAN,GAAyB1U,MAAM0U,gBAAN,CAAuB,CAAvB,CAAzB,GAAqD,IADnE;;IAGA,QAAII,WAAWrK,OAAOA,IAAIA,IAAIhO,MAAJ,GAAW,CAAf,MAAoB,GAApB,GAAwB,EAAxB,GAA2B,GAAlC,IACXuD,MAAMrB,EADK,GACA,iBADA,GACoBqB,MAAM4U,SADzC;;IAGA,QAAIG,WAAWtK,IAAIqG,OAAJ,CAAY,OAAZ,EAAoB,QAApB,KACVrG,IAAIA,IAAIhO,MAAJ,GAAW,CAAf,MAAoB,GAApB,GAAwB,EAAxB,GAA2B,GADjB,IACwBuD,MAAMrB,EAD7C;;IAGA,QAAIqW,qBAAqB,SAArBA,kBAAqB,CAASvK,GAAT,EAAc;IACnC,eAAO,UAAUgJ,OAAV,EAAmB;IACtB,gBAAIhB,WAAWjK,EAAEkK,KAAF,EAAf;IACA,gBAAG,CAACvC,MAAJ,EAAY;IACRsC,yBAAShK,MAAT,CAAgB,IAAIkK,KAAJ,CAAU,4DAAV,CAAhB;IACA,uBAAOF,SAASG,OAAhB;IACH;IACDzC,mBAAO0C,IAAP,CAAYpI,GAAZ,EAAiB;IACbqI,0BAAS,MADI;IAEbC,yBAAS,iBAAShI,IAAT,EAAe;IACpB0H,6BAAS3J,OAAT,CAAiBiC,IAAjB;IACH,iBAJY;IAKb1N,uBAAO,eAAS2V,GAAT,EAAcC,MAAd,EAAsB7H,OAAtB,EAA+B;IAClC,wBAAI8H,6FAC4CO,OAD5C,WACyDrI,OAD7D;IAEA,wBAAI/N,QAAQ,IAAIsV,KAAJ,CAAUO,EAAV,CAAZ;IACAT,6BAAShK,MAAT,CAAgBpL,KAAhB;IACH;IAVY,aAAjB;IAYA,mBAAOoV,SAASG,OAAhB,CAlBsB;IAmBzB,SAnBD;IAoBH,KArBD;;IAuBA,QAAI+B,OAAO;IACPlK,aAAKqK,QADE;IAEPG,kBAAU,IAFH;IAGPxB,iBAASzT,MAAMrB,EAHR;IAIP4Q,qBAAayF,mBAAmBD,QAAnB;IAJN,KAAX;;IAOA,QAAGrN,yBAAOkG,WAAV,EAAuB+G,KAAK9G,IAAL,GAAYnG,yBAAOkG,WAAnB;IACvB,QAAG1R,WAAWA,QAAQ0R,WAAtB,EAAmC+G,KAAK9G,IAAL,GAAY3R,QAAQ0R,WAApB;;IAEnC,WAAO,IAAIuF,qBAAJ,CAA0BwB,IAA1B,CAAP;IAEH;;ICxaD,IAAIzK,MAAMgL,cAAUhL,GAAV,CAAcjO,MAAd,CAAqB;;IAE3BkZ,0BAAsB,gCAAY;IAC9B,aAAK5W,IAAL,CAAU6B,EAAV,CAAa,OAAb,EAAsB,KAAKgV,cAA3B,EAA2C,IAA3C;IACA,aAAKC,QAAL,GAAgB,IAAhB;IACH,KAL0B;;IAO3BC,2BAAuB,iCAAW;IAC9B,aAAK/W,IAAL,CAAUmC,GAAV,CAAc,OAAd,EAAuB,KAAK0U,cAA5B,EAA4C,IAA5C;IACA,aAAKC,QAAL,GAAgB,KAAhB;IACH,KAV0B;;IAY3BE,6BAAyB,mCAAW;IAChC,eAAO,KAAKF,QAAZ;IACH,KAd0B;;IAgB3BnX,cAAU,kBAAUhB,GAAV,EAAe;;IAErB;IACA,YAAG,KAAKqY,uBAAL,EAAH,EACA,KAAKD,qBAAL;;IAEA;IACA;IACAJ,sBAAUhL,GAAV,CAAc1L,SAAd,CAAwBN,QAAxB,CAAiCO,IAAjC,CAAsC,IAAtC,EAA4CvB,GAA5C;IACH,KAzB0B;;IA2B3BkY,oBAAgB,wBAAUI,GAAV,EAAe;IAC3B;IACA,YAAI/K,MAAM,KAAKgL,iBAAL,CAAuBD,IAAIlS,MAA3B,CAAV;IAAA,YACAoS,cAAc5O,SAAK+H,IAAL,CAAU,KAAK8G,kBAAf,EAAmC,IAAnC,CADd;IAAA,YAEAC,sBAAsB,KAAKA,mBAF3B;IAGAzF,eAAO0C,IAAP,CAAY;IACRpI,iBAAKA,GADG;IAERsI,qBAAS,iBAAUhI,IAAV,EAAgBkI,MAAhB,EAAwBD,GAAxB,EAA6B;IAClC;IACA,oBAAG,OAAOjI,IAAP,KAAiB,QAApB,EACAA,OAAO6K,oBAAoB7K,IAApB,CAAP;IACA2K,4BAAY,IAAZ,EAAkBF,IAAIlS,MAAtB,EAA8ByH,IAA9B;IACH,aAPO;IAQR1N,mBAAO,eAAU2V,GAAV,EAAeC,MAAf,EAAuB5V,MAAvB,EAA8B;IACjCqY,4BAAYrY,MAAZ;IACH;IAVO,SAAZ;IAYH,KA5C0B;;IA8C3BoY,uBAAmB,2BAAUnS,MAAV,EAAkB;IACjC;IACA,YAAIuS,QAAQ,KAAKtX,IAAL,CAAUuX,sBAAV,CAAiCxS,MAAjC,EAAyC,KAAK/E,IAAL,CAAUwX,OAAV,EAAzC,CAAZ;IAAA,YACA7W,OAAO,KAAKX,IAAL,CAAUyX,OAAV,EADP;IAAA,YAGAC,SAAS;IACLC,iBAAK,WADA;IAELC,kBAAM,KAAK5X,IAAL,CAAU6X,SAAV,GAAsBC,YAAtB,EAFD;IAGLhJ,oBAAQnO,KAAKoX,CAHR;IAIL5Z,mBAAOwC,KAAKqX,CAJP;IAKL;IACA;IACAC,yBAAa,UAPR;IAQLD,eAAGV,MAAMU,CARJ;IASLD,eAAGT,MAAMS,CATJ;IAULxL,eAAG+K,MAAMU,CAVJ;IAWLE,eAAGZ,MAAMS,CAXJ;IAAA,SAHT;;IAiBA;IACA,YAAI7L,MAAM,iBAAiB,KAAKiM,SAAL,CAAeC,KAAhC,GAAwC,UAAlD;IACA,eAAOjP,yBAAOQ,MAAP,GAAgBuC,GAAhB,GAAsB3D,SAAK8P,cAAL,CAAoBX,MAApB,EAA4BxL,GAA5B,EAAiC,IAAjC,CAA7B;IACH,KApE0B;;IAsE3BmL,yBAAqB,6BAASpI,OAAT,EAAkB;IACnC,YAAIvF,SAAS,EAAb;IACA,aAAI,IAAI4O,KAAR,IAAiBrJ,OAAjB,EAA0B;IACtBvF,mBAAOgI,IAAP,CAAY,CAAC,eAAD,EAAkB4G,KAAlB,EAAyB,aAAzB,EAAwCrJ,QAAQqJ,KAAR,CAAxC,EAAwD,QAAxD,EAAkEC,IAAlE,CAAuE,GAAvE,CAAZ;IACH;IACD,YAAG7O,OAAOxL,MAAP,IAAiB,CAApB,EACAwL,OAAOgI,IAAP,CAAY,4BAAZ;IACA,eAAO,UAAUhI,OAAO6O,IAAP,CAAY,GAAZ,CAAV,GAA6B,QAApC;IACH,KA9E0B;;IAgF3BnB,wBAAoB,4BAAUoB,GAAV,EAAezT,MAAf,EAAuBkK,OAAvB,EAAgC;IAChD,YAAIuJ,GAAJ,EAAS;IAAE3Z,oBAAQsN,GAAR,CAAYqM,GAAZ,EAAkB;IAAS,SADU;;IAGhD;IACAC,kBAAM,EAAEC,UAAU,GAAZ,EAAN,EACC9R,SADD,CACW7B,MADX,EAEC4T,UAFD,CAEY1J,OAFZ,EAGC2J,MAHD,CAGQ,KAAK5Y,IAHb;IAIH;;IAxF0B,CAArB,CAAV;;IA6FA,SAAS6Y,GAAT,CAAapX,KAAb,EAAoB;;IAEhB,QAAIwK,UAAUxK,MAAMuU,QAAN,IAAkBvU,MAAMuU,QAAN,CAAe9X,MAAjC,GACVuD,MAAMuU,QAAN,CAAe,CAAf,CADU,GACU,IADxB;IAEA,QAAG,CAAC/J,OAAJ,EAAa;IACT,YAAIgK,oHAAJ;IAGA,cAAM,IAAI7B,KAAJ,CAAU6B,GAAV,CAAN;IACH;;IAED,QAAI/J,MAAMD,QAAQ5I,IAAlB;IACA,QAAIyV,UAAUrX,MAAM0U,gBAAN,IAA0B,EAAxC;IACA,QAAID,SAAU4C,QAAQ5a,MAAR,GAAiB4a,QAAQ,CAAR,CAAjB,GAA8B,WAA5C;;IAEA,QAAG,CAAC5M,GAAJ,EAAS;IACL,cAAM,IAAIkI,KAAJ,CAAU,oDAAV,CAAN;IACH;;IAED,QAAI2E,eAAetX,MAAMuX,GAAN,IAAa,EAAhC;IACA,QAAGD,gBAAgBA,aAAa7a,MAAb,GAAsB,CAAtC,IAA2C,CAAC6a,aAAazP,OAAb,CAAqB,WAArB,CAA/C,EAAkF;IAC9EzK,gBAAQsN,GAAR,CAAY,YAAY1K,MAAMiL,KAAlB,GAA0B,qBAA1B,GACR,qFADJ;IAEH;;IAED;IACA,QAAIuM,UAAU,OAAd;IACA,QAAIC,WAAWjN,QAAQkN,mBAAR,IAA+B,EAA9C;IACA,QAAGD,SAAShb,MAAT,IAAmBgb,SAAS5P,OAAT,CAAiB,OAAjB,IAA4B,CAAlD,EAAqD;IACjD2P,kBAAUC,SAAS,CAAT,CAAV;IACH,KAFD,MAEO;IACHra,gBAAQsN,GAAR,CAAY,sEAAZ;IACH;;IAGD,QAAIiK,OAAO;IACPgD,gBAAQ3X,MAAM4U,SADP;IAEPgD,qBAAa,IAFN;IAGPnD,gBAAQA,MAHD;IAIPkC,eAAO3W,MAAMrB,EAJN;IAKP6Y,iBAASA;IALF,KAAX;IAOA,QAAG9P,yBAAOkG,WAAV,EACI+G,KAAK9G,IAAL,GAAYnG,yBAAOkG,WAAnB;;IAEJ,WAAO,IAAI1D,GAAJ,CAAQO,GAAR,EAAakK,IAAb,CAAP;IAEH;;ICrJD;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA,CAAC,CAAC,aAAa,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,KAAK,EAAE,MAAM,CAAC;;IAE9C,IAAI,QAAQ,GAAG,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC;;IAE3C,IAAI,UAAU,EAAE,UAAU,OAAO,EAAE;IACnC,QAAQ,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;IACpC;IACA,QAAQ,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,uBAAuB,EAAE,CAAC;IAC9D,QAAQ,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC,CAAC;IACpC,QAAQ,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC,CAAC;IACpC,QAAQ,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC,cAAc,IAAI,IAAI,CAAC;IACnE,QAAQ,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;IAChC,QAAQ,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE;IAC7C,YAAY,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,IAAI,IAAI,CAAC,sBAAsB,EAAE,CAAC,CAAC;IAC3F,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,EAAE;IACzC,YAAY,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;IAC5D,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,EAAE;IACzC,YAAY,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;IAC5D,SAAS;IACT,KAAK;;IAEL,IAAI,iBAAiB,EAAE,YAAY;IACnC,QAAQ,OAAO,IAAI,CAAC,eAAe,CAAC;IACpC,KAAK;;IAEL,IAAI,mBAAmB,EAAE,YAAY;IACrC,QAAQ,IAAI,IAAI,CAAC,iBAAiB,KAAK,CAAC,CAAC,EAAE;IAC3C,YAAY,OAAO,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC;IACnD,SAAS;IACT,QAAQ,OAAO,IAAI,CAAC,iBAAiB,CAAC;IACtC,KAAK;;IAEL,IAAI,cAAc,EAAE,YAAY;IAChC,QAAQ,IAAI,KAAK,GAAG,CAAC,CAAC,CAAC;IACvB,QAAQ,IAAI,IAAI,CAAC,iBAAiB,KAAK,CAAC,CAAC,EAAE;IAC3C,YAAY,KAAK,GAAG,IAAI,CAAC,iBAAiB,CAAC;IAC3C,SAAS,MAAM;IACf,YAAY,KAAK,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAC;IAC/C,SAAS;IACT,QAAQ,IAAI,KAAK,IAAI,CAAC,EAAE;IACxB,YAAY,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;IAC/C,SAAS,MAAM;IACf,YAAY,OAAO,IAAI,CAAC;IACxB,SAAS;IACT,KAAK;;IAEL,IAAI,SAAS,EAAE,YAAY;IAC3B,QAAQ,QAAQ,IAAI,CAAC,iBAAiB,KAAK,CAAC,CAAC,EAAE;IAC/C,KAAK;;IAEL,IAAI,mBAAmB,EAAE,UAAU,QAAQ,EAAE;IAC7C,QAAQ,IAAI,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC;IAC7E,QAAQ,IAAI,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,CAAC,CAAC;IAC/C;IACA,QAAQ,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,QAAQ,CAAC,EAAE,UAAU,CAAC,CAAC;IACxE,QAAQ,IAAI,QAAQ,GAAG,CAAC,EAAE;IAC1B,YAAY,OAAO;IACnB,SAAS;IACT,QAAQ,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC;IAC1C,QAAQ,IAAI,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;IACrD;IACA,QAAQ,IAAI,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,EAAE;IACxF,YAAY,IAAI,CAAC,mBAAmB,EAAE,CAAC;IACvC,SAAS,MAAM;IACf,YAAY,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;IACrC,gBAAgB,IAAI,EAAE,OAAO;IAC7B,aAAa,CAAC,CAAC;IACf;IACA,YAAY,UAAU,CAAC,CAAC,UAAU,KAAK,EAAE;IACzC,gBAAgB,IAAI,KAAK,IAAI,IAAI,CAAC,iBAAiB,EAAE;IACrD;IACA,oBAAoB,IAAI,CAAC,mBAAmB,EAAE,CAAC;IAC/C,iBAAiB;IACjB,aAAa,EAAE,IAAI,CAAC,IAAI,EAAE,QAAQ,CAAC,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;IAC3D,SAAS;;IAET,KAAK;;IAEL,IAAI,mBAAmB,EAAE,YAAY;IACrC,QAAQ,IAAI,IAAI,CAAC,iBAAiB,KAAK,CAAC,CAAC,EAAE;IAC3C,YAAY,OAAO;IACnB,SAAS;IACT,QAAQ,IAAI,IAAI,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;IAChE;IACA,QAAQ,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,CAAC;IACxD,QAAQ,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;IAC9B,YAAY,IAAI,EAAE,IAAI;IACtB,SAAS,CAAC,CAAC;IACX,QAAQ,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC,CAAC;IACpC,KAAK;IACL;IACA,IAAI,uBAAuB,EAAE,UAAU,IAAI,EAAE;IAC7C,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;IACvE,YAAY,IAAI,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE;IAC/C,gBAAgB,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;IAC1D,KAAK,OAAO,KAAK,CAAC;IAClB,iBAAiB;IACjB,aAAa;IACb,SAAS;IACT,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;IACL;IACA,IAAI,cAAc,EAAE,UAAU,IAAI,EAAE;IACpC,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;IACxD,QAAQ,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;IAC3C,KAAK;;IAEL,IAAI,eAAe,EAAE,UAAU,IAAI,EAAE;IACrC,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;IACrD,QAAQ,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;IAC3C,KAAK;;IAEL,IAAI,QAAQ,EAAE,UAAU,QAAQ,EAAE,IAAI,EAAE;IACxC,QAAQ,IAAI,CAAC,QAAQ,EAAE;IACvB,YAAY,QAAQ,GAAG,CAAC,CAAC;IACzB,SAAS;IACT,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC;IAC9C,QAAQ,IAAI,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC;IAC7E,QAAQ,IAAI,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,CAAC,CAAC;IAC/C,QAAQ,IAAI,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC,EAAE;IACzC,YAAY,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC;IAC9C,SAAS;IACT,QAAQ,QAAQ,GAAG,QAAQ,GAAG,QAAQ,CAAC;IACvC,QAAQ,IAAI,QAAQ,GAAG,UAAU,EAAE;IACnC,YAAY,IAAI,CAAC,CAAC,IAAI,EAAE;IACxB,gBAAgB,QAAQ,GAAG,UAAU,CAAC;IACtC,aAAa,MAAM;IACnB,gBAAgB,QAAQ,GAAG,UAAU,CAAC;IACtC,aAAa;IACb,SAAS;IACT;IACA,QAAQ,IAAI,QAAQ,GAAG,UAAU,EAAE;IACnC,YAAY,IAAI,CAAC,CAAC,IAAI,EAAE;IACxB,gBAAgB,QAAQ,GAAG,UAAU,CAAC;IACtC,aAAa,MAAM;IACnB,gBAAgB,QAAQ,GAAG,UAAU,CAAC;IACtC,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;IAC3C,KAAK;;IAEL,IAAI,gBAAgB,EAAE,UAAU,QAAQ,EAAE,OAAO,EAAE,IAAI,EAAE;IACzD,QAAQ,IAAI,CAAC,QAAQ,EAAE;IACvB,YAAY,QAAQ,GAAG,CAAC,CAAC;IACzB,SAAS;;IAET,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC;IAC9C,QAAQ,IAAI,YAAY,GAAG,QAAQ,CAAC;IACpC,QAAQ,IAAI,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC,EAAE;IACzC,YAAY,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC;IAC9C,SAAS;IACT;IACA,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;IACvE,YAAY,IAAI,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,sBAAsB,EAAE;IAC9D,gBAAgB,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,sBAAsB,CAAC,OAAO,CAAC,CAAC;IACtE,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,KAAK,GAAG,OAAO,CAAC;IAC5B,QAAQ,IAAI,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC;IAC7E,QAAQ,IAAI,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,CAAC,CAAC;IAC/C,QAAQ,OAAO,KAAK,GAAG,CAAC,EAAE;IAC1B,YAAY,QAAQ,GAAG,QAAQ,GAAG,QAAQ,CAAC;IAC3C,YAAY,IAAI,QAAQ,GAAG,UAAU,EAAE;IACvC,gBAAgB,IAAI,CAAC,CAAC,IAAI,EAAE;IAC5B,oBAAoB,QAAQ,GAAG,UAAU,CAAC;IAC1C,iBAAiB,MAAM;IACvB,oBAAoB,MAAM;IAC1B,iBAAiB;IACjB,aAAa;IACb,YAAY,IAAI,QAAQ,GAAG,UAAU,EAAE;IACvC,gBAAgB,IAAI,CAAC,CAAC,IAAI,EAAE;IAC5B,oBAAoB,QAAQ,GAAG,UAAU,CAAC;IAC1C,iBAAiB,MAAM;IACvB,oBAAoB,MAAM;IAC1B,iBAAiB;IACjB,aAAa;IACb,YAAY,IAAI,YAAY,KAAK,QAAQ,EAAE;IAC3C;IACA;IACA,gBAAgB,MAAM;IACtB,aAAa;IACb,YAAY,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;IACrC,gBAAgB,IAAI,EAAE,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC;IACpD,aAAa,CAAC,CAAC;IACf,YAAY,KAAK,EAAE,CAAC;IACpB,SAAS;IACT,KAAK;;IAEL,IAAI,uBAAuB,EAAE,UAAU,QAAQ,EAAE,OAAO,EAAE,IAAI,EAAE;IAChE,QAAQ,IAAI,CAAC,QAAQ,EAAE;IACvB,YAAY,QAAQ,GAAG,CAAC,CAAC;IACzB,SAAS;;IAET,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC;IAC9C,QAAQ,IAAI,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC,EAAE;IACzC,YAAY,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC;IAC9C,SAAS;IACT,QAAQ,IAAI,KAAK,GAAG,OAAO,CAAC;IAC5B,QAAQ,IAAI,KAAK,GAAG,CAAC,CAAC;IACtB,QAAQ,IAAI,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC;IAC7E,QAAQ,IAAI,UAAU,GAAG,IAAI,CAAC,WAAW,IAAI,CAAC,CAAC;IAC/C,QAAQ,OAAO,KAAK,GAAG,CAAC,EAAE;IAC1B,YAAY,QAAQ,GAAG,QAAQ,GAAG,QAAQ,CAAC;IAC3C,YAAY,IAAI,QAAQ,GAAG,UAAU,EAAE;IACvC,gBAAgB,IAAI,CAAC,CAAC,IAAI,EAAE;IAC5B,oBAAoB,QAAQ,GAAG,UAAU,CAAC;IAC1C,iBAAiB,MAAM;IACvB,oBAAoB,KAAK,GAAG,CAAC,CAAC;IAC9B,oBAAoB,KAAK,GAAG,OAAO,CAAC;IACpC,oBAAoB,MAAM;IAC1B,iBAAiB;IACjB,aAAa;IACb,YAAY,IAAI,QAAQ,GAAG,UAAU,EAAE;IACvC,gBAAgB,IAAI,CAAC,CAAC,IAAI,EAAE;IAC5B,oBAAoB,QAAQ,GAAG,UAAU,CAAC;IAC1C,iBAAiB,MAAM;IACvB,oBAAoB,KAAK,GAAG,CAAC,CAAC;IAC9B,oBAAoB,KAAK,GAAG,OAAO,CAAC;IACpC,oBAAoB,MAAM;IAC1B,iBAAiB;IACjB,aAAa;IACb,YAAY,IAAI,IAAI,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;IACtD,YAAY,IAAI,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,EAAE;IACpD,gBAAgB,KAAK,EAAE,CAAC;IACxB,aAAa;IACb,YAAY,KAAK,EAAE,CAAC;IACpB,SAAS;IACT,QAAQ,OAAO,KAAK,CAAC;IACrB,KAAK;;IAEL,IAAI,YAAY,EAAE,UAAU,QAAQ,EAAE,IAAI,EAAE;IAC5C,QAAQ,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;IAC3C,KAAK;;IAEL,IAAI,mBAAmB,EAAE,UAAU,KAAK,EAAE;IAC1C,QAAQ,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACvC,QAAQ,KAAK,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;IAC9D,KAAK;;IAEL,IAAI,qBAAqB,EAAE,UAAU,KAAK,EAAE;IAC5C,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IACtD,QAAQ,IAAI,KAAK,IAAI,CAAC,CAAC,EAAE;IACzB,YAAY,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;IAChD,SAAS;IACT,QAAQ,KAAK,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;IAC/D,KAAK;;IAEL,IAAI,oBAAoB,EAAE,UAAU,CAAC,EAAE;IACvC,QAAQ,IAAI,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,iBAAiB,CAAC,IAAI,IAAI,CAAC,uBAAuB,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;IAC5G,YAAY,IAAI,CAAC,mBAAmB,EAAE,CAAC;IACvC,SAAS;IACT,KAAK;;IAEL,IAAI,uBAAuB,EAAE,YAAY;IACzC,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE;IAChC,YAAY,OAAO,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IACjF,SAAS,MAAM,IAAI,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE;IAC9C,YAAY,IAAI,OAAO,GAAG,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;IAC5F,YAAY,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,KAAK,CAAC;IACtD,YAAY,IAAI,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,cAAc,IAAI,SAAS,CAAC;IAC1E,YAAY,OAAO,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,EAAE,MAAM,EAAE,cAAc,CAAC,CAAC;IACzG,SAAS,MAAM;IACf,YAAY,OAAO,EAAE,CAAC;IACtB,SAAS;IACT,KAAK;;IAEL,IAAI,sBAAsB,EAAE,YAAY;IACxC,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,CAAC;IACrE,QAAQ,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;IAC3C,KAAK;;IAEL,IAAI,qBAAqB,EAAE,UAAU,IAAI,EAAE;IAC3C,QAAQ,IAAI,QAAQ,GAAG,CAAC,CAAC;IACzB,QAAQ,IAAI,GAAG,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;IAC9C,QAAQ,OAAO,QAAQ,GAAG,GAAG,EAAE,QAAQ,EAAE,EAAE;IAC3C,YAAY,IAAI,IAAI,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE;IACvD,gBAAgB,MAAM;IACtB,aAAa;IACb,SAAS;IACT;IACA,QAAQ,IAAI,QAAQ,GAAG,CAAC,EAAE;IAC1B,YAAY,QAAQ,EAAE,CAAC;IACvB,SAAS;IACT,QAAQ,OAAO,QAAQ,CAAC;IACxB,KAAK;;IAEL,IAAI,iBAAiB,EAAE,UAAU,KAAK,EAAE,IAAI,EAAE;IAC9C,QAAQ,IAAI,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE;IAC/C,YAAY,cAAc,GAAG,IAAI,CAAC,aAAa,EAAE;IACjD,YAAY,cAAc,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;;IAElD,QAAQ,IAAI,IAAI,IAAI,UAAU,EAAE;IAChC,YAAY,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,KAAK,CAAC;IACtD,YAAY,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;IACxI,SAAS,MAAM;IACf,YAAY,IAAI,WAAW,GAAG,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;IAC/E,YAAY,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,KAAK,CAAC,EAAE;IACnD,gBAAgB,IAAI,CAAC,eAAe,GAAG,WAAW,CAAC;IACnD,aAAa,MAAM,IAAI,IAAI,IAAI,WAAW,EAAE;IAC5C,gBAAgB,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,WAAW,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;IAChH,aAAa,MAAM,IAAI,IAAI,IAAI,OAAO,EAAE;IACxC,gBAAgB,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,IAAI,CAAC,eAAe,CAAC,CAAC;IAC5G,aAAa,MAAM,IAAI,IAAI,IAAI,SAAS,EAAE;IAC1C,gBAAgB,IAAI,CAAC,eAAe,GAAG,WAAW,CAAC;IACnD,aAAa,MAAM;IACnB,gBAAgB,MAAM,8CAA8C,GAAG,IAAI,CAAC;IAC5E,aAAa;IACb,SAAS;;IAET,QAAQ,IAAI,cAAc,EAAE;IAC5B,YAAY,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;IAC/C,SAAS;IACT,QAAQ,IAAI,cAAc,EAAE;IAC5B,YAAY,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC;IAC/C,SAAS;IACT,QAAQ,IAAI,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;IACzC,QAAQ,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE;IAC3C,YAAY,cAAc,EAAE,IAAI,CAAC,eAAe;IAChD,YAAY,WAAW,EAAE,WAAW;IACpC,SAAS,CAAC,CAAC;IACX;IACA,KAAK;IACL,IAAI,aAAa,EAAE,YAAY;IAC/B,QAAQ,OAAO,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;IAC/D,KAAK;IACL,IAAI,aAAa,EAAE,YAAY;IAC/B,QAAQ,OAAO,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;IAC/D,KAAK;IACL,IAAI,aAAa,EAAE,UAAU,IAAI,EAAE;IACnC,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;IACrD,QAAQ,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;IACvC,KAAK;IACL,IAAI,aAAa,EAAE,UAAU,IAAI,EAAE;IACnC,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;IACrD,QAAQ,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;IACvC,KAAK;IACL,IAAI,kBAAkB,EAAE,UAAU,KAAK,EAAE;IACzC,QAAQ,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAClH,QAAQ,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;IACnC,YAAY,UAAU,EAAE,IAAI,CAAC,WAAW;IACxC,YAAY,UAAU,EAAE,IAAI,CAAC,WAAW;IACxC,SAAS,CAAC,CAAC;IACX,KAAK;IACL,IAAI,kBAAkB,EAAE,UAAU,KAAK,EAAE;IACzC,QAAQ,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,WAAW,IAAI,CAAC,CAAC,CAAC;IAC7G,QAAQ,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE;IACnC,YAAY,UAAU,EAAE,IAAI,CAAC,WAAW;IACxC,YAAY,UAAU,EAAE,IAAI,CAAC,WAAW;IACxC,SAAS,CAAC,CAAC;IACX,KAAK;IACL,IAAI,kBAAkB,EAAE,YAAY;IACpC,QAAQ,OAAO,IAAI,CAAC,WAAW,CAAC;IAChC,KAAK;IACL,IAAI,kBAAkB,EAAE,YAAY;IACpC,QAAQ,OAAO,IAAI,CAAC,WAAW,CAAC;IAChC,KAAK;IACL,CAAC,CAAC,CAAC;;IAEH,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,YAAY;IAC9B,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE;IACpC,QAAQ,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,oBAAoB,IAAI,EAAE,CAAC,CAAC;IACtF,KAAK;IACL,CAAC,CAAC,CAAC;;IAEH,CAAC,CAAC,aAAa,GAAG,UAAU,OAAO,EAAE;IACrC,IAAI,OAAO,IAAI,CAAC,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;IACxC,CAAC,CAAC;;IAEF;IACA;IACA;;IAEA,CAAC,CAAC,aAAa,CAAC,IAAI,GAAG;IACvB,IAAI,eAAe,EAAE,SAAS,WAAW,EAAE;IAC3C,QAAQ,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE;IAC3C,YAAY,MAAM,8GAA8G,CAAC;IACjI,SAAS;IACT,QAAQ,OAAO,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;IAC9D,KAAK;;IAEL,IAAI,eAAe,EAAE,SAAS,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE;IACnD,QAAQ,IAAI,OAAO,GAAG,KAAK,WAAW,EAAE;IACxC,YAAY,GAAG,GAAG,IAAI,CAAC;IACvB,SAAS;IACT,QAAQ,IAAI,OAAO,QAAQ,IAAI,QAAQ,IAAI,QAAQ,YAAY,MAAM,EAAE;IACvE,YAAY,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;IACtD,SAAS;IACT,QAAQ,IAAI,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC;IAChC,QAAQ,IAAI,GAAG,GAAG,GAAG,GAAG,QAAQ,GAAG,KAAK,CAAC;IACzC,QAAQ,IAAI,GAAG,GAAG,GAAG,GAAG,QAAQ,GAAG,KAAK,CAAC;;IAEzC,QAAQ,IAAI,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;IACvC,YAAY,IAAI,CAAC,GAAG,GAAG,UAAU,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,UAAU,CAAC,EAAE,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3E,SAAS;IACT,QAAQ,IAAI,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;IACvC,YAAY,IAAI,CAAC,GAAG,GAAG,OAAO,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,OAAO,CAAC,EAAE,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IACrE,SAAS;IACT,QAAQ,IAAI,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;IACvC;IACA,YAAY,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,EAAE,IAAI,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACzE,SAAS;IACT,QAAQ,IAAI,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;IACvC,YAAY,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,MAAM,CAAC,EAAE,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IACnE,SAAS;IACT,QAAQ,IAAI,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;IACvC,YAAY,IAAI,CAAC,GAAG,GAAG,OAAO,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,OAAO,CAAC,EAAE,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IACrE,SAAS;IACT,QAAQ,IAAI,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;IACvC,YAAY,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC,EAAE,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IACzE,SAAS;IACT,QAAQ,IAAI,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE;IACvC,YAAY,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC,CAAC,IAAI,CAAC,GAAG,GAAG,SAAS,CAAC,EAAE,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IACzE,SAAS;IACT,KAAK;;IAEL,IAAI,oBAAoB,EAAE,SAAS,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE;IACxD,QAAQ,IAAI,OAAO,QAAQ,IAAI,QAAQ,IAAI,QAAQ,YAAY,MAAM,EAAE;IACvE,YAAY,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;IACtD,SAAS;IACT,QAAQ,IAAI,WAAW,GAAG,EAAE,CAAC;IAC7B,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;IACzD,YAAY,WAAW,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3C,SAAS;IACT,QAAQ,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,WAAW,EAAE,GAAG,CAAC,CAAC;IACrD,KAAK;;IAEL,IAAI,wBAAwB,EAAE,SAAS,SAAS,EAAE;IAClD,QAAQ,IAAI,EAAE,GAAG,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACtC,QAAQ,IAAI,SAAS,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACpD,QAAQ,IAAI,OAAO,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAClD,QAAQ,IAAI,QAAQ,GAAG,EAAE,CAAC,MAAM,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;;IAErD,QAAQ,OAAO,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;IACnE,KAAK;;IAEL,IAAI,gBAAgB,EAAE,SAAS,SAAS,EAAE,OAAO,EAAE,WAAW,EAAE,cAAc,EAAE;IAChF,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC;IACzD,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;IACxB,QAAQ,IAAI,WAAW,GAAG,IAAI,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC,CAAC;IACxD,QAAQ,IAAI,OAAO,GAAG,IAAI;IAC1B,YAAY,UAAU,GAAG,IAAI;IAC7B,YAAY,OAAO,GAAG,IAAI;IAC1B,YAAY,UAAU,GAAG,IAAI,CAAC;IAC9B,QAAQ,IAAI,cAAc,KAAK,SAAS,EAAE;IAC1C,YAAY,IAAI,mBAAmB,GAAG,cAAc,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAChE,YAAY,OAAO,GAAG,mBAAmB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3D,YAAY,UAAU,GAAG,mBAAmB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9D,YAAY,OAAO,GAAG,mBAAmB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3D,YAAY,UAAU,GAAG,mBAAmB,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9D,SAAS;IACT,QAAQ,OAAO,WAAW,GAAG,OAAO,EAAE;IACtC,YAAY,IAAI,cAAc,KAAK,SAAS;IAC5C,iBAAiB,WAAW,CAAC,WAAW,EAAE,IAAI,OAAO,IAAI,WAAW,CAAC,WAAW,EAAE,IAAI,OAAO,CAAC;IAC9F,cAAc;IACd,gBAAgB,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,IAAI,OAAO,IAAI,WAAW,CAAC,aAAa,EAAE,IAAI,UAAU;IACtG,qBAAqB,WAAW,CAAC,WAAW,EAAE,IAAI,OAAO,IAAI,WAAW,CAAC,aAAa,EAAE,IAAI,UAAU,CAAC,EAAE;IACzG,oBAAoB,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC,CAAC;IACvD,iBAAiB;IACjB,aAAa;IACb,YAAY,IAAI,CAAC,eAAe,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;IACxD,SAAS;IACT,QAAQ,IAAI,WAAW,IAAI,OAAO,CAAC;IACnC,YAAY,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC,CAAC;IAC3C,SAAS;IACT,QAAQ,OAAO,MAAM,CAAC;IACtB,KAAK;;IAEL,IAAI,iBAAiB,EAAE,SAAS,YAAY,EAAE;IAC9C,QAAQ,IAAI,KAAK,GAAG,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAC5C,QAAQ,IAAI,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE;IAC/B,YAAY,MAAM,kCAAkC,GAAG,YAAY,CAAC;IACpE,SAAS;IACT,QAAQ,IAAI,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7C,QAAQ,IAAI,OAAO,GAAG,IAAI,CAAC;IAC3B,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC;IAC5B,QAAQ,IAAI,KAAK,CAAC,SAAS,CAAC,EAAE;IAC9B;IACA,YAAY,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IACtD,YAAY,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3C,YAAY,SAAS,GAAG,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC;IAC1C,YAAY,IAAI,CAAC,oBAAoB,CAAC,SAAS,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;IACjE,YAAY,OAAO,GAAG,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC;IACxC,SAAS,MAAM;IACf,YAAY,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3C,YAAY,IAAI,KAAK,CAAC,OAAO,CAAC,EAAE;IAChC;IACA,gBAAgB,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1D,gBAAgB,OAAO,GAAG,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC;IAC9C,gBAAgB,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;IAC9D,aAAa,MAAM;IACnB;IACA,gBAAgB,OAAO,GAAG,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC;IAC5C,aAAa;IACb,YAAY,SAAS,GAAG,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC;IAC5C,SAAS;IACT,QAAQ,OAAO,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;IACpC,KAAK;;IAEL,IAAI,oBAAoB,EAAE,SAAS,KAAK,EAAE;IAC1C,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;IACxB,QAAQ,IAAI,CAAC,KAAK,EAAE;IACpB,YAAY,OAAO,MAAM,CAAC;IAC1B,SAAS;IACT,QAAQ,IAAI,OAAO,KAAK,IAAI,QAAQ,IAAI,KAAK,YAAY,MAAM,EAAE;IACjE,YAAY,IAAI,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IAC9C,YAAY,IAAI,SAAS,CAAC;IAC1B,YAAY,IAAI,SAAS,CAAC;IAC1B,YAAY,KAAK,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;IACxD,gBAAgB,SAAS,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;IAC1C,gBAAgB,IAAI,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,IAAI,CAAC,EAAE;IACtD,oBAAoB,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,wBAAwB,CAAC,SAAS,CAAC,CAAC,CAAC;IACrF,iBAAiB,MAAM;IACvB,oBAAoB,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;IACtD,oBAAoB,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE;IAC3C,wBAAwB,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IAC/C,qBAAqB;IACrB,iBAAiB;IACjB,aAAa;IACb,SAAS,MAAM;IACf,YAAY,MAAM,GAAG,KAAK,CAAC;IAC3B,SAAS;IACT,QAAQ,OAAO,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE;IAC1C,YAAY,OAAO,CAAC,GAAG,CAAC,CAAC;IACzB,SAAS,CAAC,CAAC;IACX,KAAK;;IAEL,IAAI,gBAAgB,EAAE,SAAS,MAAM,EAAE,MAAM,EAAE;IAC/C,QAAQ,IAAI,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAChC,QAAQ,IAAI,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAChC,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;IACxB,QAAQ,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;IAC7C,YAAY,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;IAC7B,gBAAgB,CAAC,CAAC,KAAK,EAAE,CAAC;IAC1B,aAAa,MAAM,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;IACpC,gBAAgB,CAAC,CAAC,KAAK,EAAE,CAAC;IAC1B,aAAa,0BAA0B;IACvC,gBAAgB,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC;IACvC,gBAAgB,CAAC,CAAC,KAAK,EAAE,CAAC;IAC1B,aAAa;IACb,SAAS;IACT,QAAQ,OAAO,MAAM,CAAC;IACtB,KAAK;;IAEL,IAAI,YAAY,EAAE,SAAS,MAAM,EAAE,MAAM,EAAE;IAC3C,QAAQ,IAAI,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAChC,QAAQ,IAAI,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAChC,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;IACxB,QAAQ,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;IAC7C,YAAY,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;IAC7B,gBAAgB,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC;IACvC,aAAa,MAAM,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;IACpC,gBAAgB,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC;IACvC,aAAa,0BAA0B;IACvC,gBAAgB,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC;IACvC,gBAAgB,CAAC,CAAC,KAAK,EAAE,CAAC;IAC1B,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;IAC1B,YAAY,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IACtC,SAAS,MAAM,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;IACjC,YAAY,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IACtC,SAAS;IACT,QAAQ,OAAO,MAAM,CAAC;IACtB,KAAK;;IAEL,CAAC,CAAC;;IAEF;IACA;IACA;IACA;IACA;IACA;;IAEA,CAAC,CAAC,aAAa,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,KAAK,EAAE,MAAM,CAAC;;IAEpD,IAAI,QAAQ,GAAG,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC;IAC3C,IAAI,OAAO,EAAE;IACb,QAAQ,OAAO,EAAE,CAAC;IAClB,QAAQ,MAAM,EAAE,CAAC;IACjB,KAAK;;IAEL,IAAI,UAAU,EAAE,SAAS,KAAK,EAAE,OAAO,EAAE;IACzC,QAAQ,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,OAAO,IAAI,EAAE,CAAC,CAAC;IAC1C,QAAQ,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACzB,QAAQ,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;IAChC,QAAQ,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;IAClC,QAAQ,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,IAAI,IAAI,CAAC;IACjE,KAAK;;IAEL,IAAI,KAAK,EAAE,SAAS,GAAG,EAAE;IACzB,QAAQ,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IAC3B,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,KAAK,EAAE,SAAS,GAAG,EAAE;IACzB,QAAQ,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;IACxB,QAAQ,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,GAAG,CAAC,aAAa,EAAE;IACvD,YAAY,IAAI,CAAC,cAAc,GAAG,GAAG,CAAC,aAAa,CAAC;IACpD,SAAS;IACT,QAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;IAC5E,QAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IAC/D,QAAQ,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;IACtD,QAAQ,IAAI,CAAC,OAAO,EAAE,CAAC;IACvB,KAAK;;IAEL,IAAI,QAAQ,EAAE,SAAS,GAAG,EAAE;IAC5B,QAAQ,IAAI,CAAC,cAAc,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;IACxD,QAAQ,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;IAC7E,QAAQ,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IAChE,QAAQ,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC;IAC7C,QAAQ,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACzB,KAAK;;IAEL,IAAI,SAAS,EAAE,SAAS,MAAM,EAAE,OAAO,EAAE;IACzC,QAAQ,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;IAC9C,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,SAAS,EAAE,SAAS,MAAM,EAAE;IAChC,QAAQ,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;IACrC,QAAQ,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE;IACvC,YAAY,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;IAC9C,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE;IAChE,YAAY,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;IACjD,SAAS;IACT,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,UAAU,EAAE,SAAS,OAAO,EAAE;IAClC,QAAQ,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,OAAO,CAAC;IACvC,QAAQ,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;IACxC,YAAY,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;IAChD,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,CAAC,UAAU,EAAE;IACjE,YAAY,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;IACnD,SAAS;IACT,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,WAAW,EAAE,WAAW;IAC5B,QAAQ,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;IACjC,YAAY,OAAO;IACnB,SAAS;IACT,QAAQ,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,CAAC;IACzC,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,YAAY,EAAE,WAAW;IAC7B,QAAQ,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;IACjC,YAAY,OAAO;IACnB,SAAS;IACT,QAAQ,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,CAAC;IAC1C,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,iBAAiB,EAAE,SAAS,EAAE,EAAE;IACpC;IACA,QAAQ,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;IAC9B,YAAY,IAAI,EAAE,EAAE,CAAC,IAAI;IACzB,SAAS,CAAC,CAAC;IACX,QAAQ,OAAO;IACf,KAAK;;IAEL,IAAI,OAAO,EAAE,SAAS,IAAI,EAAE;IAC5B;IACA,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,OAAO,EAAE,WAAW;IACxB;IACA,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,YAAY,EAAE,WAAW;IAC7B,QAAQ,OAAO,IAAI,CAAC,UAAU,CAAC;IAC/B,KAAK;;IAEL,IAAI,SAAS,EAAE,WAAW;IAC1B,QAAQ,IAAI,MAAM,GAAG,IAAI,CAAC,CAAC,YAAY,EAAE,CAAC;IAC1C,QAAQ,IAAI,IAAI,CAAC,aAAa,EAAE;IAChC,YAAY,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,CAAC;IAC1H,SAAS;IACT,QAAQ,OAAO,MAAM,CAAC;IACtB,KAAK;;IAEL,CAAC,CAAC,CAAC;;IAEH,CAAC,CAAC,aAAa,CAAC,KAAK,GAAG,SAAS,KAAK,EAAE,OAAO,EAAE;IACjD,IAAI,OAAO,IAAI,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IACrD,CAAC,CAAC;IACF;IACA;IACA;;IAEA,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC;;IAEzD,IAAI,UAAU,EAAE,SAAS,KAAK,EAAE,OAAO,EAAE;IACzC,QAAQ,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;IAC9E,QAAQ,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,IAAI,CAAC,CAAC;IACxF,QAAQ,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,IAAI,CAAC,CAAC;IACtF,QAAQ,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC;IAC/G,QAAQ,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,OAAO,CAAC,qBAAqB,IAAI,EAAE,CAAC;IAC/E,QAAQ,IAAI,CAAC,4BAA4B,GAAG,IAAI,CAAC,OAAO,CAAC,kBAAkB,IAAI,IAAI,CAAC;IACpF,QAAQ,IAAI,CAAC,kCAAkC,GAAG,IAAI,CAAC,OAAO,CAAC,wBAAwB,IAAI,IAAI,CAAC;IAChG,QAAQ,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC;IACjD,QAAQ,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,OAAO,CAAC,mBAAmB,IAAI,KAAK,CAAC;IAC9E,QAAQ,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC,cAAc,IAAI,KAAK,CAAC;IACpE,QAAQ,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,OAAO,CAAC,uBAAuB,IAAI,WAAW,CAAC;IAC5F,QAAQ,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;IAC1B,QAAQ,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;IAC9B,QAAQ,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;IAClC,QAAQ,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;IAC5C,QAAQ,IAAI,IAAI,CAAC,oBAAoB,IAAI,IAAI,CAAC,OAAO,CAAC,2BAA2B,EAAE;IACnF,YAAY,IAAI,CAAC,qCAAqC,EAAE,CAAC;IACzD,SAAS;;IAET,QAAQ,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,WAAW;IAC/C,YAAY,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IAC5C,YAAY,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;IAClC,gBAAgB,IAAI,EAAE,IAAI,CAAC,YAAY;IACvC,aAAa,CAAC,CAAC;IACf,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACvB,KAAK;;IAEL,IAAI,SAAS,EAAE,WAAW;IAC1B,QAAQ,IAAI,UAAU,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;IAC7D,QAAQ,OAAO;IACf,YAAY,OAAO,EAAE,UAAU;IAC/B,YAAY,OAAO,EAAE,UAAU;IAC/B,SAAS;IACT,KAAK;;IAEL,IAAI,SAAS,EAAE,SAAS,MAAM,EAAE,OAAO,EAAE;IACzC,QAAQ,KAAK,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;IACvC,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;IACnD,gBAAgB,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;IACzD,aAAa;IACb,SAAS;IACT,QAAQ,OAAO,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;IACrF,KAAK;;IAEL,IAAI,iBAAiB,EAAE,SAAS,EAAE,EAAE;IACpC;IACA,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;IACnD,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;IACxC,YAAY,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IACtC;IACA,SAAS;IACT,KAAK;;IAEL,IAAI,OAAO,EAAE,SAAS,IAAI,EAAE;IAC5B,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;IAChD,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,IAAI,CAAC,IAAI;IAC5C,YAAY,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;IACpE,gBAAgB,OAAO,IAAI,CAAC;IAC5B,QAAQ,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;IAChC,KAAK;;IAEL,IAAI,KAAK,EAAE,SAAS,GAAG,EAAE;IACzB,QAAQ,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;IAC9D,QAAQ,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,IAAI,CAAC,EAAE;IAC9C,YAAY,IAAI,CAAC,qCAAqC,EAAE,CAAC;IACzD,SAAS,MAAM;IACf,YAAY,IAAI,CAAC,kCAAkC,EAAE,CAAC;IACtD,SAAS;IACT,KAAK;;IAEL,IAAI,OAAO,EAAE,WAAW;IACxB,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI;IACtB,YAAY,OAAO;IACnB,QAAQ,IAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,CAAC;IACxD;IACA;IACA;IACA,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;IAChD,QAAQ,IAAI,IAAI,CAAC,aAAa,IAAI,IAAI,EAAE;IACxC,YAAY,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;IACvC,SAAS;IACT,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;IACxC,YAAY,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IACtC,SAAS,MAAM;IACf,YAAY,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;IACzC,SAAS;IACT,KAAK;;IAEL,IAAI,UAAU,EAAE,SAAS,OAAO,EAAE;IAClC,QAAQ,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IAC1E;IACA,QAAQ,KAAK,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;IACvC,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,UAAU,EAAE;IACpF,gBAAgB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;IACvD,aAAa;IACb,SAAS;IACT,KAAK;;IAEL,IAAI,SAAS,EAAE,SAAS,MAAM,CAAC;IAC/B,QAAQ,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IACzE;IACA,QAAQ,KAAK,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;IACvC,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE;IACnF,gBAAgB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;IACrD,aAAa;IACb,SAAS;IACT,KAAK;;IAEL,IAAI,SAAS,EAAE,SAAS,MAAM,EAAE,QAAQ,EAAE;IAC1C,QAAQ,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;IAClD,QAAQ,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE;IACvC,YAAY,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;IACxD,SAAS;IACT,QAAQ,KAAK,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;IACvC,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE;IACnF,gBAAgB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;IACpD,gBAAgB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;IAC/D,aAAa;IACb,SAAS;IACT,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,gBAAgB,EAAE,WAAW;IACjC,QAAQ,IAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,CAAC;IACxD,QAAQ,KAAK,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;IACvC,YAAY,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;IACnE,gBAAgB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;IACpD,gBAAgB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC;IAC5C,aAAa;IACb,SAAS;IACT,KAAK;;IAEL,IAAI,iBAAiB,EAAE,SAAS,WAAW,EAAE,YAAY,EAAE;IAC3D;IACA,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;IAC3C,QAAQ,IAAI,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;IAChD,QAAQ,IAAI,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;IAC3C,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;IACxB;IACA,QAAQ,IAAI,YAAY,GAAG,CAAC,CAAC,EAAE;IAC/B,YAAY,IAAI,eAAe,GAAG,KAAK,GAAG,YAAY,CAAC;IACvD,YAAY,IAAI,eAAe,GAAG,CAAC,EAAE;IACrC,gBAAgB,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,eAAe,CAAC,CAAC;IAC1D,gBAAgB,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;IAC3C,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,WAAW,GAAG,CAAC,CAAC,EAAE;IAC9B,YAAY,KAAK,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;IAC3C,YAAY,IAAI,eAAe,GAAG,KAAK,CAAC,MAAM,GAAG,KAAK,GAAG,WAAW,GAAG,CAAC,CAAC;IACzE,YAAY,IAAI,eAAe,GAAG,CAAC,EAAE;IACrC,gBAAgB,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,GAAG,WAAW,GAAG,CAAC,EAAE,eAAe,CAAC,CAAC;IAChF,gBAAgB,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;IAC3C,aAAa;IACb,SAAS;IACT,KAAK;IACL,IAAI,UAAU,EAAE,SAAS,KAAK,EAAE,IAAI,EAAE;IACtC,QAAQ,IAAI,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,KAAK,KAAK,EAAE;IAChE,YAAY,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC;IACtC,SAAS;IACT,QAAQ,KAAK,CAAC,IAAI,EAAE,CAAC;IACrB,QAAQ,IAAI,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,KAAK,KAAK,EAAE;IAChE,YAAY,OAAO;IACnB,SAAS;IACT,QAAQ,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;IACnC,QAAQ,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;IACjC;;IAEA,QAAQ,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC;IAChF,KAAK;;IAEL,IAAI,gBAAgB,EAAE,SAAS,IAAI,EAAE;IACrC,QAAQ,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,IAAI,IAAI,EAAE;IACpE,YAAY,OAAO,IAAI,CAAC,UAAU,CAAC;IACnC,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;IAC/C,YAAY,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IACtC,SAAS;IACT,QAAQ,IAAI,WAAW,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IACrD,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,WAAW,CAAC,EAAE;IACtD,YAAY,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;IAC7C,SAAS;;IAET,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,mBAAmB,CAAC,WAAW,CAAC,CAAC;;IAE7D,QAAQ,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC;;IAEtC,QAAQ,QAAQ,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,SAAS,KAAK,EAAE,IAAI,EAAE;IACnD,YAAY,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IAClC;IACA;IACA,YAAY,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;IACrC,gBAAgB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC;IAC3C,aAAa;IACb,YAAY,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,IAAI,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE,EAAE;IACzH,gBAAgB,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;IAC7C,aAAa;IACb;IACA,YAAY,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;IAClC,gBAAgB,IAAI,EAAE,IAAI;IAC1B,aAAa,CAAC,CAAC;IACf,SAAS,EAAE,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAC;;IAEvC;IACA;IACA,QAAQ,QAAQ,CAAC,KAAK,GAAG,CAAC,SAAS,GAAG,EAAE;IACxC,YAAY,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;IAC9D,YAAY,IAAI,CAAC,IAAI,EAAE,CAAC;IACxB,SAAS,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC1B,QAAQ,OAAO,QAAQ,CAAC;IACxB,KAAK;;IAEL,IAAI,mBAAmB,CAAC,SAAS,IAAI,CAAC;IACtC,QAAQ,IAAI,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC;IAChD,QAAQ,SAAS,CAAC,IAAI,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,WAAW,EAAE,CAAC;IACtD,QAAQ,OAAO,IAAI,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,EAAE,SAAS,CAAC,CAAC;IACpF,KAAK;;IAEL,IAAI,eAAe,EAAE,WAAW;IAChC,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;IACxB,QAAQ,KAAK,IAAI,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;IACvC,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;IACnD,gBAAgB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAClC,aAAa;IACb,SAAS;IACT,QAAQ,OAAO,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE;IAC1C,YAAY,OAAO,CAAC,GAAG,CAAC,CAAC;IACzB,SAAS,CAAC,CAAC;IACX,KAAK;;IAEL,IAAI,aAAa,EAAE,SAAS,KAAK,EAAE;IACnC,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;IACtD,YAAY,IAAI,IAAI,CAAC,IAAI;IACzB,gBAAgB,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9D,YAAY,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1C,SAAS;IACT,KAAK;;IAEL,IAAI,sBAAsB,EAAE,SAAS,KAAK,EAAE;IAC5C,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,iBAAiB,EAAE;IAC5C,YAAY,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IAC3C,SAAS;IACT,KAAK;;IAEL,IAAI,qCAAqC,EAAE,WAAW;IACtD,QAAQ,IAAI,IAAI,CAAC,sBAAsB,EAAE;IACzC,YAAY,OAAO;IACnB,SAAS;IACT,QAAQ,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;IAC3C,QAAQ,IAAI,GAAG,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAC;IAC7C,QAAQ,IAAI,IAAI,CAAC,MAAM,EAAE;IACzB,YAAY,GAAG,GAAG,IAAI,CAAC,MAAM,GAAG,OAAO,GAAG,kBAAkB,CAAC,GAAG,CAAC,CAAC;IAClE,SAAS;IACT,QAAQ,IAAI,IAAI,GAAG,IAAI,cAAc,EAAE,CAAC;IACxC,QAAQ,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,CAAC,SAAS,GAAG,EAAE;IACrD,YAAY,IAAI,IAAI,GAAG,GAAG,CAAC,aAAa,CAAC,WAAW,CAAC;IACrD,YAAY,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,+BAA+B,CAAC,IAAI,CAAC,CAAC,CAAC;IACvF,YAAY,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,KAAK,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC;IACxI,YAAY,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,mCAAmC,CAAC,IAAI,CAAC,CAAC,CAAC;IACnF,YAAY,IAAI,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,cAAc,EAAE;IAC7D,gBAAgB,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;IACtE,aAAa;IACb,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACvB,QAAQ,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,CAAC;IACjD,QAAQ,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;IAC9B,QAAQ,IAAI,CAAC,IAAI,EAAE,CAAC;IACpB,KAAK;;IAEL,IAAI,mBAAmB,EAAE,WAAW;IACpC,QAAQ,IAAI,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC;IAC3C,QAAQ,IAAI,IAAI,CAAC,4BAA4B;IAC7C,YAAY,GAAG,GAAG,IAAI,CAAC,4BAA4B,CAAC;IACpD,QAAQ,IAAI,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,sBAAsB,EAAE;IAC/D,UAAU,SAAS,EAAE,iBAAiB;IACtC,UAAU,SAAS,EAAE,KAAK;IAC1B,UAAU,SAAS,EAAE,IAAI,CAAC,WAAW;IACrC,SAAS,CAAC,CAAC;IACX,QAAQ,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE,MAAM,CAAC,SAAS,CAAC,CAAC;IACzE,QAAQ,OAAO,GAAG,CAAC;IACnB,KAAK;;IAEL,IAAI,mCAAmC,EAAE,SAAS,GAAG,EAAE;IACvD,QAAQ,IAAI,MAAM,GAAG,GAAG,CAAC,gBAAgB,CAAC,sBAAsB,CAAC,CAAC;IAClE,QAAQ,IAAI,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC;IACzD,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;IACzB,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;;IAEzB,QAAQ,MAAM,CAAC,OAAO,CAAC,SAAS,OAAO,EAAE;IACzC,YAAY,IAAI,OAAO,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,SAAS,KAAK,SAAS,EAAE;IACvE,gBAAgB,KAAK,GAAG,OAAO,CAAC;IAChC,aAAa;IACb,SAAS,EAAC;IACV,QAAQ,IAAI,KAAK,EAAE;IACnB,YAAY,KAAK,GAAG,IAAI,CAAC,8BAA8B,CAAC,KAAK,CAAC,CAAC;IAC/D,YAAY,IAAI,CAAC,KAAK,EAAE;IACxB,gBAAgB,KAAK,GAAG,IAAI,CAAC,8BAA8B,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;IAC9E,aAAa;IACb,SAAS;;IAET,QAAQ,OAAO,KAAK,CAAC;IACrB,KAAK;;IAEL,IAAI,8BAA8B,EAAE,SAAS,KAAK,EAAE;IACpD,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;IACzB,QAAQ,IAAI,UAAU,GAAG,KAAK,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,CAAC;IAC1E,QAAQ,IAAI,UAAU,IAAI,UAAU,CAAC,MAAM,IAAI,UAAU,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,MAAM,EAAE;IACjF,YAAY,KAAK,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;IACrD,SAAS,MAAM;IACf,YAAY,IAAI,OAAO,GAAG,KAAK,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,CAAC;IACxE,YAAY,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,MAAM,EAAE;IAC5E,gBAAgB,KAAK,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;IACtD,aAAa;IACb,SAAS;IACT,QAAQ,OAAO,KAAK,CAAC;IACrB,KAAK;;IAEL,IAAI,+BAA+B,EAAE,SAAS,GAAG,EAAE;IACnD,QAAQ,IAAI,MAAM,GAAG,GAAG,CAAC,gBAAgB,CAAC,sBAAsB,CAAC,CAAC;IAClE,QAAQ,IAAI,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC;IACzD,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;AACzB,AACA;IACA,QAAQ,MAAM,CAAC,OAAO,CAAC,SAAS,OAAO,EAAE;IACzC,YAAY,IAAI,OAAO,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,SAAS,KAAK,SAAS,EAAE;IACvE,gBAAgB,KAAK,GAAG,OAAO,CAAC;IAChC,aAAa;IACb,SAAS,EAAC;;IAEV,QAAQ,IAAI,WAAW,GAAG,CAAC,CAAC;IAC5B,QAAQ,IAAI,KAAK,EAAE;IACnB,YAAY,WAAW,GAAG,IAAI,CAAC,oCAAoC,CAAC,KAAK,CAAC,CAAC;IAC3E,YAAY,IAAI,WAAW,IAAI,CAAC,EAAE;IAClC,gBAAgB,WAAW,GAAG,IAAI,CAAC,oCAAoC,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;IAC1F,aAAa;IACb,SAAS;IACT,QAAQ,OAAO,WAAW,CAAC;IAC3B,KAAK;;IAEL,IAAI,oCAAoC,EAAE,SAAS,KAAK,EAAE;IAC1D,QAAQ,IAAI,WAAW,GAAG,CAAC,CAAC;IAC5B,QAAQ,IAAI,UAAU,GAAG,KAAK,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,CAAC;IAC1E,QAAQ,IAAI,UAAU,IAAI,UAAU,CAAC,MAAM,IAAI,UAAU,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,OAAO,EAAE;IACjF,YAAY,WAAW,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC;IAC3D,SAAS,MAAM;IACf,YAAY,IAAI,OAAO,GAAG,KAAK,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,CAAC;IACxE,YAAY,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,OAAO,EAAE;IAC5E,gBAAgB,WAAW,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC;IAC5D,aAAa;IACb,SAAS;IACT,QAAQ,OAAO,WAAW,CAAC;IAC3B,KAAK;;IAEL,IAAI,iBAAiB,EAAE,SAAS,KAAK,EAAE;IACvC,QAAQ,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;IAChF,QAAQ,IAAI,CAAC,kCAAkC,EAAE,CAAC;IAClD,KAAK;;IAEL,IAAI,kCAAkC,EAAE,WAAW;IACnD,QAAQ,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,oBAAoB;IAC7D,aAAa,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,MAAM,IAAI,CAAC,CAAC,EAAE;IAC1F,YAAY,IAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,wBAAwB,CAAC,CAAC;IACvG,YAAY,IAAI,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,YAAY,GAAG,CAAC,EAAE;IAC/D,gBAAgB,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;IACtE,aAAa;IACb,SAAS;IACT,KAAK;;IAEL,IAAI,eAAe,EAAE,SAAS,IAAI,EAAE;IACpC,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;IAC/C,YAAY,OAAO,IAAI,CAAC;IACxB,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,eAAe,CAAC,MAAM,IAAI,CAAC,EAAE;IAC9C,YAAY,OAAO,IAAI,CAAC;IACxB,SAAS;IACT,QAAQ,IAAI,KAAK,GAAG,CAAC,CAAC;IACtB,QAAQ,IAAI,GAAG,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;IAC9C,QAAQ,OAAO,KAAK,GAAG,GAAG,EAAE,KAAK,EAAE,EAAE;IACrC,YAAY,IAAI,IAAI,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,EAAE;IACpD,gBAAgB,MAAM;IACtB,aAAa;IACb,SAAS;IACT;IACA,QAAQ,IAAI,KAAK,GAAG,CAAC,EAAE;IACvB,YAAY,KAAK,EAAE,CAAC;IACpB,SAAS;IACT,QAAQ,IAAI,IAAI,IAAI,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,EAAE;IACjD;IACA;IACA,SAAS;IACT,QAAQ,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;IAC3C,KAAK;;IAEL,CAAC,CAAC,CAAC;;IAEH,IAAI,CAAC,CAAC,CAAC,aAAa,EAAE;IACtB,IAAI,CAAC,CAAC,aAAa,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,KAAK,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;IACtD,CAAC;;IAED,CAAC,CAAC,aAAa,CAAC,OAAO,CAAC;IACxB,IAAI,QAAQ,EAAE,IAAI;IAClB,IAAI,OAAO,EAAE,KAAK;;IAElB,IAAI,eAAe,EAAE,CAAC,CAAC,aAAa,CAAC,SAAS,CAAC,OAAO;IACtD,IAAI,iBAAiB,EAAE,CAAC,CAAC,aAAa,CAAC,SAAS,CAAC,QAAQ;;IAEzD,IAAI,OAAO,EAAE,WAAW;IACxB,QAAQ,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,OAAO,EAAE;IAC5C,YAAY,OAAO;IACnB,SAAS;IACT,QAAQ,IAAI,CAAC,eAAe,EAAE,CAAC;IAC/B,KAAK;;IAEL,IAAI,QAAQ,EAAE,SAAS,GAAG,EAAE;IAC5B,QAAQ,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;IAC7B,QAAQ,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;IACpC,KAAK;;IAEL,IAAI,SAAS,EAAE,SAAS,MAAM,EAAE;IAChC,QAAQ,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;IAC9B,KAAK;;IAEL,IAAI,QAAQ,EAAE,WAAW;IACzB,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC;IAC5B,KAAK;;IAEL,IAAI,IAAI,EAAE,WAAW;IACrB,QAAQ,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;IAC9B,QAAQ,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;IACzC,KAAK;;IAEL,IAAI,IAAI,EAAE,WAAW;IACrB,QAAQ,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;IAC7B,QAAQ,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;IAC1C,KAAK;;IAEL,IAAI,MAAM,EAAE,WAAW;IACvB,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC;IAC5B,KAAK;;IAEL,CAAC,CAAC,CAAC;;IAEH,CAAC,CAAC,SAAS,CAAC,OAAO,CAAC;IACpB,IAAI,QAAQ,EAAE,IAAI;IAClB,IAAI,OAAO,EAAE,KAAK;;IAElB,IAAI,eAAe,EAAE,CAAC,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO;;IAElD,IAAI,OAAO,EAAE,WAAW;IACxB,QAAQ,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,OAAO,EAAE;IAC5C,YAAY,OAAO;IACnB,SAAS;IACT,QAAQ,IAAI,CAAC,eAAe,EAAE,CAAC;IAC/B,KAAK;;IAEL,IAAI,SAAS,EAAE,SAAS,MAAM,EAAE;IAChC,QAAQ,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;IAC9B,KAAK;;IAEL,IAAI,QAAQ,EAAE,WAAW;IACzB,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC;IAC5B,KAAK;;IAEL,IAAI,IAAI,EAAE,WAAW;IACrB,QAAQ,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;IAC9B,QAAQ,IAAI,IAAI,CAAC,UAAU,EAAE;IAC7B,YAAY,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;IACnD,SAAS;IACT,KAAK;;IAEL,IAAI,IAAI,EAAE,WAAW;IACrB,QAAQ,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;IAC7B,QAAQ,IAAI,IAAI,CAAC,UAAU,EAAE;IAC7B,YAAY,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;IACpD,SAAS;IACT,KAAK;;IAEL,IAAI,MAAM,EAAE,WAAW;IACvB,QAAQ,OAAO,IAAI,CAAC,IAAI,CAAC;IACzB,KAAK;;IAEL,CAAC,CAAC,CAAC;;IAEH,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,GAAG,SAAS,KAAK,EAAE,OAAO,EAAE;IACrD,IAAI,OAAO,IAAI,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IACzD,CAAC,CAAC;;IAEF;IACA;IACA;;IAEA,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,OAAO,GAAG,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC;;IAE7D,IAAI,UAAU,EAAE,SAAS,KAAK,EAAE,OAAO,EAAE;IACzC,QAAQ,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;IAC9E,QAAQ,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,OAAO,CAAC,mBAAmB,IAAI,KAAK,CAAC;IAC9E,QAAQ,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,OAAO,CAAC,uBAAuB,IAAI,UAAU,CAAC;IAC3F,QAAQ,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,IAAI,IAAI,CAAC;IACvD,QAAQ,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,IAAI,KAAK,CAAC;IAChE,QAAQ,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,IAAI,KAAK,CAAC;IAChE,QAAQ,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;IAC9B,QAAQ,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;IAClC,QAAQ,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;IAC7B,QAAQ,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE,CAAC,MAAM,IAAI,CAAC,EAAE;IACrD,YAAY,IAAI,IAAI,CAAC,aAAa,CAAC;IACnC,gBAAgB,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;IAC1E,aAAa,IAAI;IACjB,gBAAgB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;IACpC,aAAa;IACb,SAAS,MAAM;IACf,YAAY,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;IAChC,YAAY,IAAI,CAAC,kBAAkB,EAAE,CAAC;IACtC,SAAS;IACT;IACA,QAAQ,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,EAAE,CAAC,YAAY;IACpD,YAAY,IAAI,IAAI,CAAC,OAAO,EAAE;IAC9B,gBAAgB,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC1C,aAAa;IACb,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACvB,KAAK;;IAEL,IAAI,KAAK,EAAE,SAAS,GAAG,EAAE;IACzB,QAAQ,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;IAC9D,QAAQ,IAAI,IAAI,CAAC,OAAO,EAAE;IAC1B,YAAY,IAAI,CAAC,kBAAkB,EAAE,CAAC;IACtC,SAAS;IACT,KAAK;;IAEL,IAAI,SAAS,EAAE,SAAS,MAAM,EAAE,OAAO,EAAE;IACzC,QAAQ,IAAI,IAAI,CAAC,aAAa,EAAE;IAChC,YAAY,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;IACrD,SAAS;IACT,QAAQ,OAAO,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;IACrF,KAAK;;IAEL,IAAI,OAAO,EAAE,SAAS,IAAI,EAAE;IAC5B,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC;IAC5B,KAAK;;IAEL,IAAI,OAAO,EAAE,WAAW;IACxB,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI;IACtB,YAAY,OAAO;IACnB,QAAQ,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;IAC3B,YAAY,OAAO;IACnB,SAAS;;IAET,QAAQ,IAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,CAAC;;IAExD,QAAQ,IAAI,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE;IAC1D,YAAY,OAAO,GAAG,CAAC,CAAC;IACxB,QAAQ,IAAI,IAAI,CAAC,SAAS,EAAE;IAC5B,YAAY,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC;IACzC,YAAY,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;IAClF,YAAY,OAAO,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;IACrC,SAAS;;IAET;IACA,QAAQ,IAAI,KAAK,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;IAC7D,QAAQ,IAAI,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE,CAAC;IACjD,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;IACvD,YAAY,IAAI,OAAO,GAAG,IAAI,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;IAC5F,YAAY,IAAI,OAAO,EAAE;IACzB,gBAAgB,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;IACvC,gBAAgB,IAAI,IAAI,CAAC,aAAa,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,IAAI,YAAY,EAAE;IACjF,oBAAoB,IAAI,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;IACjE,wBAAwB,IAAI,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC;IAC5D,wBAAwB,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC;IAC/C,wBAAwB,KAAK,CAAC,OAAO,CAAC;IACtC,4BAA4B,IAAI,EAAE,SAAS;IAC3C,4BAA4B,UAAU,EAAE,UAAU;IAClD,4BAA4B,QAAQ,EAAE;IACtC,gCAAgC,IAAI,EAAE,OAAO;IAC7C,gCAAgC,WAAW,EAAE,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC;IAClH,6BAA6B;IAC7B,yBAAyB,CAAC,CAAC;IAC3B,qBAAqB;IACrB,iBAAiB;IACjB,aAAa;IACb,SAAS;;IAET,QAAQ,IAAI,IAAI,CAAC,aAAa,EAAE;IAChC,YAAY,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IACtD,SAAS;IACT,QAAQ,IAAI,KAAK,CAAC,SAAS,EAAE,CAAC,MAAM,EAAE;IACtC,YAAY,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACnC,YAAY,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;IACvC,SAAS;IACT,KAAK;;IAEL,IAAI,kBAAkB,EAAE,WAAW;IACnC,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC;IACvB,QAAQ,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;IAClC,QAAQ,IAAI,MAAM,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE,CAAC;IACjD,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;IACvD,YAAY,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE;IACnC,gBAAgB,KAAK,GAAG,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,YAAY;IACzD,oBAAoB,KAAK;IACzB,oBAAoB,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;IAC5D,iBAAiB,CAAC;IAClB,aAAa;IACb,SAAS;IACT;IACA,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;IACtD,YAAY,IAAI,IAAI,GAAG,KAAK,CAAC,CAAC,EAAC;IAC/B,YAAY,IAAI,OAAO,IAAI,IAAI,QAAQ,IAAI,IAAI,YAAY,MAAM,EAAE;IACnE,gBAAgB,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;IAC/C,aAAa;IACb,YAAY,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC5C,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,cAAc,KAAK,IAAI,CAAC,oBAAoB,IAAI,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,MAAM,IAAI,CAAC,CAAC,EAAE;IACvH,YAAY,IAAI,CAAC,cAAc,CAAC,iBAAiB,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,wBAAwB,CAAC,CAAC;IACvG,SAAS;IACT,KAAK;;IAEL,IAAI,gBAAgB,EAAE,SAAS,OAAO,EAAE;IACxC,QAAQ,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE;IACjC,YAAY,OAAO,EAAE,CAAC;IACtB,SAAS;IACT,QAAQ,IAAI,OAAO,CAAC,UAAU,CAAC,cAAc,CAAC,YAAY,CAAC,EAAE;IAC7D,YAAY,OAAO,OAAO,CAAC,UAAU,CAAC,UAAU,CAAC;IACjD,SAAS;IACT,QAAQ,IAAI,OAAO,CAAC,UAAU,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;IACxD,YAAY,OAAO,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC;IAC5C,SAAS;IACT,QAAQ,IAAI,OAAO,CAAC,UAAU,CAAC,cAAc,CAAC,sBAAsB,CAAC,EAAE;IACvE,YAAY,OAAO,OAAO,CAAC,UAAU,CAAC,oBAAoB,CAAC;IAC3D,SAAS;IACT,QAAQ,IAAI,OAAO,CAAC,UAAU,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;IACvD,YAAY,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;IAC7C,SAAS;IACT,QAAQ,OAAO,EAAE,CAAC;IAClB,KAAK;;IAEL,IAAI,uBAAuB,EAAE,SAAS,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;IACjE,QAAQ,IAAI,kBAAkB,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;IAChE,QAAQ,IAAI,kBAAkB,CAAC,MAAM,IAAI,CAAC,EAAE;IAC5C,YAAY,OAAO,OAAO,CAAC;IAC3B,SAAS;IACT,QAAQ,IAAI,YAAY,GAAG,EAAE,CAAC;IAC9B,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,kBAAkB,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;IACnE,YAAY,IAAI,IAAI,GAAG,kBAAkB,CAAC,CAAC,EAAC;IAC5C,YAAY,IAAI,OAAO,IAAI,IAAI,QAAQ,IAAI,IAAI,YAAY,MAAM,EAAE;IACnE,gBAAgB,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;IAC/C,aAAa;IACb,YAAY,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACpC,SAAS;;IAET,QAAQ,IAAI,YAAY,CAAC,CAAC,CAAC,GAAG,OAAO,IAAI,YAAY,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,OAAO,EAAE;IACxE,YAAY,OAAO,IAAI,CAAC;IACxB,SAAS;IACT,QAAQ,IAAI,SAAS,GAAG,IAAI;IAC5B,YAAY,SAAS,GAAG,IAAI;IAC5B,YAAY,CAAC,GAAG,YAAY,CAAC,MAAM,CAAC;IACpC,QAAQ,IAAI,YAAY,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,OAAO,EAAE;IAC3C,YAAY,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;IACxC,gBAAgB,IAAI,SAAS,KAAK,IAAI,IAAI,YAAY,CAAC,CAAC,CAAC,GAAG,OAAO,EAAE;IACrE;IACA,oBAAoB,SAAS,GAAG,CAAC,CAAC;IAClC,iBAAiB;IACjB,gBAAgB,IAAI,YAAY,CAAC,CAAC,CAAC,GAAG,OAAO,EAAE;IAC/C,oBAAoB,SAAS,GAAG,CAAC,CAAC;IAClC,oBAAoB,MAAM;IAC1B,iBAAiB;IACjB,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,SAAS,KAAK,IAAI,EAAE;IAChC,YAAY,SAAS,GAAG,CAAC,CAAC;IAC1B,SAAS;IACT,QAAQ,IAAI,SAAS,KAAK,IAAI,EAAE;IAChC,YAAY,SAAS,GAAG,CAAC,CAAC;IAC1B,SAAS;IACT,QAAQ,IAAI,eAAe,GAAG,EAAE,CAAC;IACjC,QAAQ,IAAI,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE;IACpD,YAAY,eAAe,GAAG,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC,KAAK,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;IACvF,SAAS,MAAM;IACf,YAAY,eAAe,GAAG,OAAO,CAAC,QAAQ,CAAC,WAAW,CAAC;IAC3D,SAAS;IACT,QAAQ,OAAO;IACf,YAAY,IAAI,EAAE,SAAS;IAC3B,YAAY,UAAU,EAAE,OAAO,CAAC,UAAU;IAC1C,YAAY,QAAQ,EAAE;IACtB,gBAAgB,IAAI,EAAE,OAAO,CAAC,QAAQ,CAAC,IAAI;IAC3C,gBAAgB,WAAW,EAAE,eAAe;IAC5C,aAAa;IACb,SAAS,CAAC;IACV,KAAK;;IAEL,IAAI,iBAAiB,EAAE,WAAW;IAClC,QAAQ,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;IAC5B,QAAQ,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAClC,QAAQ,IAAI,CAAC,OAAO,EAAE,CAAC;IACvB,KAAK;;IAEL,CAAC,CAAC,CAAC;;IAEH,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,OAAO,GAAG,SAAS,KAAK,EAAE,OAAO,EAAE;IACzD,IAAI,OAAO,IAAI,CAAC,CAAC,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;IAC7D,CAAC,CAAC;;IAEF;IACA;;;IAGA;IACA;IACA;IACA;IACA,CAAC,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,KAAK,EAAE,MAAM,CAAC;;IAErD,IAAI,QAAQ,GAAG,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC;IAC3C,IAAI,UAAU,EAAE,SAAS,OAAO,EAAE,aAAa,EAAE;IACjD,QAAQ,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;IACpC,QAAQ,IAAI,CAAC,cAAc,GAAG,aAAa,CAAC;IAC5C,QAAQ,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;IAC7B,QAAQ,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,CAAC,CAAC;IAChD,QAAQ,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC,cAAc,IAAI,CAAC,CAAC;IAChE,QAAQ,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACvC,QAAQ,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,KAAK,CAAC;IAChD,QAAQ,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;IACxB,QAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,UAAU,EAAE,CAAC,SAAS,IAAI,EAAE;IAC3D,YAAY,IAAI,CAAC,OAAO,EAAE,CAAC;IAC3B,YAAY,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IAC3C,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACvB,QAAQ,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,CAAC,cAAc,IAAI,IAAI,CAAC,CAAC;IACpE;IACA,QAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,8CAA8C,EAAE,CAAC,SAAS,IAAI,EAAE;IAC/F,YAAY,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAChG,SAAS,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACvB,KAAK;;;IAGL,IAAI,KAAK,EAAE,WAAW;IACtB,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;IAC3C,QAAQ,IAAI,UAAU,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,mBAAmB,EAAE,IAAI,QAAQ,MAAM,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IACtG,QAAQ,IAAI,WAAW,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,mBAAmB,EAAE,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAChG,QAAQ,IAAI,UAAU,IAAI,WAAW,EAAE;IACvC;IACA,YAAY,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;IAC7B,gBAAgB,IAAI,CAAC,KAAK,EAAE,CAAC;IAC7B,gBAAgB,IAAI,CAAC,IAAI,EAAE,CAAC;IAC5B,gBAAgB,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;IAC/C,gBAAgB,OAAO;IACvB,aAAa;IACb,SAAS;;IAET,QAAQ,IAAI,IAAI,CAAC,OAAO,EAAE;IAC1B,YAAY,OAAO;IACnB,SAAS;IACT,QAAQ,IAAI,oBAAoB,GAAG,CAAC;IACpC,YAAY,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC;;IAEtC,QAAQ,IAAI,IAAI,CAAC,eAAe,GAAG,CAAC,EAAE;IACtC,YAAY,oBAAoB,GAAG,IAAI,CAAC,cAAc,CAAC,uBAAuB,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAChH;IACA,YAAY,IAAI,IAAI,CAAC,iBAAiB,EAAE;IACxC,gBAAgB,IAAI,oBAAoB,GAAG,MAAM,EAAE;IACnD;IACA,oBAAoB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;IACzC,wBAAwB,MAAM,EAAE,MAAM;IACtC,wBAAwB,SAAS,EAAE,oBAAoB;IACvD,qBAAqB,CAAC,CAAC;IACvB,oBAAoB,OAAO;IAC3B,iBAAiB,MAAM;IACvB;IACA;IACA,oBAAoB,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACzC,oBAAoB,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACnD,iBAAiB;IACjB,aAAa,MAAM;IACnB;IACA,gBAAgB,IAAI,oBAAoB,GAAG,IAAI,CAAC,eAAe,EAAE;IACjE;IACA,oBAAoB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;IAClD,oBAAoB,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAC1F,oBAAoB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;IACzC,wBAAwB,MAAM,EAAE,MAAM;IACtC,wBAAwB,SAAS,EAAE,oBAAoB;IACvD,qBAAqB,CAAC,CAAC;IACvB,oBAAoB,OAAO;IAC3B,iBAAiB;IACjB,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,CAAC,KAAK,EAAE,CAAC;IACrB,QAAQ,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAC9D,QAAQ,IAAI,MAAM,GAAG,CAAC,EAAE;IACxB,YAAY,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAClF,SAAS;IACT,KAAK;IACL;IACA,IAAI,YAAY,EAAE,UAAU;IAC5B,OAAO,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,MAAM,GAAG,CAAC;IACzE,uBAAuB,IAAI,CAAC,cAAc,CAAC,kBAAkB,EAAE,IAAI,QAAQ,CAAC,CAAC;IAC7E,KAAK;;IAEL,IAAI,KAAK,EAAE,SAAS,QAAQ,EAAE;IAC9B,QAAQ,IAAI,IAAI,CAAC,WAAW,EAAE,OAAO;IACrC,QAAQ,IAAI,CAAC,MAAM,GAAG,QAAQ,IAAI,CAAC,CAAC;IACpC,QAAQ,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACvC,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;IACnC,YAAY,IAAI,IAAI,CAAC,cAAc,CAAC,mBAAmB,EAAE,KAAK,IAAI,CAAC,YAAY,EAAE,CAAC;IAClF,iBAAiB,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,IAAI,CAAC,cAAc,CAAC,kBAAkB,EAAE,IAAI,CAAC,CAAC,CAAC;IACxG,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,CAAC,OAAO,EAAE,CAAC;IACvB,QAAQ,IAAI,CAAC,WAAW,GAAG,MAAM,CAAC,WAAW;IAC7C,YAAY,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC;IACpC,YAAY,IAAI,CAAC,eAAe,CAAC,CAAC;IAClC,QAAQ,IAAI,CAAC,KAAK,EAAE,CAAC;IACrB,QAAQ,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC1B,QAAQ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IAC7B,KAAK;;IAEL,IAAI,IAAI,EAAE,WAAW;IACrB,QAAQ,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO;IACtC,QAAQ,aAAa,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IACxC,QAAQ,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;IAChC,QAAQ,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACvC,QAAQ,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC1B,KAAK;;IAEL,IAAI,KAAK,EAAE,WAAW;IACtB,QAAQ,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;IAC5B,KAAK;;IAEL,IAAI,OAAO,EAAE,YAAY;IACzB,QAAQ,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;IAC7B,KAAK;;IAEL,IAAI,iBAAiB,EAAE,WAAW;IAClC,QAAQ,OAAO,IAAI,CAAC,eAAe,CAAC;IACpC,KAAK;;IAEL,IAAI,SAAS,EAAE,WAAW;IAC1B,QAAQ,OAAO,IAAI,CAAC,WAAW,GAAG,IAAI,GAAG,KAAK,CAAC;IAC/C,KAAK;;IAEL,IAAI,SAAS,EAAE,WAAW;IAC1B,QAAQ,OAAO,IAAI,CAAC,iBAAiB,CAAC;IACtC,KAAK;IACL,IAAI,QAAQ,EAAE,WAAW;IACzB,QAAQ,OAAO,IAAI,CAAC,KAAK,CAAC;IAC1B,KAAK;;IAEL,IAAI,SAAS,EAAE,SAAS,MAAM,EAAE;IAChC,QAAQ,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC;IAC5B,QAAQ,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;IAChC,YAAY,IAAI,EAAE,MAAM;IACxB,SAAS,CAAC,CAAC;IACX,KAAK;;IAEL,IAAI,iBAAiB,EAAE,SAAS,cAAc,EAAE;IAChD,QAAQ,IAAI,CAAC,eAAe,GAAG,cAAc,CAAC;IAC9C,QAAQ,IAAI,OAAO,IAAI,CAAC,OAAO,KAAK,UAAU,EAAE;IAChD,YAAY,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IAC/G;IACA,SAAS,MAAM;IACf,YAAY,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC;IAC5C,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,WAAW,EAAE;IAC9B,YAAY,IAAI,CAAC,IAAI,EAAE,CAAC;IACxB,YAAY,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACpC,SAAS;IACT,QAAQ,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;IACjC,YAAY,cAAc,EAAE,cAAc;IAC1C,YAAY,MAAM,EAAE,IAAI,CAAC,WAAW;IACpC,SAAS,CAAC,CAAC;IACX,KAAK;;IAEL,IAAI,QAAQ,EAAE,WAAW;IACzB,QAAQ,OAAO,IAAI,CAAC,MAAM,CAAC;IAC3B,KAAK;IACL,CAAC,CAAC,CAAC;;IAEH;IACA;;IAEA;IACA;IACA;;IAEA,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC;IACzB,CAAC,CAAC,EAAE,CAAC,IAAI,GAAG,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC;IAC/B,IAAI,OAAO,EAAE;IACb,QAAQ,SAAS,EAAE,MAAM;IACzB,QAAQ,IAAI,EAAE,CAAC;IACf,QAAQ,QAAQ,EAAE,CAAC;IACnB,QAAQ,QAAQ,EAAE,EAAE;IACpB;IACA;IACA,KAAK;IACL,IAAI,UAAU,EAAE,SAAS,MAAM,EAAE,OAAO,EAAE;IAC1C,QAAQ,CAAC,CAAC,UAAU,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;IACpC,QAAQ,IAAI,CAAC,QAAQ,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,SAAS,IAAI,MAAM,EAAE,MAAM,CAAC,CAAC;IAC1F,QAAQ,CAAC,CAAC,SAAS,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;IAClF,QAAQ,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;IACjC,QAAQ,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,WAAW;IACtC,YAAY,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC;IAC/B,YAAY,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IAC3D,SAAS,EAAE,IAAI,CAAC,CAAC;IACjB,QAAQ,IAAI,CAAC,EAAE,CAAC,WAAW,EAAE,WAAW;IACxC,YAAY,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;IACnD,SAAS,CAAC,CAAC;IACX,QAAQ,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,WAAW;IACtC,YAAY,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;IACtD,SAAS,CAAC,CAAC;IACX,QAAQ,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,UAAU,EAAE,SAAS,CAAC,EAAE;IAC7D,YAAY,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;IACrC,SAAS,EAAE,IAAI,CAAC,CAAC;IACjB,QAAQ,CAAC,CAAC,QAAQ,CAAC,uBAAuB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC1D,QAAQ,IAAI,CAAC,MAAM,EAAE,CAAC;IACtB,KAAK;;IAEL,IAAI,kBAAkB,EAAE,WAAW;IACnC,QAAQ,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,KAAK,IAAI,CAAC,UAAU,CAAC,WAAW,IAAI,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IAC9H,KAAK;IACL,IAAI,OAAO,EAAE,WAAW;IACxB,QAAQ,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IACjE,KAAK;IACL,IAAI,QAAQ,EAAE,SAAS,CAAC,EAAE;IAC1B,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;IAC3D,QAAQ,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;IACnD,KAAK;;IAEL,IAAI,YAAY,EAAE,SAAS,KAAK,EAAE;IAClC,QAAQ,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC;IAClF,QAAQ,KAAK,GAAG,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;;IAE9C;IACA,QAAQ,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;IAC1E,QAAQ,KAAK,GAAG,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;IAC9C,QAAQ,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC;;IAE9C,QAAQ,OAAO,KAAK,CAAC;IACrB,KAAK;;IAEL,IAAI,IAAI,EAAE,SAAS,KAAK,EAAE;IAC1B,QAAQ,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,IAAI,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC5E;IACA,QAAQ,OAAO,CAAC,CAAC;IACjB,KAAK;;IAEL,IAAI,QAAQ,EAAE,SAAS,CAAC,EAAE;IAC1B,QAAQ,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,kBAAkB,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;IACtE;IACA,QAAQ,OAAO,CAAC,CAAC;IACjB,KAAK;;IAEL,IAAI,WAAW,EAAE,WAAW;IAC5B,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;IAC9D,KAAK;IACL,IAAI,WAAW,EAAE,WAAW;IAC5B,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC;IAC9D,KAAK;;IAEL,IAAI,OAAO,EAAE,SAAS,IAAI,EAAE;IAC5B,QAAQ,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;IACjC,QAAQ,IAAI,CAAC,OAAO,EAAE,CAAC;IACvB,KAAK;;IAEL,IAAI,WAAW,EAAE,SAAS,CAAC,EAAE;IAC7B,QAAQ,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ;IAC3C,YAAY,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAC1C,QAAQ,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;IACrC,KAAK;IACL,IAAI,WAAW,EAAE,WAAW;IAC5B,QAAQ,OAAO,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;IACtD,KAAK;;IAEL,IAAI,QAAQ,EAAE,SAAS,CAAC,EAAE;IAC1B;IACA,QAAQ,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;IACvC,KAAK;;IAEL,IAAI,QAAQ,EAAE,WAAW;IACzB,QAAQ,OAAO,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;IACpE,KAAK;IACL,CAAC,CAAC,CAAC;;;IAGH;IACA;IACA;;IAEA,CAAC,CAAC,OAAO,CAAC,aAAa,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC;IAC3C,IAAI,OAAO,EAAE;IACb,QAAQ,OAAO,EAAE,6BAA6B;IAC9C,QAAQ,QAAQ,EAAE,YAAY;IAC9B,QAAQ,KAAK,EAAE,cAAc;IAC7B,QAAQ,cAAc,EAAE,IAAI;IAC5B,QAAQ,aAAa,EAAE,IAAI;IAC3B,QAAQ,UAAU,EAAE,IAAI;IACxB,QAAQ,iBAAiB,EAAE,KAAK;IAChC,QAAQ,UAAU,EAAE,KAAK;IACzB,QAAQ,WAAW,EAAE,IAAI;IACzB,QAAQ,UAAU,EAAE,IAAI;IACxB,QAAQ,oBAAoB,EAAE,KAAK;IACnC,QAAQ,YAAY,EAAE,KAAK;IAC3B,QAAQ,iBAAiB,EAAE,CAAC;IAC5B,QAAQ,WAAW,EAAE,IAAI;IACzB,QAAQ,QAAQ,EAAE,GAAG;IACrB,QAAQ,QAAQ,EAAE,EAAE;IACpB,QAAQ,SAAS,EAAE,GAAG;IACtB,QAAQ,SAAS,EAAE,CAAC;IACpB,QAAQ,QAAQ,EAAE,KAAK;IACvB,QAAQ,aAAa,EAAE;IACvB,YAAY,cAAc,EAAE,IAAI;IAChC,SAAS;IACT,KAAK;;IAEL,IAAI,UAAU,EAAE,SAAS,OAAO,EAAE;IAClC,QAAQ,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;IAC3D,QAAQ,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;IAC7B,QAAQ,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,IAAI,IAAI,CAAC;IACjE,KAAK;;IAEL,IAAI,KAAK,EAAE,SAAS,GAAG,EAAE;IACzB,QAAQ,IAAI,SAAS,CAAC;IACtB,QAAQ,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;IACxB,QAAQ,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,GAAG,CAAC,aAAa,EAAE;IACvD,YAAY,IAAI,CAAC,cAAc,GAAG,GAAG,CAAC,aAAa,CAAC;IACpD,SAAS;IACT,QAAQ,IAAI,CAAC,WAAW,EAAE,CAAC;;IAE3B,QAAQ,SAAS,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,4DAA4D,CAAC,CAAC;IAC1G,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,cAAc,EAAE;IACzC,YAAY,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;IAC7E,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,iBAAiB,EAAE;IAC5C,YAAY,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,aAAa,CAAC,cAAc,EAAE,SAAS,CAAC,CAAC;IACzF,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE;IACrC,YAAY,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IAC1E,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE;IACxC,YAAY,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;IAC3E,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE;IACrC,YAAY,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IACrE,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE;IACtC,YAAY,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;IACtE,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE;IACrC,YAAY,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,4CAA4C,EAAE,SAAS,CAAC,CAAC;IACtI,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE;IACtC,YAAY,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,uCAAuC,EAAE,SAAS,CAAC,CAAC;IACnI,SAAS;;IAET,QAAQ,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,IAAI,CAAC,CAAC;;IAElD,QAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IAChE,QAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,UAAU,GAAG,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;IAC7E,QAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,aAAa,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;;IAEzE,QAAQ,IAAI,CAAC,cAAc,CAAC,EAAE,CAAC,qCAAqC,EAAE,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;;IAEvG,QAAQ,CAAC,CAAC,QAAQ,CAAC,uBAAuB,CAAC,SAAS,CAAC,CAAC;;IAEtD,QAAQ,OAAO,SAAS,CAAC;IACzB,KAAK;IACL,IAAI,KAAK,EAAE,WAAW;IACtB;IACA,QAAQ,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IACzD,QAAQ,IAAI,CAAC,oBAAoB,EAAE,CAAC;IACpC,QAAQ,IAAI,CAAC,oBAAoB,EAAE,CAAC;IACpC,QAAQ,IAAI,CAAC,OAAO,EAAE,CAAC;IACvB,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;IACL,IAAI,QAAQ,EAAE,WAAW;IACzB,QAAQ,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,0CAA0C,EAAE,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;IACtG,QAAQ,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;IACjE;;IAEA,QAAQ,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IACjE,QAAQ,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,UAAU,GAAG,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;IAC9E,QAAQ,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;IAC1E,QAAQ,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,qCAAqC,EAAE,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;IACxG,KAAK;;IAEL,IAAI,WAAW,EAAE,WAAW;IAC5B,QAAQ,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;IAC1B,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;IACrC,gBAAgB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;IACnD,aAAa,MAAM;IACnB,gBAAgB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,CAAC,aAAa,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,IAAI,CAAC,cAAc,CAAC,CAAC;IAC3G,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;IACnC,YAAY,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC5C,SAAS;IACT,QAAQ,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,0CAA0C,EAAE,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,CAAC;IACrG,QAAQ,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,SAAS,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;IAChE,QAAQ,IAAI,CAAC,oBAAoB,EAAE,CAAC;IACpC,KAAK;;IAEL,IAAI,cAAc,GAAG,SAAS,IAAI,EAAE;IACpC,QAAQ,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,EAAE;IAC/D,YAAY,IAAI,IAAI,CAAC,YAAY,EAAE;IACnC,gBAAgB,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;IACjE,aAAa;IACb,SAAS;IACT,KAAK;;IAEL,IAAI,oBAAoB,EAAE,WAAW;IACrC,QAAQ,IAAI,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,kBAAkB,EAAE;IACjE,YAAY,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,kBAAkB,EAAE;IACjE,YAAY,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC;;IAErE,QAAQ,IAAI,IAAI,CAAC,WAAW,EAAE;IAC9B,YAAY,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,GAAG,GAAG,CAAC;IACvD,YAAY,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,GAAG,GAAG,CAAC;IACvD,YAAY,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,UAAU,IAAI,CAAC,CAAC,CAAC;IAC1D,YAAY,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,UAAU,IAAI,GAAG,CAAC,CAAC;IAC5D,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,WAAW,EAAE;IAC9B,YAAY,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,QAAQ,GAAG,GAAG,CAAC;IACpD,YAAY,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;IACvC,SAAS;IACT,KAAK;;IAEL,IAAI,gBAAgB,EAAE,SAAS,GAAG,EAAE;IACpC,QAAQ,IAAI,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE;IAClE,YAAY,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,EAAE,SAAS,CAAC,CAAC;IACjE,YAAY,IAAI,CAAC,gBAAgB,CAAC,SAAS,GAAG,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,SAAS,EAAE,GAAG,CAAC,MAAM,CAAC,CAAC;IACrG,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,uBAAuB,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE;IACzE,YAAY,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,uBAAuB,EAAE,SAAS,CAAC,CAAC;IACxE,YAAY,IAAI,CAAC,uBAAuB,CAAC,SAAS,GAAG,IAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC,SAAS,EAAE,GAAG,CAAC,MAAM,CAAC,CAAC;IAC5G,SAAS;IACT,KAAK;IACL,IAAI,oBAAoB,EAAE,WAAW;IACrC,QAAQ,IAAI,IAAI,CAAC,gBAAgB,EAAE;IACnC,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE;IACzE,gBAAgB,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IACnE,gBAAgB,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,gBAAgB,EAAE,MAAM,CAAC,CAAC;IACrE,aAAa,MAAM;IACnB,gBAAgB,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,gBAAgB,EAAE,OAAO,CAAC,CAAC;IACtE,gBAAgB,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,EAAE,MAAM,CAAC,CAAC;IAClE,aAAa;IACb,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE;IACzE,gBAAgB,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,EAAE,SAAS,CAAC,CAAC;IACrE,aAAa,MAAM;IACnB,gBAAgB,IAAI,CAAC,gBAAgB,CAAC,SAAS,GAAG,EAAE,CAAC;IACrD,gBAAgB,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,gBAAgB,EAAE,SAAS,CAAC,CAAC;IACxE,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,uBAAuB,EAAE;IAC1C,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE;IACzE,gBAAgB,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC;IAC1E,aAAa,MAAM;IACnB,gBAAgB,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,uBAAuB,EAAE,OAAO,CAAC,CAAC;IAC7E,aAAa;IACb,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE;IACzE,gBAAgB,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,uBAAuB,EAAE,SAAS,CAAC,CAAC;IAC5E,aAAa,MAAM;IACnB,gBAAgB,IAAI,CAAC,uBAAuB,CAAC,SAAS,GAAG,EAAE,CAAC;IAC5D,gBAAgB,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,uBAAuB,EAAE,SAAS,CAAC,CAAC;IAC/E,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,WAAW,EAAE;IAC9B,YAAY,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE;IACzC,gBAAgB,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;IAC/D,aAAa,MAAM;IACnB,gBAAgB,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;IAClE,aAAa;IACb,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,YAAY,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;IACvD,YAAY,IAAI,KAAK,IAAI,IAAI,CAAC,OAAO,CAAC,iBAAiB,EAAE,IAAI,IAAI,CAAC;IAClE,YAAY,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,EAAE,EAAE,CAAC;IAClD,YAAY,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IAC9C,SAAS;IACT,KAAK;;IAEL,IAAI,OAAO,EAAE,WAAW;IACxB,QAAQ,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;IAClC,YAAY,OAAO;IACnB,SAAS;IACT,QAAQ,IAAI,IAAI,CAAC,cAAc,CAAC,mBAAmB,EAAE,IAAI,CAAC,EAAE;IAC5D,YAAY,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,CAAC,CAAC;IACtE,YAAY,IAAI,IAAI,CAAC,YAAY,EAAE;IACnC,gBAAgB,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;IACpE,gBAAgB,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;IAC/E,aAAa;IACb,YAAY,IAAI,IAAI,CAAC,WAAW,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE;IAC9D,gBAAgB,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,mBAAmB,EAAE,CAAC,CAAC;IACrF,aAAa;IACb,SAAS,MAAM;IACf,YAAY,IAAI,IAAI,CAAC,YAAY,EAAE;IACnC,gBAAgB,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,IAAI,CAAC,sBAAsB,EAAE,CAAC;IAC5E,aAAa;IACb,SAAS;IACT,KAAK;;IAEL,IAAI,aAAa,EAAE,SAAS,KAAK,EAAE,SAAS,EAAE;IAC9C,QAAQ,IAAI,IAAI,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,eAAe,GAAG,KAAK,CAAC,WAAW,EAAE,EAAE,SAAS,CAAC,CAAC;IAClH,QAAQ,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;IACxB,QAAQ,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;;IAE3B,QAAQ,CAAC,CAAC,QAAQ;IAClB,aAAa,WAAW,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC,QAAQ,CAAC,eAAe,CAAC;IACnE,aAAa,WAAW,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC,QAAQ,CAAC,cAAc,CAAC;IAClE,aAAa,WAAW,CAAC,IAAI,EAAE,OAAO,EAAE,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,GAAG,SAAS,CAAC,EAAE,IAAI,CAAC,CAAC;;IAErG,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,iBAAiB,EAAE,SAAS,SAAS,EAAE,SAAS,EAAE;IACtD,QAAQ,IAAI,eAAe;IAC3B,YAAY,SAAS;IACrB,YAAY,GAAG;IACf,YAAY,IAAI,EAAE,MAAM,CAAC;IACzB,QAAQ,eAAe,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;IACxE;IACA;IACA;;IAEA,QAAQ,SAAS,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,QAAQ,EAAE,eAAe,CAAC,CAAC;IACvE,QAAQ,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC;;IAEjE,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE;IACvC,YAAY,MAAM,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;IAC1E,SAAS;IACT,QAAQ,IAAI,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE;IACxC,YAAY,SAAS,EAAE,WAAW;IAClC,YAAY,QAAQ,EAAE,CAAC;IACvB,YAAY,QAAQ,EAAE,GAAG;IACzB,SAAS,CAAC,CAAC;IACX,QAAQ,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE;IACvC,YAAY,IAAI,KAAK,GAAG,CAAC,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;IAC5C,YAAY,IAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC;IAChD,YAAY,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC;IAC5C,SAAS,EAAE,IAAI,CAAC,CAAC;IACjB,QAAQ,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,SAAS,CAAC,EAAE;IACpC,YAAY,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;IAC3C,YAAY,IAAI,IAAI,GAAG,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;IACpF,YAAY,IAAI,IAAI,EAAE;IACtB,gBAAgB,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC;IAC1C,gBAAgB,IAAI,IAAI,CAAC,YAAY,EAAE;IACvC,kBAAkB,IAAI,CAAC,YAAY,CAAC,SAAS,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;IACjF,iBAAiB;IACjB,gBAAgB,IAAI,IAAI,CAAC,OAAO,CAAC,oBAAoB,CAAC;IACtD,oBAAoB,IAAI,CAAC,uBAAuB,CAAC,CAAC,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;IACtE,iBAAiB;IACjB,aAAa;IACb,SAAS,EAAE,IAAI,CAAC,CAAC;;IAEjB,QAAQ,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,WAAW;IACtC,YAAY,IAAI,WAAW,EAAE,WAAW,CAAC;IACzC,YAAY,IAAI,MAAM,EAAE;IACxB;IACA,gBAAgB,WAAW,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;IACtD,gBAAgB,WAAW,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC;IACtD,gBAAgB,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,WAAW,EAAE;IAClD,oBAAoB,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,WAAW,CAAC;IACjD,iBAAiB;IACjB,gBAAgB,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,WAAW,EAAE;IAClD,oBAAoB,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,WAAW,CAAC;IACjD,iBAAiB;IACjB,aAAa;IACb,SAAS,EAAE,IAAI,CAAC,CAAC;IACjB,QAAQ,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,EAAE,OAAO,EAAE,SAAS,CAAC,EAAE;IACtD,YAAY,IAAI,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,EAAE;IACtD,gBAAgB,OAAO;IACvB,aAAa;IACb,YAAY,IAAI,KAAK,IAAI,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;IAChF,gBAAgB,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,gBAAgB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC;IACpE,YAAY,IAAI,MAAM,EAAE;IACxB,gBAAgB,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,EAAE;IAClF,oBAAoB,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;IACxC,oBAAoB,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;IAClE,iBAAiB;IACjB,aAAa,MAAM;IACnB,gBAAgB,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;IACpC,gBAAgB,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC9D,aAAa;;IAEb,SAAS,EAAE,IAAI,CAAC,CAAC;IACjB,QAAQ,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;;IAE5B,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;;IAGL,IAAI,iBAAiB,EAAE,SAAS,SAAS,EAAE;IAC3C,QAAQ,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC;IACpD,QAAQ,IAAI,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC;IACrE,QAAQ,IAAI,QAAQ,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;IACnE,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE;IAC7C,YAAY,SAAS,EAAE,YAAY;IACnC,YAAY,QAAQ,EAAE,CAAC;IACvB,YAAY,QAAQ,EAAE,GAAG;IACzB,SAAS,CAAC,CAAC;IACX,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE;IAC7C,YAAY,SAAS,EAAE,YAAY;IACnC,YAAY,QAAQ,EAAE,CAAC;IACvB,YAAY,QAAQ,EAAE,GAAG;IACzB,SAAS,CAAC,CAAC;;;IAGX,QAAQ,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;IAC3C,QAAQ,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;IAC7B,QAAQ,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;;IAE/B;IACA,QAAQ,KAAK,CAAC,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE;IACxC,YAAY,IAAI,KAAK,GAAG,CAAC,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;IAC5C,YAAY,IAAI,CAAC,yBAAyB,CAAC,KAAK,EAAE,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC;IACpE,SAAS,EAAE,IAAI,CAAC,CAAC;IACjB,QAAQ,KAAK,CAAC,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE;IACxC,YAAY,IAAI,KAAK,GAAG,CAAC,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;IAC5C,YAAY,IAAI,CAAC,yBAAyB,CAAC,KAAK,CAAC,QAAQ,EAAE,EAAE,KAAK,CAAC,CAAC;IACpE,SAAS,EAAE,IAAI,CAAC,CAAC;;IAEjB;IACA,QAAQ,KAAK,CAAC,EAAE,CAAC,sBAAsB,EAAE,WAAW;IACpD,YAAY,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;IAC7E,YAAY,QAAQ,CAAC,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,WAAW,EAAE,GAAG,KAAK,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC;IACpF,SAAS,EAAE,IAAI,CAAC,CAAC;;IAEjB,QAAQ,KAAK,CAAC,EAAE,CAAC,sBAAsB,EAAE,WAAW;IACpD,YAAY,QAAQ,CAAC,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,WAAW,EAAE,GAAG,KAAK,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC;IACpF,SAAS,EAAE,IAAI,CAAC,CAAC;;IAEjB;IACA,QAAQ,KAAK,CAAC,EAAE,CAAC,SAAS,EAAE,WAAW;IACvC;IACA,YAAY,IAAI,aAAa,GAAG,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;IAC9F,YAAY,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,aAAa,EAAE;IAClD,gBAAgB,KAAK,CAAC,OAAO,CAAC,CAAC,GAAG,aAAa,CAAC;IAChD,aAAa;IACb,SAAS,EAAE,IAAI,CAAC,CAAC;;IAEjB,QAAQ,KAAK,CAAC,EAAE,CAAC,SAAS,EAAE,WAAW;IACvC;IACA,YAAY,IAAI,aAAa,GAAG,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;IAC9F,YAAY,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,IAAI,aAAa,EAAE;IAClD,gBAAgB,KAAK,CAAC,OAAO,CAAC,CAAC,GAAG,aAAa,CAAC;IAChD,aAAa;IACb,SAAS,EAAE,IAAI,CAAC,CAAC;;IAEjB,QAAQ,KAAK,CAAC,EAAE,CAAC,UAAU,EAAE,WAAW;IACxC,YAAY,IAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC;IACtD,SAAS,EAAE,IAAI,CAAC,CAAC;IACjB,QAAQ,KAAK,CAAC,EAAE,CAAC,UAAU,EAAE,WAAW;IACxC,YAAY,IAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IACvG,SAAS,EAAE,IAAI,CAAC,CAAC;;IAEjB,QAAQ,OAAO,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;IAC9B,KAAK;;;IAGL,IAAI,kBAAkB,EAAE,SAAS,SAAS,EAAE,SAAS,EAAE;IACvD,QAAQ,IAAI,eAAe,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;IAC5E;IACA;IACA;IACA;IACA,QAAQ,IAAI,UAAU,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE,OAAO,EAAE,eAAe,CAAC,CAAC;IAC5E,QAAQ,IAAI,SAAS,GAAG,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,QAAQ,EAAE,eAAe,CAAC,CAAC;IAC3E,QAAQ,IAAI,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,IAAI,IAAI,CAAC,OAAO,CAAC,iBAAiB,EAAE,IAAI,IAAI,CAAC,CAAC,GAAG,EAAE,CAAC;IAC/F,QAAQ,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;;IAEnE,QAAQ,IAAI,IAAI,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE;IAC5C,YAAY,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,SAAS;IACxC,YAAY,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ;IAC3C,YAAY,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,QAAQ;IAC3C,SAAS,CAAC,CAAC;;IAEX,QAAQ,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE;IACvC,YAAY,IAAI,KAAK,GAAG,CAAC,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;IAC5C,YAAY,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;IACxC,YAAY,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;IAChE,YAAY,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,CAAC;IACjD,SAAS,EAAE,IAAI,CAAC,CAAC;IACjB,QAAQ,IAAI,CAAC,EAAE,CAAC,MAAM,EAAE,SAAS,CAAC,EAAE;IACpC,YAAY,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;IACvC,YAAY,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC9E,SAAS,EAAE,IAAI,CAAC,CAAC;IACjB,SAAS,IAAI,CAAC,EAAE,CAAC,iBAAiB,EAAE,UAAU,CAAC,EAAE;IACjD,YAAY,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC9E,SAAS,EAAE,IAAI,CAAC,CAAC;;IAEjB,QAAQ,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,EAAE,OAAO,EAAE,SAAS,CAAC,EAAE;IACtD,YAAY,IAAI,CAAC,CAAC,MAAM,KAAK,IAAI,CAAC,QAAQ,EAAE;IAC5C,gBAAgB,OAAO;IACvB,aAAa;IACb,YAAY,IAAI,KAAK,IAAI,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;IAChF,gBAAgB,CAAC,GAAG,CAAC,CAAC,QAAQ,CAAC,gBAAgB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC;IACpE,YAAY,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;IAChC,YAAY,UAAU,CAAC,SAAS,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC1E,YAAY,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC3D,SAAS,EAAE,IAAI,CAAC,CAAC;IACjB,QAAQ,OAAO,IAAI,CAAC;IACpB,KAAK;;IAEL,IAAI,sBAAsB,EAAE,WAAW;IACvC,QAAQ,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACtD,KAAK;;IAEL,IAAI,qBAAqB,EAAE,WAAW;IACtC,QAAQ,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAClD,KAAK;IACL,IAAI,kBAAkB,EAAE,WAAW;IACnC,QAAQ,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAC;IACzD,KAAK;;IAEL,IAAI,kBAAkB,EAAE,WAAW;IACnC,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,EAAE;IACtC,YAAY,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;IAChC,SAAS,MAAM;IACf,YAAY,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC5C,SAAS;IACT,KAAK;;IAEL,IAAI,yBAAyB,EAAE,WAAW;IAC1C,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,EAAE;IACtC,YAAY,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;IAChC,SAAS,MAAM;IACf,YAAY,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;IACnD,SAAS;IACT,KAAK;;IAEL,IAAI,kBAAkB,EAAE,UAAU;IAClC,QAAQ,IAAI,CAAC,cAAc,EAAE,CAAC;IAC9B,KAAK;;IAEL,IAAI,uBAAuB,EAAE,SAAS,QAAQ,EAAE;IAChD,QAAQ,IAAI,CAAC,cAAc,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;IAC1D,KAAK;;IAEL,IAAI,yBAAyB,EAAE,SAAS,UAAU,EAAE,UAAU,EAAE;IAChE,QAAQ,IAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;IAC3D,QAAQ,IAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;IAC3D,KAAK;;IAEL,IAAI,wBAAwB,EAAE,SAAS,QAAQ,EAAE;IACjD,QAAQ,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,IAAI,GAAG,QAAQ,CAAC,CAAC;IACxD,KAAK;;IAEL,IAAI,cAAc,EAAE,WAAW;IAC/B,QAAQ,IAAI,IAAI,CAAC,QAAQ,EAAE;IAC3B,YAAY,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;IAC5D,YAAY,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,YAAY,CAAC;IACnD,SAAS,MAAM;IACf,YAAY,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC;IACzD,YAAY,IAAI,CAAC,YAAY,CAAC,KAAK,GAAG,UAAU,CAAC;IACjD,SAAS;IACT,QAAQ,IAAI,CAAC,QAAQ,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC;IACvC,QAAQ,IAAI,CAAC,OAAO,EAAE,CAAC;IACvB,KAAK;;IAEL,IAAI,qBAAqB,EAAE,SAAS,IAAI,EAAE;IAC1C,QAAQ,OAAO,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;IAC1E,KAAK;IACL,IAAI,gBAAgB,EAAE,SAAS,GAAG,EAAE;IACpC,QAAQ,OAAO,GAAG,GAAG,KAAK,CAAC;IAC3B,KAAK;IACL,IAAI,sBAAsB,EAAE,SAAS,SAAS,EAAE,MAAM,EAAE;IACxD,QAAQ,OAAO,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,GAAG,MAAM,GAAG,GAAG,CAAC,GAAG,UAAU,CAAC;IAC5E,KAAK;IACL,IAAI,sBAAsB,EAAE,WAAW;IACvC,QAAQ,OAAO,oBAAoB,CAAC;IACpC,KAAK;;IAEL,CAAC,CAAC,CAAC;;IAEH,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,WAAW;IAC7B,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC,oBAAoB,EAAE;IAC3C,QAAQ,IAAI,CAAC,oBAAoB,GAAG,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,2BAA2B,IAAI,EAAE,CAAC,CAAC;IAC5G,QAAQ,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;IACnD,KAAK;IACL,CAAC,CAAC,CAAC;;IAEH,CAAC,CAAC,OAAO,CAAC,aAAa,GAAG,SAAS,OAAO,EAAE;IAC5C,IAAI,OAAO,IAAI,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;IAChD,CAAC,CAAC;;;;;;;;;;QCvoEIvK;;;IAEF,kBAAYpK,KAAZ,EAAmB2U,IAAnB,EAAyB;IAAA;;IAAA,2GACf3U,KADe,EACR2U,IADQ;IAExB;;IAED;;;;;gEACqCkD,KAAK;IACtC,gBAAIF,SAASE,IAAIC,gBAAJ,CAAqB,OAArB,CAAb;IACA,gBAAIlD,YAAY,KAAKmD,UAAL,CAAgBrB,SAAhB,CAA0BiB,MAA1C;IACA,gBAAI3X,QAAQ,IAAZ;IACA,gBAAIgY,QAAQ,IAAZ;;IAEAL,mBAAOM,OAAP,CAAe,UAASC,OAAT,EAAkB;IAC7B,oBAAIA,QAAQC,aAAR,CAAsB,MAAtB,EAA8BxW,SAA9B,KAA4CiT,SAAhD,EAA2D;IACvD5U,4BAAQkY,OAAR;IACH;IACJ,aAJD;IAKA,gBAAIlY,KAAJ,EAAW;IACPgY,wBAAQ,KAAKI,8BAAL,CAAoCpY,KAApC,CAAR;IACA,oBAAI,CAACgY,KAAL,EAAY;IACRA,4BAAQ,KAAKI,8BAAL,CAAoCpY,MAAMqY,UAA1C,CAAR;IACH;IACJ;;IAED,mBAAOL,KAAP;IACH;;IAED;;;;2DACgChY,OAAO;IACnC,gBAAIgY,QAAQ,IAAZ;IACA,gBAAIM,aAAatY,MAAM8X,gBAAN,CAAuB,wBAAvB,CAAjB;IACA,gBAAIQ,cAAcA,WAAW7b,MAAzB,IAAmC6b,WAAW,CAAX,EAAcC,WAAd,CAA0B9b,MAAjE,EAAyE;IACrEub,wBAAQM,WAAW,CAAX,EAAcC,WAAd,CAA0BC,IAA1B,EAAR;IACH;IACD,gBAAG,CAACR,KAAD,IAAU,CAACA,MAAMvb,MAApB,EAA4B;IACxB,oBAAIgc,UAAUzY,MAAM8X,gBAAN,CAAuB,qBAAvB,CAAd;IACA,oBAAIW,WAAWA,QAAQhc,MAAnB,IAA6Bgc,QAAQ,CAAR,EAAWF,WAAX,CAAuB9b,MAAxD,EAAgE;IAC5Dub,4BAAQS,QAAQ,CAAR,EAAWF,WAAX,CAAuBC,IAAvB,EAAR;IACH;IACJ;IACD,gBAAGR,SAAS,CAACA,MAAMnQ,OAAN,CAAc,SAAd,CAAb,EAAuC;IACnCmQ,wBAAQA,MAAMlH,OAAN,CAAc,SAAd,EAAyB,IAAItE,IAAJ,GAAWkM,WAAX,EAAzB,CAAR;IACH;IACD,mBAAOV,KAAP;IACH;;;;MA7CcvH,iBAAA,CAAgBkI,KAAhB,CAAsBzO;;IAoDzC,SAAS0O,IAAT,CAAcC,OAAd,EAAuB;;IAEnB,QAAIrO,UAAUqO,QAAQtE,QAAR,CAAiB,CAAjB,CAAd;IACA,QAAI9J,MAAMD,QAAQ5I,IAAlB;;IAEA,QAAG,CAAC6I,GAAJ,EAAS;IACL,cAAM,IAAIkI,KAAJ,CAAU,qDAAV,CAAN;IACH;;IAED,QAAIgC,OAAO;IACPgD,gBAAckB,QAAQjE,SADf;IAEPgD,qBAAc,IAFP;IAGPnD,gBAAc,WAHP;IAIPkC,eAAckC,QAAQpF;IAJf,KAAX;IAMA,QAAG/L,yBAAOkG,WAAV,EACI+G,KAAK9G,IAAL,GAAYnG,yBAAOkG,WAAnB;;IAEJ,QAAIkL,eAAe,IAAI5O,GAAJ,CAASO,GAAT,EAAckK,IAAd,CAAnB;;IAEA,QAAIoE,WAAWrR,yBAAOQ,MAAP,GAAgB,gBAAhB,GACXsC,QAAQ7L,EADG,GACE,qBADjB;;IAGA,QAAIqa,SAAS,EAAEhB,OAAQ,IAAV,EAAb;;IAEA,QAAGa,QAAQI,QAAX,EAAqB;;IAEjB,YAAIC,KAAKL,QAAQI,QAAR,CAAiBE,SAAjB,GACL,IAAI3M,IAAJ,CAASqM,QAAQI,QAAR,CAAiBE,SAA1B,CADK,GACkC,IAAI3M,IAAJ,EAD3C;IAEA,YAAI4M,KAAKP,QAAQI,QAAR,CAAiBI,OAAjB,GACL,IAAI7M,IAAJ,CAASqM,QAAQI,QAAR,CAAiBI,OAA1B,CADK,GACgC,IAAI7M,IAAJ,EADzC;;IAGAwM,eAAOhB,KAAP,GAAekB,GAAGR,WAAH,KAAmB,GAAnB,GAAyBU,GAAGV,WAAH,EAAzB,GAA4C,MAA3D;IACH;;IAED,WAAO,IAAItO,IAAJ,CAAS0O,YAAT,EAAuB;IAC1BQ,uBAAe,IAAI7I,iBAAJ,CAAoBuI,MAApB,CADW;IAE1BO,eAAOR;IAFmB,KAAvB,CAAP;IAIH;;IAED,MAAM7D,cAAU9K,IAAV,GAAiBA,IAAjB;IACN,MAAMoP,cAAUZ,IAAV,GAAiBA,IAAjB;;IAUN;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;ICzNA,IAAI,OAAOpN,OAAOiO,MAAd,IAAwB,UAA5B,EAAwC;IACpC;IACAjO,WAAOkO,cAAP,CAAsBlO,MAAtB,EAA8B,QAA9B,EAAwC;IACpCvE,eAAO,SAASwS,MAAT,CAAgBvZ,MAAhB,EAAwByZ,OAAxB,EAAiC;AAAE;IAEtC,gBAAIzZ,UAAU,IAAd,EAAoB;IAAE;IAClB,sBAAM,IAAI0Z,SAAJ,CAAc,4CAAd,CAAN;IACH;;IAED,gBAAIC,KAAKrO,OAAOtL,MAAP,CAAT;;IAEA,iBAAK,IAAI+O,QAAQ,CAAjB,EAAoBA,QAAQ6K,UAAUrd,MAAtC,EAA8CwS,OAA9C,EAAuD;IACnD,oBAAI8K,aAAaD,UAAU7K,KAAV,CAAjB;;IAEA,oBAAI8K,cAAc,IAAlB,EAAwB;IAAE;IACtB,yBAAK,IAAIC,OAAT,IAAoBD,UAApB,EAAgC;IAC5B;IACA,4BAAIvO,OAAOhN,SAAP,CAAiBY,cAAjB,CAAgCX,IAAhC,CAAqCsb,UAArC,EAAiDC,OAAjD,CAAJ,EAA+D;IAC3DH,+BAAGG,OAAH,IAAcD,WAAWC,OAAX,CAAd;IACH;IACJ;IACJ;IACJ;IACD,mBAAOH,EAAP;IACH,SAtBmC;IAuBpCI,kBAAU,IAvB0B;IAwBpCC,sBAAc;IAxBsB,KAAxC;IA0BH;;IAGD,IAAMC,UAAU,oBAAhB;;IAEA;IACA;IACA;IACA;IACA;IACA,SAASC,QAAT,CAAkB9Q,GAAlB,EAAuByB,IAAvB,EAA6B;IAC5B,WAAOzB,IAAIwH,OAAJ,CAAYqJ,OAAZ,EAAqB,UAAU7Q,GAAV,EAAenK,GAAf,EAAoB;IAC/C,YAAI8H,QAAQ8D,KAAK5L,GAAL,CAAZ;IACM,YAAI8H,UAAUnC,SAAd,EAAyB;IACrBmC,oBAAQ8D,KAAK5L,IAAI+M,WAAJ,EAAL,CAAR;IACH;IACD,YAAIjF,UAAUnC,SAAd,EAAyB;IACxB,kBAAM,IAAI6N,KAAJ,CAAU,oCAAoCrJ,GAA9C,CAAN;IACN,SAFK,MAEC,IAAI,OAAOrC,KAAP,KAAiB,UAArB,EAAiC;IACvCA,oBAAQA,MAAM8D,IAAN,CAAR;IACA;IACD,eAAO9D,KAAP;IACA,KAXM,CAAP;IAYA;;IAGD;;;IAGA,IAAIkD,OAAO+K,cAAUjZ,MAAV,CAAiB;;IAExBoe,uBAAmB;;IAEf7P,iBAAS,MAFM;IAGf8P,iBAAS,SAHM;IAIf9C,iBAAS,OAJM;IAKfG,gBAAQ,EALO;IAMflI,gBAAQ,EANO;IAOf8K,uBAAe,EAPA;IAQf9F,gBAAQ;IARO,KAFK;;IAaxB3X,gBAAY,oBAAU2N,GAAV,EAAevO,OAAf,EAAwB;IAAE;IAClC,aAAKse,IAAL,GAAY/P,GAAZ;IACA,YAAIgQ,aAAaxe,WAAO,EAAP,EAAW,KAAKoe,iBAAhB,CAAjB;IACA,YAAIK,WAAWxe,QAAQwe,QAAR,IAAoB,KAAKxe,OAAL,CAAawe,QAAhD;IACA,YAAIxe,QAAQye,YAAR,IAAwBC,YAAQC,MAApC,EAA4C;IACxCJ,uBAAW/d,KAAX,GAAmB+d,WAAWpN,MAAX,GAAoBqN,WAAW,CAAlD;IACH,SAFD,MAEO;IACHD,uBAAW/d,KAAX,GAAmB+d,WAAWpN,MAAX,GAAoBqN,QAAvC;IACH;IACD,aAAK,IAAI5P,CAAT,IAAc5O,OAAd,EAAuB;IACnB;IACA,gBAAI,CAAC,KAAKA,OAAL,CAAakD,cAAb,CAA4B0L,CAA5B,CAAD,IAAmCA,KAAG,WAA1C,EAAuD;IACnD2P,2BAAW3P,CAAX,IAAgB5O,QAAQ4O,CAAR,CAAhB;IACH;IACJ;IACD,aAAK2P,UAAL,GAAkBA,UAAlB;IACA,aAAKK,SAAL,GAAiB5e,QAAQ4e,SAAR,IAAmB,KAAKC,gBAAL,EAApC;IACAhe,uBAAW,IAAX,EAAiBb,OAAjB;IACH,KA/BuB;;IAiCxBe,WAAO,eAAUC,GAAV,EAAe;IAClB,aAAK8d,IAAL,GAAY,KAAK9e,OAAL,CAAaqb,GAAb,IAAoBra,IAAIhB,OAAJ,CAAYqb,GAA5C;IACArC,sBAAU1W,SAAV,CAAoBvB,KAApB,CAA0BwB,IAA1B,CAA+B,IAA/B,EAAqCvB,GAArC;IACH,KApCuB;;IAsCxB+d,gBAAY,oBAAUC,MAAV,EAAkB;IAAE;IAC5B,YAAIR,WAAW,KAAKxe,OAAL,CAAawe,QAA5B;IACA,YAAIS,UAAUD,OAAOE,UAAP,CAAkBV,QAAlB,CAAd;IACAS,gBAAQ5E,CAAR,IAAW,CAAX;IACA4E,gBAAQ7E,CAAR,IAAW,CAAX;IACA,YAAI+E,UAAUF,QAAQG,GAAR,CAAY,IAAIC,SAAJ,CAAUb,QAAV,EAAoBA,QAApB,CAAZ,CAAd;IACA,YAAIc,OAAO,KAAKC,SAAhB;IACA,YAAIC,KAAK,KAAKV,IAAL,CAAUW,OAAV,CAAkB,KAAKpd,IAAL,CAAUqd,SAAV,CAAoBT,OAApB,EAA6BK,IAA7B,CAAlB,CAAT;IACA,YAAIK,KAAK,KAAKb,IAAL,CAAUW,OAAV,CAAkB,KAAKpd,IAAL,CAAUqd,SAAV,CAAoBP,OAApB,EAA6BG,IAA7B,CAAlB,CAAT;IACA,YAAIM,YAAYD,GAAGtF,CAAH,GAAKmF,GAAGnF,CAAxB;IACA;IACA,YAAIwF,QAAQ,KAAKjB,SAAL,CAAeU,IAAf,EAAqBQ,UAAjC;IACA,YAAIC,aAAa,KAAKxB,UAAL,CAAgBF,aAAhB,GAAgC,GAAhC,GAAsCwB,KAAvD;IACA,YAAIG,KAAK,KAAKpB,SAAL,CAAeU,IAAf,EAAqBW,aAArB,CAAmCtV,GAA5C;IACA,YAAIuV,KAAK,KAAKtB,SAAL,CAAeU,IAAf,EAAqBW,aAArB,CAAmCnV,GAA5C;IACA,YAAIqV,UAAQzW,KAAK0W,KAAL,CAAW,CAACZ,GAAGnF,CAAH,GAAK2F,EAAN,IAAUJ,SAArB,CAAZ;IACA,YAAIS,UAAQ,CAAC3W,KAAK0W,KAAL,CAAW,CAACZ,GAAGpF,CAAH,GAAK8F,EAAN,IAAUN,SAArB,CAAb;;IAGA,YAAIrR,MAAM,KAAK+P,IAAf;IACA,YAAIgC,wBAAwB/R,IAAI5C,OAAJ,CAAY,cAAZ,CAA5B;IACA,YAAI4U,qBAAqBhS,IAAI5C,OAAJ,CAAY,WAAZ,CAAzB;IACA,YAAI6U,qBAAqBjS,IAAI5C,OAAJ,CAAY,WAAZ,CAAzB;;IAEA,YAAI8U,IAAInR,OAAOiO,MAAP,CAAc,EAAEmD,GAAG,KAAKC,aAAL,CAAmB3B,MAAnB,CAAL,EAAd,EAAiD,KAAKT,UAAtD,CAAR;IACA,YAAG+B,wBAAsB,CAAzB,EAA4BG,EAAEG,UAAF,GAAef,KAAf;IAC5B,YAAGU,qBAAmB,CAAtB,EAAyBE,EAAEI,OAAF,GAAYR,OAAZ;IACzB,YAAGG,qBAAmB,CAAtB,EAAyBC,EAAEK,OAAF,GAAYX,OAAZ;IACzB,aAAI,IAAIY,CAAR,IAAaN,CAAb,EAAgB;IACZA,cAAEM,EAAE/Q,WAAF,EAAF,IAAqByQ,EAAEM,CAAF,CAArB;IACH;IACD;IACAxS,cAAM2P,SAAS3P,GAAT,EAAckS,CAAd,CAAN;;IAEA,YAAIO,MAAMzS,IAAI5C,OAAJ,CAAY,GAAZ,CAAV;IACA,YAAGqV,MAAI,CAAJ,IAAUV,wBAAsBU,GAAtB,IAA6BT,qBAAmBS,GAAhD,IAAuDR,qBAAmBQ,GAAvF,EAA6F;IACzF;IACA;IACA;;IAEH,SALD,MAKO;IACHzS,kBAAMA,MAAM3D,SAAK8P,cAAL,CAAoB,KAAK6D,UAAzB,EAAqChQ,GAArC,CAAZ;IACA,gBAAG+R,wBAAsB,CAAzB,EACI/R,OAAO,iBAAiBsR,KAAxB,CAHD;IAIH,gBAAGU,qBAAmB,CAAtB,EACIhS,OAAO,cAAc8R,OAArB;IACJ,gBAAGG,qBAAmB,CAAtB,EACIjS,OAAO,cAAc4R,OAArB;IACP;;IAED,eAAO5R,GAAP;IACH,KAzFuB;;IA2FxB0S,eAAW,mBAAUlH,MAAV,EAAkBmH,QAAlB,EAA4B;IACnCnhB,mBAAO,KAAKwe,UAAZ,EAAwBxE,MAAxB;IACA,YAAI,CAACmH,QAAL,EAAe;IACX,iBAAKC,MAAL;IACH;IACD,eAAO,IAAP;IACH,KAjGuB;;IAmGxBtC,sBAAmB,4BAAY;IAC3B;;;;IAIA,YAAIuC,gBAAgB,IAAIC,KAAJ,CAAU,EAAV,CAApB;IACA,aAAK,IAAIzS,IAAG,CAAZ,EAAeA,IAAE,EAAjB,EAAqBA,GAArB,EAA0B;IACtBwS,0BAAcxS,CAAd,IAAkB;IACdkR,4BAAgB,KAAKlR,CADP;IAEdqR,+BAAgB,IAAIqB,UAAJ,CAAW,aAAX,EAAyB,CAAC,aAA1B;IAFF,aAAlB;IAIH;IACD,eAAOF,aAAP;IACH;IAhHuB,CAAjB,CAAX;;IAsHA,SAASG,IAAT,CAAczd,KAAd,EAAqB;;IAEjB,QAAIyK,MAAMzK,MAAMuU,QAAN,IAAkBvU,MAAMuU,QAAN,CAAe9X,MAAjC,GAA0CuD,MAAMuU,QAAN,CAAe,CAAf,EAAkB3S,IAA5D,GAAmE,IAA7E;;IAEA,QAAI1F,UAAU;IACV8D,eAAOA,MAAM4U,SADH;IAEVxS,eAAO,SAFG;IAGVmY,uBAAe,SAHL;IAIV9F,gBAAQ;IAJE,KAAd;IAMA,QAAG/M,yBAAOkG,WAAV,EACI1R,QAAQ2R,IAAR,GAAenG,yBAAOkG,WAAtB;;IAEJ,QAAI8P,SAAS,CAAC1d,MAAM2d,aAAN,IAAuB,EAAxB,EAA4B7R,IAA5B,CAAkC,gBAAQ;IACnD;IACA,eAAO8R,QAAQA,KAAKhc,IAAb,KAAuBgc,KAAKC,SAAL,KAAiB,WAAjB,IAAgCD,KAAKC,SAAL,KAAiB,YAAxE,CAAP;IACH,KAHY,CAAb;IAIA,QAAGH,MAAH,EAAW;IACPjT,cAAMiT,OAAO9b,IAAb;IACA1F,gBAAQuY,MAAR,GAAiBiJ,OAAOG,SAAxB;;IAEA,YAAI5H,SAASyH,OAAOI,UAAP,IAAqB,EAAlC;IACA7H,eAAO8H,IAAP,CAAa,iBAAS;;IAElB;IACA;IACA,gBAAIC,MAAMC,MAAMhS,IAAN,CAAWC,WAAX,EAAV;IACA,gBAAG,iBAAiB8R,GAAjB,IAAwB,cAAcA,GAAtC,IAA6C,cAAcA,GAA9D,EACI;;IAEJ;IACA,gBAAI/W,QAAQgX,MAAMC,YAAN,IAAsBD,MAAME,MAAN,IAAgBF,MAAME,MAAN,CAAa1hB,MAA7B,IAAuCwhB,MAAME,MAAN,CAAa,CAAb,CAAzE;IACA,gBAAGlX,UAAU,IAAV,IAAkBA,UAAUnC,SAA/B,EAA0C;IACtC2F,sBAAMA,IAAIqG,OAAJ,CAAY,MAAMmN,MAAMhS,IAAZ,GAAmB,GAA/B,EAAoChF,KAApC,CAAN;IACH;IACJ,SAbD;IAcH,KAnBD,MAmBO;IACH,cAAM,IAAI0L,KAAJ,CAAU,wBAAwB3S,MAAMrB,EAA9B,GACZ,sDADE,CAAN;IAEH;;IAED,QAAG,CAAC8L,GAAJ,EAAS,MAAM,IAAIkI,KAAJ,CAAU,4CAA4C3S,MAAMrB,EAAlD,GACrB,+FADW,CAAN;;IAGT,WAAO,IAAIwL,IAAJ,CAAUM,GAAV,EAAevO,OAAf,CAAP;IAEH;;AAEDgZ,kBAAU/K,IAAV,GAAiBA,IAAjB;AACAqP,kBAAUiE,IAAV,GAAiBA,IAAjB;;ICpOA,IAAIW,gBAAgBlJ,cAAUjZ,MAAV,CAAiB;;IAEjCoiB,uBAAmB;IACf1G,gBAAc,EADC;IAEfC,qBAAc,IAFC;IAGfnD,gBAAc,OAHC;IAIf;IACA;IACA;IACA;IACA6J,WAAc;IACd;IATe,KAFc;;IAcjCxhB,gBAAY,oBAAU2N,GAAV,EAAevO,OAAf,EAAwB;IAAE;;IAElC,YAAG,CAACuO,GAAJ,EAAS,MAAM,IAAIkI,KAAJ,CAAU,qCAAV,CAAN;;IAET,YAAGlI,IAAI5C,OAAJ,CAAY,SAAZ,IAAyB,CAA5B,EAA+B;IAC3B,gBAAI0W,OAAO9T,IAAI5C,OAAJ,CAAY,GAAZ,CAAX;IACA,gBAAG0W,OAAO,CAAV,EAAa;IACT9T,sBAAMA,IAAI+T,SAAJ,CAAc,CAAd,EAAiBD,IAAjB,IAAyB,SAAzB,GAAqC9T,IAAI+T,SAAJ,CAAcD,IAAd,CAA3C;IACH,aAFD,MAEO;IACH9T,uBAAO,SAAP;IACH;IACJ;IACD,aAAK+P,IAAL,GAAY/P,GAAZ;;IAEA,YAAIgU,aAAaxiB,WAAO,EAAP,EAAW,KAAKoiB,iBAAhB,CAAjB;IAAA,YACI3D,WAAWxe,QAAQwe,QAAR,IAAoB,KAAKxe,OAAL,CAAawe,QADhD;;IAGA,YAAIgE,YAAJ;IACA,YAAIxiB,QAAQye,YAAR,IAAwBC,YAAQC,MAApC,EAA4C;IACxC6D,kBAAMD,WAAWpR,MAAX,GAAoBqN,WAAW,CAArC;IACH,SAFD,MAEO;IACHgE,kBAAMD,WAAWpR,MAAX,GAAoBqN,QAA1B;IACH;IACD+D,mBAAWvf,IAAX,GAAkBwf,MAAM,GAAN,GAAYA,GAA9B;;IAEA,aAAK,IAAI5T,CAAT,IAAc5O,OAAd,EAAuB;IACnB;IACA,gBAAI,CAAC,KAAKA,OAAL,CAAakD,cAAb,CAA4B0L,CAA5B,CAAD,IAAmCA,MAAM,KAA7C,EAAoD;IAChD2T,2BAAW3T,CAAX,IAAgB5O,QAAQ4O,CAAR,CAAhB;IACH;IACJ;;IAED;IACA;;IAEA,aAAK2T,UAAL,GAAkBA,UAAlB;;IAEA1hB,uBAAW,IAAX,EAAiBb,OAAjB;IAEH,KArDgC;;IAuDjCe,WAAO,eAAUC,GAAV,EAAe;IAClB,aAAK8d,IAAL,GAAY,KAAK9e,OAAL,CAAaqb,GAAb,IAAoBra,IAAIhB,OAAJ,CAAYqb,GAA5C;IACA,aAAKkH,UAAL,CAAgBvI,GAAhB,GAAsB,KAAKuI,UAAL,CAAgBE,OAAhB,GAA0B,KAAKF,UAAL,CAAgBG,MAAhB,GAAyB,KAAK5D,IAAL,CAAU6D,IAAnF;IACA3J,sBAAU1W,SAAV,CAAoBvB,KAApB,CAA0BwB,IAA1B,CAA+B,IAA/B,EAAqCvB,GAArC;IACH,KA3DgC;;IA6DjC+d,gBAAY,oBAAU6D,SAAV,EAAqB;IAAE;;IAE/B,YAAI5hB,MAAM,KAAKqB,IAAf;IAAA,YACImc,WAAW,KAAKxe,OAAL,CAAawe,QAD5B;IAAA,YAGAS,UAAU2D,UAAU1D,UAAV,CAAqBV,QAArB,CAHV;IAAA,YAIAW,UAAUF,QAAQG,GAAR,CAAY,CAACZ,QAAD,EAAWA,QAAX,CAAZ,CAJV;IAAA,YAMAgB,KAAK,KAAKV,IAAL,CAAUW,OAAV,CAAkBze,IAAI0e,SAAJ,CAAcT,OAAd,EAAuB2D,UAAUC,CAAjC,CAAlB,CANL;IAAA,YAOAlD,KAAK,KAAKb,IAAL,CAAUW,OAAV,CAAkBze,IAAI0e,SAAJ,CAAcP,OAAd,EAAuByD,UAAUC,CAAjC,CAAlB,CAPL;IAAA,YAQA5I,OAAO,CAACuF,GAAGnF,CAAJ,EAAOsF,GAAGvF,CAAV,EAAauF,GAAGtF,CAAhB,EAAmBmF,GAAGpF,CAAtB,EAAyBQ,IAAzB,CAA8B,GAA9B,CARP;IAAA,YAUArM,MAAM3D,SAAKsT,QAAL,CAAc,KAAKI,IAAnB,EAAyB,EAACoC,GAAG,KAAKC,aAAL,CAAmBiC,SAAnB,CAAJ,EAAzB,CAVN;;IAYA,YAAI7I,SAASha,WAAO,EAAP,EAAW,KAAKwiB,UAAhB,CAAb;IACAxI,eAAO0B,MAAP,GAAgB,UAAU1B,OAAO0B,MAAjC;;IAEA;IACA,YAAG1B,OAAO2I,MAAP,KAAkB,WAArB,EACI3I,OAAO2I,MAAP,GAAgB,QAAhB;IACJ,YAAG3I,OAAO0I,OAAP,KAAmB,WAAtB,EACI1I,OAAO0I,OAAP,GAAiB,QAAjB;;IAEJ,eAAOlU,MAAM3D,SAAK8P,cAAL,CAAoBX,MAApB,EAA4BxL,GAA5B,EAAiC,IAAjC,CAAN,GAA+C,QAA/C,GAA0D0L,IAAjE;IACH,KArFgC;;IAuFjCgH,eAAW,mBAAUlH,MAAV,EAAkBmH,QAAlB,EAA4B;IACnCnhB,mBAAO,KAAKwiB,UAAZ,EAAwBxI,MAAxB;IACA,YAAI,CAACmH,QAAL,EAAe;IACX,iBAAKC,MAAL;IACH;IACD,eAAO,IAAP;IACH;IA7FgC,CAAjB,CAApB;;AAiGAnI,kBAAU8J,IAAV,GAAiBZ,aAAjB;AACA5E,kBAAUxM,IAAV,GAAiB,UAAUvC,GAAV,EAAevO,OAAf,EAAwB;IACrC,WAAO,IAAIgZ,cAAU8J,IAAd,CAAmBvU,GAAnB,EAAwBvO,OAAxB,CAAP;IACH,CAFD;;ICvGA;;;;IAIA,SAAS+iB,eAAT,CAAyBjf,KAAzB,EAAgC;;IAE5B,WAAO,IAAIkV,aAAJ,CAAc,oDAAd,EAAoE;IACvEgK,iBAAS,CAD8D,EAC3DC,SAAS,EADkD;IAEvEC,qBAAa;IAF0D,KAApE,CAAP;IAIH;;;;;;ICUD;;;;IAIA,SAASC,oBAAT,CAA8B7U,OAA9B,EAAuC;;IAEnC,QAAG,CAACA,OAAD,IAAY,OAAOA,QAAQpI,KAAf,KAA0B,UAAzC,EAAqD;IACjD,cAAM,IAAIuQ,KAAJ,CAAU,sCAAV,CAAN;IACH;;IAED,WAAO,SAASH,oBAAT,CAA8B7T,EAA9B,EAAkC;IACrC,eAAO6L,QAAQpI,KAAR,CAAczD,EAAd,EAAkB4J,KAAlB,CAAwB,aAAK;IAChC,gBAAIiM,qDAAmD7V,EAAnD,WAA2DkB,EAAEuL,OAAjE;IACA,mBAAO5C,EAAEC,MAAF,CAAU,IAAIkK,KAAJ,CAAU6B,GAAV,CAAV,CAAP;IACH,SAHM,CAAP;IAIH,KALD;IAMH;;QAUK8K;IAEF,4BAAc;IAAA;;IACV,aAAKC,SAAL,GAAiB,EAAjB,CADU;IAEV,aAAKC,IAAL;IACH;;;;qCAEQhe,IAAI;IACT,gBAAG,OAAOA,EAAP,KAAe,UAAlB,EAA8B;IAC1B,qBAAK+d,SAAL,CAAetP,IAAf,CAAoBzO,EAApB;IACH;IACJ;;;4CAEegJ,SAAS;IACrB,iBAAKA,OAAL,GAAeA,OAAf;IACH;;IAED;;;;;;+CAGmB;IACf,gBAAG,CAAC,KAAKA,OAAN,IAAiB,OAAO,KAAKA,OAAL,CAAapI,KAApB,KAA+B,WAAnD,EAAgE;IAC5D,qBAAKoI,OAAL,GAAe,IAAIjD,8BAAJ,CAAiBG,yBAAOQ,MAAxB,EAAgC,IAAIT,kCAAJ,EAAhC,CAAf;IACH;IACD,mBAAO4X,qBAAqB,KAAK7U,OAA1B,CAAP;IACH;;IAED;;;;;;;mCAIOxK,OAAO;IACV,gBAAG,CAACA,KAAJ,EAAW;IACP,sBAAM,IAAI2S,KAAJ,CAAU,qCAAV,CAAN;IACH;IACD,iBAAI,IAAI7H,IAAE,CAAV,EAAaA,IAAE,KAAKyU,SAAL,CAAe9iB,MAA9B,EAAsC,EAAEqO,CAAxC,EAA2C;IACvC,oBAAItJ,KAAK,KAAK+d,SAAL,CAAezU,CAAf,CAAT;IACA,oBAAIwB,SAAS9K,MAAM,OAAOA,EAAP,KAAa,UAAnB,IAAiCA,GAAGxB,KAAH,CAA9C;IACA,oBAAGsM,MAAH,EAAW,OAAOA,MAAP;IACd;IACD,mBAAO,IAAP;IACH;;;mCAGO;IAAA;;IAEJ;IACA,iBAAKmT,QAAL,CAAc,UAACzf,KAAD,EAAU;IACpB,oBAAGA,SAASA,MAAM4H,aAAf,IACC5H,MAAM4H,aAAN,CAAoBnL,MADrB,IAEC,CAACuD,MAAM4H,aAAN,CAAoBC,OAApB,CAA4B,mDAA5B,CAFL,EAEuF;IACnF,2BAAOoX,iBAAP;IACH;IACJ,aAND;;IAQA;IACA,iBAAKQ,QAAL,CAAe,UAACzf,KAAD,EAAW;IACtB,oBAAG,CAACA,KAAD,IAAU,CAACA,MAAMuU,QAAjB,IAA6B,CAACvU,MAAMuU,QAAN,CAAe9X,MAAhD,EAAwD,OAAO,IAAP;IACxD,oBAAI+N,UAAUxK,MAAMuU,QAAN,CAAe,CAAf,CAAd;IAAA,oBACI9J,MAAUD,QAAQ5I,IADtB;IAAA,oBAEI8d,UAAUlV,QAAQmV,WAAR,GAAsBnV,QAAQmV,WAAR,CAAoBC,GAA1C,GAAgD,IAF9D;IAAA,oBAGI1J,MAAUlW,MAAM6f,YAAN,GAAqB7f,MAAM6f,YAAN,CAAmB,CAAnB,CAArB,GAA6C,IAH3D;IAAA,oBAIIpL,SAAUzU,MAAM0U,gBAAN,GAAyB1U,MAAM0U,gBAAN,CAAuB,CAAvB,CAAzB,GAAqD,IAJnE;IAAA,oBAKIC,OAAO,EALX;;IAOA,yBAASmL,QAAT,CAAkBrV,GAAlB,EAAuB;IACnB,wBAAG,CAACA,GAAJ,EAAS,MAAM,IAAIkI,KAAJ,CAAU,+CAAV,CAAN;IACZ;;IAED,oBAAGoN,MAAanW,eAAb,IACCmW,MAAanW,eAAb,CAA6BgW,GAA7B,KAAqCF,OADzC,EACkD;IAC9CI,6BAASrV,GAAT;IACAkK,2BAAO;IACHgD,gCAAQ3X,MAAM4U,SADX;IAEHgD,qCAAa,IAFV;IAGHnD,gCAAQA,UAAU;IAHf,qBAAP;IAKA,wBAAGyB,GAAH,EAAQvB,KAAKuB,GAAL,GAAWA,GAAX;IACR,wBAAGxO,yBAAOkG,WAAV,EACI+G,KAAK9G,IAAL,GAAYnG,yBAAOkG,WAAnB;IACJ,2BAAO,IAAIoS,aAAJ,CAAkBvV,GAAlB,EAAuBkK,IAAvB,CAAP;IAEH,iBAbD,MAaO,IAAGoL,MAAarW,mBAAb,IACNqW,MAAarW,mBAAb,CAAiCkW,GAAjC,KAAyCF,OADtC,EAC+C;IAClDI,6BAASrV,GAAT;IACA,2BAAO6J,kBAAkBtU,KAAlB,EAAyB;IAC5BwT,uCAAe,MAAKyM,gBAAL;IADa,qBAAzB,CAAP;IAIH,iBAPM,MAOA,IAAGF,MAAalW,gBAAb,IACNkW,MAAalW,gBAAb,CAA8B+V,GAA9B,KAAsCF,OADnC,EAC4C;IAC/CI,6BAASrV,GAAT;IACAkK,2BAAO,EAAElK,KAAKA,GAAP,EAAYyV,SAAS,IAArB,EAAP;IACA,wBAAGxY,yBAAOkG,WAAV,EACI+G,KAAK9G,IAAL,GAAYnG,yBAAOkG,WAAnB;IACJ,2BAAOZ,kBAAA,CAAmB2H,IAAnB,CAAP;IAEH,iBARM,MAQA,IAAGoL,MAAapW,iBAAb,IACNoW,MAAapW,iBAAb,CAA+BiW,GAA/B,KAAuCF,OADpC,EAC6C;IAChD/K,2BAAO,EAAElK,KAAKA,GAAP,EAAYyV,SAAS,IAArB,EAAP;IACA,wBAAGxY,yBAAOkG,WAAV,EACI+G,KAAK9G,IAAL,GAAYnG,yBAAOkG,WAAnB;IACJ,2BAAOZ,kBAAA,CAAmB2H,IAAnB,CAAP;IAEH;IACD,uBAAO,IAAP;IACH,aAlDD;;IAoDA;IACA,iBAAK8K,QAAL,CAAe,UAACzf,KAAD,EAAW;IACtB,oBAAG,CAACA,KAAD,IAAU,CAACA,MAAMuU,QAAjB,IAA6B,CAACvU,MAAMuU,QAAN,CAAe9X,MAAhD,EAAwD,OAAO,IAAP;IACxD,oBAAI+N,UAAUxK,MAAMuU,QAAN,CAAe,CAAf,CAAd;IAAA,oBACImL,UAAUlV,QAAQmV,WAAR,GAAsBnV,QAAQmV,WAAR,CAAoBC,GAA1C,GAAgD,IAD9D;IAEA,oBAAGG,MAAa7V,GAAb,IAAoB6V,MAAa7V,GAAb,CAAiB0V,GAAjB,KAAyBF,OAAhD,EAAyD;IACrD,2BAAOtI,IAAIpX,KAAJ,CAAP;IACH,iBAFD,MAEO,IAAG+f,MAAa3V,IAAb,IAAqB2V,MAAa3V,IAAb,CAAkBwV,GAAlB,KAA0BF,OAAlD,EAA2D;IAC9D,2BAAO9G,KAAK5Y,KAAL,CAAP;IACH,iBAFM,MAEA,IAAG+f,MAAa5V,IAAb,IAAqB4V,MAAa5V,IAAb,CAAkByV,GAAlB,KAA0BF,OAAlD,EAA2D;IAC9D,2BAAOjC,KAAKzd,KAAL,CAAP;IACH;IACD,uBAAO,IAAP;IACH,aAZD;;IAeA,iBAAKyf,QAAL,CAAe,UAACzf,KAAD,EAAW;IACtB,oBAAG,CAACA,KAAD,IAAU,CAACA,MAAMuU,QAAjB,IAA6B,CAACvU,MAAMuU,QAAN,CAAe9X,MAAhD,EAAwD,OAAO,IAAP;IACxD,oBAAI+N,UAAUxK,MAAMuU,QAAN,CAAe,CAAf,CAAd;IAAA,oBACImL,UAAUlV,QAAQmV,WAAR,GAAsBnV,QAAQmV,WAAR,CAAoBC,GAA1C,GAAgD,IAD9D;IAEA,oBAAGG,MAAa1V,IAAb,IAAqB0V,MAAa1V,IAAb,CAAkBuV,GAAlB,KAA0BF,OAAlD,EAA2D;IACvD,2BAAO7K,YAAY7U,KAAZ,EAAmB;IACtBwT,uCAAe,MAAKyM,gBAAL;IADO,qBAAnB,CAAP;IAGH;IACD,uBAAO,IAAP;IACH,aAVD;;IAgBA,iBAAKR,QAAL,CAAe,UAACzf,KAAD,EAAW;;IAEtB,oBAAG,CAACA,KAAJ,EAAW,OAAO,IAAP;;IAEX,oBAAMmgB,SAAS,gEAAf;IACA,oBAAIvY,gBAAgB5H,MAAM4H,aAAN,IAAuB,EAA3C;IACA,oBAAGA,cAAcC,OAAd,CAAsBsY,MAAtB,IAAgC,CAAnC,EAAsC;IAAE;IACpC,2BAAO,IAAP;IACH;;IAED,oBAAIve,OAAO5B,MAAM4B,IAAjB;IACA,oBAAG,CAACA,IAAD,IAASA,KAAKiG,OAAL,CAAa,MAAb,IAAuB,CAAnC,EAAsC;IAClCzK,4BAAQsN,GAAR,CAAY,oDAAZ;IACA,2BAAO,IAAP,CAFkC;IAGrC;;IAED;IACA,oBAAI,OAAO+F,cAAP,KAAyB,WAAzB,IACA,OAAOA,cAAA,CAAa2P,QAApB,KAAkC,WADtC,EACmD;IAC/ChjB,4BAAQsN,GAAR,CAAY,sDAAZ;IACA,2BAAO,IAAP;IACH;;IAED;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,oBAAIiK,OAAO;IACb0L,qCAAiB5P,UAAA,CAAS6P;IACpB;IACN;IAHa,iBAAX;IAKA,oBAAG5Y,yBAAOkG,WAAV,EAAuB+G,KAAK9G,IAAL,GAAYnG,yBAAOkG,WAAnB;IAC1B,uBAAO6C,cAAA,CAAa2P,QAAb,CAAsBxe,IAAtB,EAA4B+S,IAA5B,CAAP;IAEA,aAxCD;IA0CH;;;;;;AAGL,yBAAe,IAAI2K,YAAJ,EAAf;;IA8BA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;;;;;;;;;ICrVA,IAAMiB,YAAYjZ,2BAAkBiZ,SAApC;IACA,IAAMC,iBAAiBlZ,2BAAkBkZ,cAAzC;IACA,IAAMhZ,eAAaF,2BAAkBG,gBAArC;IACA,IAAMC,WAASJ,2BAAkBI,MAAjC;;QAGM+Y;IAEF,wBAAc;IAAA;;IACV;IACA,aAAKC,UAAL,GAAkB,EAAlB;IACH;;;;+BAEG1V,MAAM2V,UAAU;IAChB,gBAAG,CAAC,KAAKD,UAAL,CAAgB1V,IAAhB,CAAJ,EACI,KAAK0V,UAAL,CAAgB1V,IAAhB,IAAwB,EAAxB;IACJ,iBAAK0V,UAAL,CAAgB1V,IAAhB,EAAsBiF,IAAtB,CAA2B0Q,QAA3B;IACH;;;gCAEI3V,MAAM2V,UAAU;IACjB,gBAAG,CAAC3V,IAAJ,EAAU,KAAK0V,UAAL,GAAkB,EAAlB;IACV,gBAAG,CAAC,KAAKA,UAAL,CAAgB1V,IAAhB,CAAJ,EAA2B;IAC3B,gBAAG,CAAC2V,QAAJ,EAAc,KAAKD,UAAL,CAAgB1V,IAAhB,IAAwB,EAAxB,CAAd,KACK;IACD,oBAAI4V,MAAM,KAAKF,UAAL,CAAgB1V,IAAhB,EAAsBnD,OAAtB,CAA8B8Y,QAA9B,CAAV;IACA,oBAAGC,OAAO,CAAV,EACI,KAAKF,UAAL,CAAgB1V,IAAhB,EAAsB6V,MAAtB,CAA6BD,GAA7B,EAAkC,CAAlC;IACP;IACJ;;;mCAEM5V,MAAM;IACT,gBAAG,CAAC,KAAK0V,UAAL,CAAgB1V,IAAhB,CAAJ,EAA2B;IAC3B,gBAAI8V,OAAOvD,MAAM/e,SAAN,CAAgBuiB,KAAhB,CAAsBtiB,IAAtB,CAA2Bqb,SAA3B,EAAsC,CAAtC,CAAX;IACA,iBAAK4G,UAAL,CAAgB1V,IAAhB,EAAsB+S,IAAtB,CAA2B,UAASiD,CAAT,EAAY;IAAEA,kBAAEC,KAAF,CAAQ,IAAR,EAAcH,IAAd;IAAsB,aAA/D;IACH;;;;;;QAMCI;;;IAEF,yBAAY/hB,GAAZ,EAAiB;IAAA;;IAAA;;IAGb,cAAKgiB,aAAL,CAAmB,IAAI3Z,YAAJ,EAAnB;IACA,cAAK4Z,iBAAL,CAAuBZ,cAAvB;;IAEA;IACA,cAAK7P,IAAL,GAAYxR,OAAOyG,KAAKyb,IAAL,CAAUzb,KAAKgL,MAAL,KAAc,IAAxB,CAAnB;;IAEA;IACA,cAAK0Q,MAAL,GAAc,IAAd,QAGKC,OAAL,GAAe,MAAKC,uBAAL,EAHf,QAMKC,YAAL,GAAoB,IANpB,QASKC,cAAL,GAAsB,IATtB,QAYKC,aAAL,GAAqB,IAZrB,EAaA,MAAK5J,UAAL,GAAkB,IAblB,QAgBK6J,YAAL,GAAoB,EAhBpB,QAmBKC,WAAL,GAAmB,EAnBnB,QAsBKC,YAAL,GAAmB,EAtBnB,EAuBA,MAAKC,kBAAL,GAA0B,UAASliB,CAAT,EAAY;IAClCzC,oBAAQsN,GAAR,+CAAwD7K,EAAElB,EAA1D,WAAkEkB,EAAEuL,OAApE;IACH,SAzBD,QA4BK4W,aAAL,GAAqB,IA5BrB,EA6BA,MAAKC,oBAAL,GAA4B,IA7B5B,QAgCKC,MAAL,GAAc,EAhCd,QAmCKC,KAAL,GAAa,EAAEC,OAAO,KAAT,EAnCb,CAVa;;;IAgDb,cAAKC,iBAAL,GAAyB;IACrBjgB,mBAAO,eAASkJ,OAAT,EAAkB;IACrB,oBAAGA,QAAQI,UAAR,CAAmBtJ,KAAtB,EACI,OAAOkJ,QAAQI,UAAR,CAAmBtJ,KAA1B;IACP,aAJoB;IAKrB0M,2BAAe,uBAASxD,OAAT,EAAkBtL,KAAlB,EAAyB;;IAEpC,oBAAIoC,QAAQ,EAAEuB,QAAQ,CAAV,EAAaD,OAAO,MAApB,EAA4BiB,SAAS,GAArC,EAA0ChI,QAAQ,CAAlD,EAAqDuQ,WAAW,MAAhE,EAAwErI,aAAa,GAArF,EAAZ;IACA,oBAAG,CAACyG,QAAQ+C,QAAR,CAAiBrD,IAAjB,CAAsBnD,OAAtB,CAA8B,OAA9B,CAAJ,EAA4C;IACxCzF,0BAAMyC,WAAN,GAAoB,GAApB;IACH;;IAED,oBAAI0G,QAAQD,QAAQI,UAAR,GAAqBJ,QAAQI,UAAR,IAAsB,EAAvD;IACA,oBAAGJ,QAAQI,UAAR,CAAmB/M,EAAnB,KAA0BmG,SAA1B,IAAuCwG,QAAQI,UAAR,CAAmB/M,EAAnB,KAA0B,IAApE,EACI2M,QAAQI,UAAR,CAAmB/M,EAAnB,GAAwBiH,KAAK0W,KAAL,CAAW1W,KAAKgL,MAAL,KAAc,MAAzB,CAAxB;IACJtF,wBAAQI,UAAR,CAAmBT,KAAnB,GAA2BM,MAAMN,KAAN,IAAeM,MAAMhK,KAArB,IAA8BgK,MAAMU,IAApC,IAA4C,cAAcX,QAAQ+C,QAAR,CAAiBrD,IAA/B,GAAsC,UAA7G;IACAM,wBAAQI,UAAR,CAAmBW,WAAnB,GAAiCd,MAAMc,WAAN,IAAqBd,MAAM+W,IAA3B,IAAmC,mCAApE;IACAhX,wBAAQI,UAAR,CAAmBtJ,KAAnB,GAA2BmJ,MAAMnJ,KAAN,IAAeA,KAA1C;;IAEApC,sBAAMuiB,WAAN,CAAkBhX,MAAMN,KAAxB;IACA;;;;IAIH,aAxBoB;IAyBrB2D,0BAAc,sBAAUtD,OAAV,EAAmBhI,MAAnB,EAA2B;;IAErC,oBAAIlB,QAAQkJ,QAAQI,UAAR,CAAmBtJ,KAAnB,IAA4B,EAAxC;IACAA,sBAAMzF,MAAN,GAAeyF,MAAMzF,MAAN,IAAgB,CAA/B;IACAyF,sBAAMuB,MAAN,GAAevB,MAAMuB,MAAN,IAAgB,CAA/B;IACAvB,sBAAMsB,KAAN,GAActB,MAAMsB,KAAN,IAAe,MAA7B;IACAtB,sBAAMuC,OAAN,GAAgBvC,MAAMuC,OAAN,IAAiB,GAAjC;IACAvC,sBAAMyC,WAAN,GAAoBzC,MAAMuC,OAA1B;IACAvC,sBAAM8K,SAAN,GAAkB9K,MAAMsB,KAAxB;;IAEA,oBAAG,CAAC+M,CAAJ,EAAO;IACH,0BAAM,IAAIkC,KAAJ,CAAU,0BAAV,CAAN;IACH;IACD,uBAAO6P,iBAAalf,MAAb,EAAqBlB,KAArB,CAAP;IACH;IAvCoB,SAAzB;;IAhDa;IA0FhB;;;;sCAEU;IACP,iBAAKqgB,UAAL;IACA,iBAAKC,QAAL,GAAgB,IAAhB;IACA,iBAAKC,cAAL,GAAsB,IAAtB;IACA,iBAAKC,UAAL,GAAkB,IAAlB;IACA,iBAAKjS,IAAL,GAAY,IAAZ;IACA,iBAAK2Q,MAAL,GAAc,IAAd;IACA,iBAAKC,OAAL,GAAe,IAAf;IACA,iBAAKE,YAAL,GAAoB,IAApB;IACA,iBAAKC,cAAL,GAAsB,IAAtB;IACA,iBAAKC,aAAL,GAAqB,IAArB;IACA,iBAAK5J,UAAL,GAAkB,IAAlB;IACA,iBAAK6J,YAAL,GAAoB,IAApB;IACA,iBAAKC,WAAL,GAAmB,IAAnB;IACA,iBAAKC,YAAL,GAAmB,IAAnB;IACA,iBAAKE,aAAL,GAAqB,IAArB;IACA,iBAAKC,oBAAL,GAA4B,IAA5B;IACA,iBAAKC,MAAL,GAAc,IAAd;IACA,iBAAKC,KAAL,GAAa,IAAb;IACA,iBAAKE,iBAAL,GAAyB,IAAzB;IACH;;;qCAGS;IACN,mBAAO,KAAK1R,IAAZ;IACH;;IAED;;;;;;;;uCAKWkS,YAAY;IACnB;;;IAGJ;;;;;;8CAGkBC,SAAS;IACvB,iBAAKJ,QAAL,GAAgB,EAAhB,CADuB;IAEvB,iBAAKC,cAAL,GAAsBG,OAAtB;IACH;;IAED;;;;;;0CAGcF,YAAY;IACtB,iBAAKF,QAAL,GAAgB,EAAhB,CADsB;IAEtB,iBAAKE,UAAL,GAAkBA,UAAlB;IACH;;IAED;;;;;;;uCAIW5X,MAAM;IACb,gBAAG,CAAC,KAAK0X,QAAL,CAAc1X,IAAd,CAAJ,EACI,KAAK0X,QAAL,CAAc1X,IAAd,IAAsB,KAAK2X,cAAL,CAAoB3X,IAApB,EAA0BtD,SAAOQ,MAAjC,EAAyC,KAAK0a,UAA9C,CAAtB;IACJ,mBAAO,KAAKF,QAAL,CAAc1X,IAAd,CAAP;IACH;;IAED;;;;;;4CAGgBxJ,IAAI;IAChB,iBAAKugB,kBAAL,GAA0BvgB,EAA1B;IACH;;IAGD;;;;+CACoBiS,SAAS;IACzB,gBAAG,CAACA,OAAJ,EAAa,OAAO,CAAC,CAAR;IACb,iBAAI,IAAI3I,IAAE,CAAV,EAAaA,IAAE,KAAK8W,YAAL,CAAkBnlB,MAAjC,EAAyC,EAAEqO,CAA3C,EAA8C;IAC1C,oBAAG,KAAK8W,YAAL,CAAkB9W,CAAlB,EAAqB9K,KAArB,IAA8ByT,YAAY,KAAKmO,YAAL,CAAkB9W,CAAlB,EAAqB9K,KAArB,CAA2BrB,EAAxE,EAA4E;IACxE,2BAAOmM,CAAP;IACH;IACJ;IACD,mBAAO,CAAC,CAAR;IACA;IACH;;;0CAEc2I,SAAS;IACpB,gBAAIxE,QAAQ,KAAK8T,kBAAL,CAAwBtP,OAAxB,CAAZ;IACA,mBAAOxE,SAAS,CAAT,GAAa,KAAK2S,YAAL,CAAkB3S,KAAlB,CAAb,GAAwC,IAA/C;IACH;IACD;;;;;sDAG0B;IACtB,mBAAO;IACHjE,sBAAMuV,UAAUyC,GADb;IAEHzhB,uBAAO,YAFJ;IAGH0J,uBAAO,YAHJ;IAIHoB,6BAAa,8BAJV;IAKH4W,2BAAW,IALR;IAMHC,2BAAW,KAAKvB,aANb;IAOHhK,wBAAQ,EAPL;IAQHwL,0BAAU,EARP;IASHC,wBAAQ,EATL;IAUHxb,+BAAe,CAAC,uDAAD;IAVZ,aAAP;IAYH;;IAED;;;;;;;kDAIsByb,UAAU;;IAE5BA,uBAAWA,YAAY,EAAvB;;IAEA;IACAA,qBAAS1L,MAAT,GAAkB,KAAKiK,YAAL,CAAkBb,KAAlB,CAAwB,CAAxB,CAAlB;IACA;IACAsC,qBAASH,SAAT,GAAqB,KAAKvB,aAA1B;;IAEA0B,qBAASC,WAAT,GAAuB,KAAKtB,aAAL,GACnB,EAAEzgB,OAAO,cAAT,EAAyBgiB,SAAS,KAAKvB,aAAL,CAAmBwB,SAAnB,EAAlC,EADmB,GACkD,IADzE;;IAGA;IACA,gBAAIC,SAAS,KAAKhC,YAAL,CAAkBrL,SAAlB,EAAb;IACAiN,qBAASI,MAAT,GAAkB;IACdC,sBAAMD,OAAOE,OAAP,EADQ;IAEdC,sBAAMH,OAAOI,QAAP,EAFQ;IAGdC,sBAAML,OAAOM,OAAP,EAHQ;IAIdC,sBAAMP,OAAOQ,QAAP;IAJQ,aAAlB;;IAOA,mBAAOZ,QAAP;IACH;;IAED;;;;;;oDAGwB;IACpB,gBAAG,CAAC,KAAK5B,YAAL,CAAkByC,WAAtB,EAAmC,OAAO,IAAP;IACnC,gBAAIC,WAAW,KAAK1C,YAAL,CAAkByC,WAAlB,CAA8BE,SAA7C;IACA,gBAAIC,UAAU,IAAd;IACA,iBAAI,IAAIllB,GAAR,IAAeglB,QAAf,EAAyB;IACrB,oBAAGA,SAAS/kB,cAAT,CAAwBD,GAAxB,CAAH,EAAiC;IAC7B,wBAAGglB,SAAShlB,GAAT,EAAcmlB,MAAjB,EAAyB;IACrBD,kCAAUF,SAAShlB,GAAT,CAAV;IACA;IACH;IACJ;IACJ;IACD,mBAAOklB,OAAP;IACH;;IAED;;;;;;6CAGiBhnB,OAAO;IACpB;IACA;IACA,gBAAG,CAAC,KAAKwkB,WAAT,EAAsB;IAClBzkB,wBAAQsN,GAAR,CAAY,yDAAyDrN,KAArE;IACA;IACH;IACD,gBAAI2C,QAAQ3C,MAAM6C,MAAlB;IACA,iBAAI,IAAIvB,EAAR,IAAc,KAAKkjB,WAAnB,EAAgC;IAC5B,oBAAG,KAAKA,WAAL,CAAiBljB,EAAjB,MAAyBqB,KAA5B,EAAmC;IAC/B,yBAAKukB,iBAAL,CAAuBlnB,KAAvB,EAA8BsB,EAA9B;IACA;IACH;IACJ;IACJ;;IAED;;;;;;;;8CAKkBtB,OAAOsB,IAAI;IAAA;;IAEzB,gBAAI6lB,SAAS,SAATA,MAAS,CAACxD,CAAD,EAAO;IAAE,uBAAOA,EAAEriB,EAAF,KAASA,EAAT,IAAgBqiB,EAAEhhB,KAAF,IAAWghB,EAAEhhB,KAAF,CAAQrB,EAAR,KAAeA,EAAjD;IAAuD,aAA7E;;IAEA,gBAAG,CAAC,KAAKmjB,YAAL,CAAkBhW,IAAlB,CAAuB0Y,MAAvB,CAAJ,EAAoC;;IAEhC,oBAAItU,MAAM,KAAKuU,aAAL,CAAmB9lB,EAAnB,EAAuB,aAAaA,EAAb,GAAkB,gCAAlB,GAC7B,0CADM,CAAV;;IAGA,oBAAI8L,MAAMpN,MAAMijB,IAAN,CAAWoE,GAArB;IACA,oBAAIzO,SAAS,EAACtX,IAAGA,EAAJ,EAAb;IACA8L,oBAAI+T,SAAJ,CAAc/T,IAAI5C,OAAJ,CAAY,GAAZ,IAAiB,CAA/B,EAAkC4C,IAAIhO,MAAtC,EAA8CkoB,KAA9C,CAAoD,GAApD,EAAyD5G,IAAzD,CAA8D,UAASE,KAAT,EAAgB;IAC1E,wBAAInR,IAAImR,MAAM0G,KAAN,CAAY,GAAZ,CAAR;IACA1O,2BAAOnJ,EAAE,CAAF,CAAP,IAAeA,EAAE,CAAF,CAAf;IACH,iBAHD;;IAKA,oBAAI/E,eAAe,KAAK6c,UAAL,CAAgBrE,UAAUsE,KAA1B,CAAnB;IACA,oBAAG9c,YAAH,EAAiB;IACbA,iCAAa+c,QAAb,CAAsBnmB,EAAtB,EAA0BsX,MAA1B,EACC1N,KADD,CACO,aAAK;IACR,4BAAIwc,MAAM,OAAKnD,YAAL,CAAkB9V,IAAlB,CAAuB0Y,MAAvB,CAAV;IACA,4BAAGO,GAAH,EAAQ;IACJ7U,gCAAI9E,OAAJ,GAAc,YAAY2Z,IAAI/kB,KAAJ,CAAUiL,KAAtB,GAA8B,+BAA9B,GACN,kBADM,GACepL,EAAEuL,OAD/B;IAEH;IACD,+BAAK4Z,MAAL,CAAY,aAAZ,EAA2B9U,GAA3B;IACH,qBARD;IASH;IACJ;IACJ;;IAED;;;;;;;0CAIcuD,SAASwR,UAAU;IAC7B;IACA;IACA,gBAAIlO,MAAM,EAAEpY,IAAI8U,OAAN,EAAerI,SAAS6Z,QAAxB,EAAV;IACA,iBAAKnD,YAAL,CAAkB7R,IAAlB,CAAuB8G,GAAvB;IACA,gBAAG,KAAKgL,kBAAR,EAA4B;IACxB,qBAAKA,kBAAL,CAAwBhL,GAAxB;IACH;IACD,mBAAOA,GAAP;IACH;;IAED;;;;kCAEOmO,OAAO;IACV,iBAAK/C,KAAL,CAAWC,KAAX,GAAmB,IAAnB;IACA,gBAAG8C,KAAH,EAAU;IACN,oBAAGpL,UAAUrd,MAAV,GAAmB,CAAtB,EAAyB;IACrB,yBAAKuoB,MAAL,CAAY/D,KAAZ,CAAkB,IAAlB,EAAwB1D,MAAM/e,SAAN,CAAgBuiB,KAAhB,CAAsBtiB,IAAtB,CAA2Bqb,SAA3B,CAAxB;IACH,iBAFD,MAGI,KAAKkL,MAAL,CAAYE,KAAZ;IACJ;IACH;IACD;IACH;;;oCACO;IACJ;IACA,iBAAK/C,KAAL,CAAWC,KAAX,GAAmB,KAAnB;IACH;IACD;;IAKA;;;;;;mCAIQllB,KAAK;IAAE,iBAAKukB,YAAL,GAAoBvkB,GAApB;IAA0B;;IAEzC;;;;;;qCAGU;IAAE,mBAAO,KAAKukB,YAAZ;IAA2B;;IAEvC;;;;+CACoB;IAAE,mBAAO,KAAKF,OAAZ;IAAsB;;IAE5C;;;;uCACY;IAAE,mBAAO,KAAKD,MAAZ;IAAqB;;IAEnC;;;;;;;;;oCAMSta,KAAKH,KAAK2U,MAAM;IACrB,gBAAIuD,IAAIvD,IAAR;IACA,gBAAG,OAAOuD,CAAP,KAAc,WAAjB,EACIA,IAAI,KAAK0C,YAAL,CAAkB1L,OAAlB,EAAJ;IACJ,iBAAK0L,YAAL,CAAkB0D,OAAlB,CAA0B,CAACne,GAAD,EAAKH,GAAL,CAA1B,EAAqCkY,CAArC;IACA,iBAAKqG,KAAL,CAAW,kBAAX;IACH;;IAED;;;;;;;sCAIW;IACP,gBAAIC,SAAS,KAAK5D,YAAL,CAAkB6D,SAAlB,EAAb;IACA,mBAAO,CAACD,OAAOre,GAAR,EAAaqe,OAAOxe,GAApB,CAAP;IACH;;IAED;;;;;;sCAGW;IACP,mBAAO,KAAK4a,YAAL,CAAkB1L,OAAlB,EAAP;IACH;;IAED;;;;;;;;4CAKiB;IACb,gBAAG,CAAC,KAAK0L,YAAT,EAAuB;IACvB,gBAAG,KAAKC,cAAR,EAAwB;IACpB,qBAAKD,YAAL,CAAkB8D,SAAlB,CAA4B,CACxB,CAAC,KAAK7D,cAAL,CAAoBkC,IAArB,EAA2B,KAAKlC,cAAL,CAAoBgC,IAA/C,CADwB,EAExB,CAAC,KAAKhC,cAAL,CAAoBsC,IAArB,EAA2B,KAAKtC,cAAL,CAAoBoC,IAA/C,CAFwB,CAA5B;IAIH,aALD,MAKO;IACH1mB,wBAAQsN,GAAR,CAAY,2DAAZ;IACA,qBAAK+W,YAAL,CAAkB0D,OAAlB,CAA0B,CAAC,EAAD,EAAK,CAAC,EAAN,CAA1B,EAAqC,CAArC;IACH;IACD,gBAAI;IACA,qBAAKC,KAAL,CAAW,kBAAX;IACH,aAFD,CAEE,OAAMvlB,CAAN,EAAS;IACd;;IAED;;;;;;sCAGU4jB,QAAQ;IACd,gBAAG,CAACA,MAAJ,EAAY;IACZ,gBAAI,OAAOA,OAAOC,IAAd,KAAwB,WAAxB,IACA,OAAOD,OAAOG,IAAd,KAAwB,WADxB,IAEA,OAAOH,OAAOK,IAAd,KAAwB,WAFxB,IAGA,OAAOL,OAAOO,IAAd,KAAwB,WAH5B,EAG0C;IACtC;IACA,qBAAKvC,YAAL,CAAkB8D,SAAlB,CAA4B,CACxB,CAAC9B,OAAOG,IAAR,EAAcH,OAAOC,IAArB,CADwB,EAExB,CAACD,OAAOO,IAAR,EAAcP,OAAOK,IAArB,CAFwB,CAA5B;IAIH,aATD,MASO,IAAG,OAAOL,OAAOE,OAAd,KAA2B,WAA9B,EAA2C;IAC9C;IACA,qBAAKlC,YAAL,CAAkB8D,SAAlB,CAA4B9B,MAA5B;IACH,aAHM,MAGA;IAGV;;IAGD;;;;IAKA;;;;;;yCAGczjB,OAAO;IAAA;;IAEjB,gBAAI4S,UAAU,IAAd;IACA,gBAAG,CAAC5S,KAAJ,EAAW;IACP4S,0BAAUjK,iBAAiBb,GAAjB,CAAqB,KAAK8c,UAAL,CAAgBrE,UAAUsE,KAA1B,CAArB,CAAV;IACH,aAFD,MAGIjS,UAAUpK,EAAEM,OAAF,CAAU9I,KAAV,CAAV;;IAEJ4S,oBAAQxK,IAAR,CAAc,iBAAS;;IAEnB,oBAAI0Q,eAAewG,eAAazhB,MAAb,CAAoBmC,KAApB,CAAnB;IACA,oBAAG,CAAC8Y,YAAJ,EAAkB;IACd1b,4BAAQsN,GAAR,CAAY,gDACR,aADQ,GACQ1K,MAAMrB,EADd,GACmB,GAD/B;IAEA;IACH;;IAED,uBAAK8iB,YAAL,CAAkBzQ,QAAlB,CAA2B8H,YAA3B;IACAA,6BAAa9J,SAAb,CAAuB,CAAvB,EAVmB;;IAYnB,oBAAIwW,eAAe,OAAKzN,UAAxB;IACA,oBAAGyN,YAAH,EAAiB;IACb,2BAAK/D,YAAL,CAAkBhd,WAAlB,CAA8B+gB,YAA9B;IACH;;IAED;IACA,uBAAKzN,UAAL,GAAkBe,YAAlB;IACA,uBAAK6I,aAAL,GAAqB3hB,KAArB;;IAEA;IACA,uBAAKolB,KAAL,CAAW,mBAAX,EAAgCplB,KAAhC,EAAuC8Y,YAAvC;IACA;IAEH,aAzBD,EA0BCvQ,KA1BD,CA0BO,aAAK;IACRnL,wBAAQsN,GAAR,sEAA+E7K,EAAEuL,OAAjF;IACA,uBAAKqZ,aAAL,CAAoBzkB,MAAMrB,EAA1B,EAA8B,oCAC1B,qCAD0B,GACckB,EAAEuL,OAD9C;IAEH,aA9BD;IA+BH;;IAED;;;IAGA;IACA;IACA;;;;2CAEgB;IAAE,mBAAO,KAAKuW,aAAZ;IAA4B;;IAE9C;;;;;;wCAGa;IAAE,mBAAO,KAAKC,YAAZ;IAA2B;;;6CAExB;IAAE,mBAAO,KAAKE,YAAZ;IAA2B;;;+CAE3B;IAChB,iBAAKA,YAAL,GAAoB,EAApB;IACA,iBAAKkD,MAAL,CAAY,aAAZ;IACH;;;4CAEgB;IACb,gBAAG,CAAC,KAAKnD,WAAT,EAAsB;IACtB,iBAAI,IAAI/W,IAAE,KAAK8W,YAAL,CAAkBnlB,MAAlB,GAAyB,CAAnC,EAAsCqO,KAAG,CAAzC,EAA4C,EAAEA,CAA9C,EAAiD;IAC7C,oBAAIqX,QAAQ,KAAKP,YAAL,CAAkB9W,CAAlB,CAAZ;IACA,oBAAI2a,gBAAgB,KAAK5D,WAAL,CAAiBM,MAAMniB,KAAN,CAAYrB,EAA7B,CAApB;IACA,oBAAG8mB,aAAH,EAAkB;IACdA,kCAAc/kB,GAAd,CAAkB,aAAlB;IACA,yBAAKmhB,WAAL,CAAiBM,MAAMniB,KAAN,CAAYrB,EAA7B,IAAmC,IAAnC;IACA,yBAAK8iB,YAAL,CAAkBhd,WAAlB,CAA8BghB,aAA9B;IACH;IACJ;IACD,iBAAK7D,YAAL,GAAoB,EAApB;IACA,iBAAKwD,KAAL,CAAW,gBAAX;;IAEA;IACH;;IAED;;;;;;sCAGWzN,QAAQ;IAAA;;IACf,gBAAG,CAAC,KAAKkK,WAAT,EAAsB;IAClBzkB,wBAAQsN,GAAR,CAAY,kDAAZ;IACA;IACH;;IAED,gBAAG,CAAC,KAAKmX,WAAT,EAAsB;IAClBzkB,wBAAQsN,GAAR,CAAY,6DAAZ;IACA;IACH;;IAED,gBAAG,CAACiN,MAAJ,EAAY;IACZ,gBAAG,OAAOA,OAAO1H,IAAd,KAAwB,WAA3B,EAAwC;IACpC0H,yBAAS,CAACA,MAAD,CAAT;IACH;;IAEDA,mBAAOM,OAAP,CAAgB,UAAC/H,GAAD,EAAKjB,KAAL,EAAe;;IAE3B,oBAAIjP,QAAQ,IAAZ;IAAA,oBAAkBmiB,QAAQ,IAA1B;;IAEA,oBAAGjS,IAAIlF,IAAJ,IAAYkF,IAAIlF,IAAJ,KAAWuV,UAAUsE,KAApC,EAA2C;IAAE;IACzC7kB,4BAAQkQ,GAAR;IACH,iBAFD,MAEO,IAAGA,IAAIlQ,KAAP,EAAc;IAAG;IACpBA,4BAAQkQ,IAAIlQ,KAAZ,CADiB;IAEjBmiB,4BAAQjS,GAAR;IACH;;IAED,oBAAG,CAAClQ,KAAJ,EAAW;IACP5C,4BAAQsN,GAAR,CAAY,sCAAsCuE,KAAtC,GACR,gDADJ;IAEA,2BAHO;IAIV;;IAED;IACA,oBAAG,OAAK4S,WAAL,CAAiB7hB,MAAMrB,EAAvB,CAAH,EAA+B;;IAE/B,oBAAG,CAACwjB,KAAJ,EAAW;IACP,wBAAI;IACA;IACA;IACA,4BAAIuD,YAAYvR,KAAKwR,KAAL,CAAWxR,KAAKC,SAAL,CAAepU,KAAf,CAAX,CAAhB;IACAmiB,gCAAQ;IACJxd,qCAAS,CADL;IAEJihB,wCAAY,IAFR;IAGJ5lB,mCAAO0lB;IAHH,yBAAR;IAKH,qBATD,CASE,OAAM7lB,CAAN,EAAS;IACP,8BAAM,IAAI8S,KAAJ,CAAU,2CAA2C9S,EAAEuL,OAAvD,CAAN;IACH;IACJ;;IAED,oBAAI2T,IAAIpH,OAAOlb,MAAP,GAAgBwS,KAAxB;IACAkT,sBAAMpT,MAAN,GAAegQ,CAAf;;IAEA,uBAAK8G,iBAAL,CAAuB7lB,KAAvB,EAA8BmiB,KAA9B;IAEH,aAxCD;;IA0CA,iBAAKiD,KAAL,CAAW,gBAAX;IACH;;IAED;;;;;;;8CAIkBplB,OAAOmiB,OAAO;IAAA;;IAE5B,gBAAIrJ,eAAe,IAAnB;IACA,gBAAI;IACA,oBAAG,CAAC9Y,KAAD,IAAU,CAACmiB,KAAd,EACI,MAAM,IAAIxP,KAAJ,CAAU,8CAAV,CAAN;;IAEJmG,+BAAewG,eAAazhB,MAAb,CAAoBmC,KAApB,CAAf;IACA,oBAAG,CAAC8Y,YAAJ,EAAkB;IACd,0BAAM,IAAInG,KAAJ,CAAU,kDACZ3S,MAAMrB,EADM,GACD,GADT,CAAN;IAEH;IAEJ,aAVD,CAUE,OAAMkB,CAAN,EAAS;IACP,qBAAK4kB,aAAL,CAAoBzkB,MAAMrB,EAA1B,EACI,YAAYqB,MAAMiL,KAAlB,GAA0B,8BAA1B,GACA,gBADA,GACmBpL,EAAEuL,OAFzB;IAGH;;IAED,gBAAG,CAAC0N,YAAJ,EAAkB;;IAElB;IACA,gBAAG,KAAK+I,WAAR,EAAqB,KAAKA,WAAL,CAAiB7hB,MAAMrB,EAAvB,IAA6Bma,YAA7B;;IAErB;IACA;IACAA,yBAAa1Y,EAAb,CAAgB,WAAhB,EAA6B,UAACP,CAAD,EAAO;IAAE,uBAAKimB,gBAAL,CAAsBjmB,CAAtB;IAA2B,aAAjE;;IAEA,iBAAK4hB,YAAL,CAAkBzQ,QAAlB,CAA2B8H,YAA3B;;IAEA,gBAAI,CAAC7E,MAAMkO,MAAMpT,MAAZ,CAAD,IAAwB+J,aAAa9J,SAAzC,EACI8J,aAAa9J,SAAb,CAAuBmT,MAAMpT,MAA7B;;IAEJ,iBAAK6S,YAAL,CAAkB3R,IAAlB,CAAuBkS,KAAvB;;IAEA,iBAAK6C,MAAL,CAAY,aAAZ,EAA2BhlB,KAA3B,EAAkC8Y,YAAlC;;IAGA;IACA;IACA,gBAAG,CAACqJ,MAAMyD,UAAP,IAAqBzD,MAAMxd,OAAN,GAAgB,CAAxC,EAA2C;IACvC;IACA;IACA0P,2BAAY,UAACrU,KAAD,EAAQmiB,KAAR,EAAkB;IAC1B,2BAAK4D,kBAAL,CAAwB/lB,KAAxB,EAA+BmiB,MAAMyD,UAArC;IACA,2BAAKI,eAAL,CAAqBhmB,KAArB,EAA4BmiB,MAAMxd,OAAlC;IACA;;IAEA;IACA;IACH,iBAPD,EAOG,IAPH,EAOSmU,YAPT,EAOuBqJ,KAPvB;IAQH;IACJ;;IAED;;;;;;;sCAIW8D,MAAMpM,IAAI;IACjB,gBAAG,CAAC,KAAKgI,WAAT,EAAsB;;IAEtB,gBAAG,CAAC,KAAKA,WAAT,EAAsB;;IAEtB,gBAAG5N,MAAMgS,IAAN,CAAH,EAAgB;;IAEhB;IACA,gBAAGhS,MAAM4F,EAAN,CAAH,EAAcA,KAAK,KAAK+H,YAAL,CAAkBnlB,MAAlB,GAAyB,CAA9B;;IAEd,gBAAIypB,OAAO,KAAKtE,YAAL,CAAkBf,MAAlB,CAAyBoF,IAAzB,EAA+B,CAA/B,EAAkC,CAAlC,CAAX,CAViB;IAWjB,iBAAKrE,YAAL,CAAkBf,MAAlB,CAAyBhH,EAAzB,EAA6B,CAA7B,EAAgCqM,IAAhC;;IAEA,iBAAI,IAAInH,IAAE,CAAN,EAASjU,IAAE,KAAK8W,YAAL,CAAkBnlB,MAAlB,GAAyB,CAAxC,EAA2CqO,KAAG,CAA9C,EAAiD,EAAEA,CAAF,EAAI,EAAEiU,CAAvD,EAA0D;IACtD,oBAAIoH,aAAa,KAAKvE,YAAL,CAAkB9W,CAAlB,CAAjB;IACA,oBAAI2a,gBAAgB,KAAK5D,WAAL,CAAkBsE,WAAWnmB,KAAX,CAAiBrB,EAAnC,CAApB;IACA,oBAAG8mB,aAAH,EAAkB;IACdA,kCAAczW,SAAd,CAAwB+P,CAAxB;IACAoH,+BAAWpX,MAAX,GAAoBgQ,CAApB;IACH;IACJ;;IAED,iBAAKqG,KAAL,CAAW,gBAAX,EAA6B,KAAKgB,SAAL,EAA7B;IACH;;IAED;;;;;;wCAGaznB,IAAI;;IAEb,gBAAG,CAAC,KAAKkjB,WAAT,EAAsB;IACtB,gBAAI4D,gBAAgB,KAAK5D,WAAL,CAAiBljB,EAAjB,CAApB;IACA,gBAAG8mB,aAAH,EAAkB;;IAEd;IACA,oBAAIxW,QAAQ,KAAK8T,kBAAL,CAAwBpkB,EAAxB,CAAZ;IACA;IACA,oBAAGsQ,SAAS,CAAT,IAAcA,QAAQ,KAAK2S,YAAL,CAAkBnlB,MAA3C,EACI,KAAKmlB,YAAL,CAAkBf,MAAlB,CAAyB5R,KAAzB,EAAgC,CAAhC;;IAEJ;IACAwW,8BAAc/kB,GAAd,CAAkB,aAAlB;;IAEA;IACA,qBAAK+gB,YAAL,CAAkBhd,WAAlB,CAA8BghB,aAA9B;;IAEA;IACA,qBAAK5D,WAAL,CAAiBljB,EAAjB,IAAuB,IAAvB;IACH;IACD,iBAAKymB,KAAL,CAAW,gBAAX;IACH;;IAED;;;;;;kDAGuBzmB,IAAI;IACvB,gBAAG,CAAC,KAAKkjB,WAAT,EAAsB;IACtB,gBAAI4D,gBAAgB,KAAK5D,WAAL,CAAiBljB,EAAjB,CAApB;IACA,gBAAG8mB,aAAH,EAAkB;IACd,oBAAItD,SAAQ,KAAKkE,aAAL,CAAmB1nB,EAAnB,CAAZ;IACAwjB,uBAAMyD,UAAN,GAAmB,CAACzD,OAAMyD,UAA1B;;IAEA,oBAAGH,cAAca,aAAjB,EAAgC;IAC5B;IACA;IACA;IACA;IACA;IACAb,kCAAcrW,UAAd,CAAyB+S,OAAMyD,UAAN,GAAmB,CAAnB,GAAuB,CAAhD;IACAzD,2BAAMxd,OAAN,GAAgB8gB,cAAcc,UAAd,EAAhB;IACA;IACH;;IAED,qBAAKR,kBAAL,CAAwBN,aAAxB,EAAuCtD,OAAMyD,UAA7C;IACH;IACJ;;IAED;;;;;;;;;;;+CAQoBH,eAAee,SAAS;;IAExC,gBAAGf,cAAc/R,aAAjB,EAAgC;IAC5B;IACA+R,8BAAc/R,aAAd,CAA4B8S,OAA5B;IAEH,aAJD,MAIO,IAAGf,cAAc9nB,UAAjB,EAA6B;IAChC;IACA,oBAAIM,KAAKkS,OAAOsV,cAAc9nB,UAArB,CAAT;IACA;IACA;IACAM,mBAAGiW,GAAH,CAAO,EAAC,WAAWsS,UAAU,EAAV,GAAe,MAA3B,EAAP;IACH;;IAED,iBAAKpB,KAAL,CAAW,mBAAX;IACH;;IAED;;;;;;+CAGoBzmB,IAAIgG,SAAS;;IAE7B,gBAAG,CAAC,KAAKkd,WAAT,EAAsB;IACtB,gBAAI4D,gBAAgB,KAAK5D,WAAL,CAAiBljB,EAAjB,CAApB;;IAEA;IACA,gBAAG,CAAC8mB,aAAD,IAAkB,KAAK9D,aAAL,CAAmBhjB,EAAnB,KAA0BA,EAA/C,EAAmD;IAC/C8mB,gCAAgB,KAAK1N,UAArB;IACH;;IAED;IACApT,sBAAU,KAAKqhB,eAAL,CAAqBP,aAArB,EAAoC9gB,OAApC,CAAV;;IAEA;IACA,gBAAIwd,QAAQ,KAAKkE,aAAL,CAAmB1nB,EAAnB,CAAZ;IACA,gBAAGwjB,KAAH,EAAUA,MAAMxd,OAAN,GAAgBA,OAAhB;IAEb;;IAED;;;;;;;;;;;;4CASiB8gB,eAAe9gB,SAAS;IACrC,gBAAG8gB,iBAAiBA,cAAcrW,UAAlC,EAA8C;IAC1C,oBAAGzK,UAAU,GAAb,EAAkBA,UAAUA,UAAU,KAApB;IAClB8gB,8BAAcrW,UAAd,CAAyBzK,OAAzB;IACA,qBAAKygB,KAAL,CAAW,mBAAX;IACH;IACD,mBAAOzgB,OAAP;IACH;;IAED;;;;;;;+CAIoBkU,SAAS;IACzB,gBAAG,CAACA,OAAD,IAAY,CAAC,KAAKgJ,WAArB,EAAkC,OAAO,IAAP;IAClC,gBAAI/I,eAAe,KAAK+I,WAAL,CAAiBhJ,QAAQla,EAAzB,CAAnB;IACA,mBAAOma,gBAAgB,IAAvB;IACH;;IAED;;;;;;iDAGsBrF,SAAS;IAC3B,gBAAG,CAAC,KAAKoO,WAAT,EAAsB;IACtB,gBAAI4D,gBAAgB,KAAK5D,WAAL,CAAiBpO,OAAjB,CAApB;IACA,gBAAGgS,aAAH,EAAkB;IACd,oBAAG,OAAOA,cAActQ,oBAArB,KAA+C,WAAlD,EAA+D;IAC3D,wBAAGsQ,cAAclQ,uBAAd,EAAH,EAA4C;IACxCkQ,sCAAcnQ,qBAAd;IACAnF,+BAAOsR,aAAa9jB,UAApB,EAAgC4B,WAAhC,CAA4C,mBAA5C;IACH,qBAHD,MAGO;IACHkmB,sCAActQ,oBAAd;IACAhF,+BAAOsR,aAAa9jB,UAApB,EAAgC0B,QAAhC,CAAyC,mBAAzC;IACH;IACJ;IAEJ;IACJ;;IAGD;;;;IAKA;;;;;;0CAGe;IACX,gBAAG,KAAK2iB,aAAR,EAAuB;IACnB,uBAAO,KAAKA,aAAL,CAAmBwB,SAAnB,GAA+BtS,QAAtC;IACH;IACD,mBAAO,EAAP;IACH;;IAED;;;;;;wCAGa1B,MAAM;;IAEf,gBAAG,CAACA,IAAJ,EAAU;;IAEV,gBAAG,OAAOA,KAAKS,IAAZ,KAAsB,WAAzB,EAAsC;IAClC;IACA,qBAAI,IAAInF,IAAE,CAAV,EAAaA,IAAE0E,KAAK/S,MAApB,EAA4B,EAAEqO,CAA9B;IACI,yBAAK2b,UAAL,CAAgBjX,KAAK1E,CAAL,CAAhB,EAAyB,KAAzB;IADJ,iBAEA,KAAKsa,KAAL,CAAW,kBAAX;IAEH,aAND,MAMO,IAAG5V,KAAK0B,QAAR,EAAkB;IACrB,qBAAKwV,WAAL,CAAiBlX,KAAK0B,QAAtB;IAEH,aAHM,MAGA;IAAE;IACL,qBAAKuV,UAAL,CAAgBjX,IAAhB,EAAsB,IAAtB;IACH;IAEJ;;IAED;;;;;;uCAGYA,MAAMmX,WAAW;IAAA;;IACzB;IACA;;IAEA,gBAAG,CAAClW,CAAJ,EAAO;IACH,sBAAM,IAAIkC,KAAJ,CAAU,0BAAV,CAAN;IACH;;IAED,gBAAG,CAAC,KAAKqP,aAAT,EAAwB;;IAEpB;IACA,qBAAKA,aAAL,GAAqB4E,mBAAe3jB,KAAf,CAAqB,KAAKwe,YAA1B,CAArB;IAEH;;IAED;IACA,gBAAI9M,OAAOxE,OAAOlU,MAAP,CAAc,EAAd,EAAkB,KAAKomB,iBAAvB,CAAX;IACAwE,wBAAQrX,IAAR,EAAcmF,IAAd,EAAoBlU,SAApB,CAA8B,UAACugB,CAAD;IAAA,uBAAK,OAAK8F,eAAL,CAAqB9F,CAArB,CAAL;IAAA,aAA9B;;IAEA,gBAAG,OAAO2F,SAAP,KAAsB,WAAtB,IAAqCA,cAAc,IAAtD,EACI,KAAKvB,KAAL,CAAW,kBAAX,EADJ,KAEK,KAAKA,KAAL;;IAEL;IAEH;;IAED;;;;;;0CAGe2B,aAAa;IACxB,gBAAI/mB,QAAQ,KAAKgnB,eAAL,CAAqBD,YAAYrb,UAAZ,CAAuB/M,EAA5C,CAAZ;IACA,gBAAGqB,KAAH,EAAU;;IAENA,sBAAMsL,OAAN,GAAgByb,WAAhB;;IAEA;IACA/mB,sBAAMgQ,QAAN,CAAe+W,YAAYrb,UAAZ,CAAuBtJ,KAAtC;;IAEA;IACA,oBAAI6I,QAAQ8b,YAAYrb,UAAZ,CAAuBT,KAAvB,IACR,cAAc8b,YAAY1Y,QAAZ,CAAqBrD,IAAnC,GAA0C,UAD9C;IAEAhL,sBAAMuiB,WAAN,CAAkBtX,KAAlB;;IAEA;IACA,qBAAKma,KAAL,CAAW,qBAAX;IACH;IACJ;;IAED;;;;;;;;;;2CAOgB2B,aAAa;IAAA;;IAEzB,gBAAG,CAACtW,CAAJ,EAAO;IACH,sBAAM,IAAIkC,KAAJ,CAAU,0BAAV,CAAN;IACH;;IAED;IACA,gBAAI3S,QAAQ,KAAKgnB,eAAL,CAAqBD,YAAYrb,UAAZ,CAAuB/M,EAA5C,CAAZ;IACA,gBAAGqB,KAAH,EAAU;;IAEN;IACA,qBAAKgiB,aAAL,CAAmBvd,WAAnB,CAA+BzE,KAA/B;;IAEA;IACA6mB,4BAAQE,WAAR,EAAqB,KAAK1E,iBAA1B,EACK5hB,SADL,CACe,UAACugB,CAAD;IAAA,2BAAK,OAAK8F,eAAL,CAAqB9F,CAArB,CAAL;IAAA,iBADf;;IAGA,qBAAKoE,KAAL,CAAW,qBAAX;IACH;IACJ;;IAED;;;;;;yCAGc6B,WAAW;IACrB,gBAAIjnB,QAAQ,KAAKgnB,eAAL,CAAqBC,SAArB,CAAZ;IACA,gBAAGjnB,KAAH,EAAU;IACN,oBAAI,OAAOA,MAAMoW,SAAb,KAA4B,WAAhC,EAA6C;IACzC,wBAAIqN,SAASzjB,MAAMoW,SAAN,EAAb;IACA,yBAAKqL,YAAL,CAAkB8D,SAAlB,CAA4B9B,MAA5B;IACH,iBAHD,MAGO,IAAG,OAAOzjB,MAAMknB,SAAb,KAA4B,WAA/B,EAA4C;IAC/C,wBAAI7B,SAASrlB,MAAMknB,SAAN,EAAb;IACA,yBAAKzF,YAAL,CAAkB0F,KAAlB,CAAwB9B,MAAxB;IACH,iBAHM,MAGA;IACHjoB,4BAAQsN,GAAR,CAAY,uFAAZ;IACH;IACJ,aAVD,MAUO;IACHtN,wBAAQsN,GAAR,CAAY,2EAAZ;IACH;IACJ;;IAED;;;;;;0CAGeuc,WAAW;IACtB,gBAAIjnB,QAAQ,KAAKgnB,eAAL,CAAqBC,SAArB,CAAZ;IACA,gBAAGjnB,SAAS,KAAKgiB,aAAjB,EAAgC;IAC5B,qBAAKA,aAAL,CAAmBvd,WAAnB,CAA+BzE,KAA/B;IACA,qBAAKolB,KAAL,CAAW,kBAAX;IACH;IACJ;;IAED;;;;;;6CAGkB;IACd,gBAAG,KAAKpD,aAAR,EAAuB;IACnB,qBAAKA,aAAL,CAAmB5e,WAAnB;IACA,qBAAKgiB,KAAL,CAAW,kBAAX;IACH;IACJ;;IAED;;;;;;4CAGiB6B,WAAW;IACxB,gBAAG,CAAC,KAAKjF,aAAT,EAAwB,OAAO,IAAP;;IAExB,gBAAI9Q,WAAW,KAAK8Q,aAAL,CAAmBoE,SAAnB,EAAf;IACA,iBAAI,IAAItb,IAAE,CAAV,EAAaA,IAAEoG,SAASzU,MAAxB,EAAgC,EAAEqO,CAAlC,EAAqC;IACjC,oBAAGoG,SAASpG,CAAT,EAAYQ,OAAZ,CAAoBI,UAApB,CAA+B/M,EAA/B,KAAsCsoB,SAAzC,EAAoD;IAChD,2BAAO/V,SAASpG,CAAT,CAAP;IACH;IACJ;IACD,mBAAO,IAAP;IACH;;;kDAEsB;IACnB,gBAAG,CAAC,KAAKkX,aAAT,EAAwB,OAAO,KAAP,CADL;;IAGnB,iBAAKC,oBAAL,GAA4B,CAAC,KAAKA,oBAAlC;IACA,iBAAKmF,yBAAL,CAA+B,KAAKpF,aAApC,EAAmD,KAAKC,oBAAxD;IACA,mBAAO,KAAKA,oBAAZ;IACH;;IAED;;;;;;;iDAIsB3W,SAASsa,YAAY;IACvC,iBAAKwB,yBAAL,CAA+B9b,OAA/B,EAAwCsa,UAAxC;IACH;;;yDAE6B;IAC1B,mBAAO,KAAK3D,oBAAZ;IACH;;IAGD;;;;;;;;;4CAMgBjiB,OAAO;IACnB,iBAAKqnB,gBAAL,CAAsBrnB,KAAtB;IACA,iBAAKolB,KAAL,CAAW,kBAAX;IACH;;IAED;;;;;;;6CAIiBplB,OAAO;IAAA;;IACpB,gBAAG,CAACyQ,CAAJ,EAAO;IACH,sBAAM,IAAIkC,KAAJ,CAAU,0BAAV,CAAN;IACH;IACD,gBAAG,CAAC3S,MAAMsL,OAAP,IAAkBtL,iBAAiBsnB,cAAtC,EAAkD;IAC9CtnB,sBAAMS,SAAN,CAAiB,UAAC8mB,KAAD,EAAW;IACxB,2BAAKF,gBAAL,CAAsBE,KAAtB;IACH,iBAFD;IAGH,aAJD,MAIO;IACH,qBAAKvF,aAAL,CAAmBhR,QAAnB,CAA4BhR,KAA5B;IACH;IACJ;;IAGD;;;;sDAC0BA,OAAO4lB,YAAY;IAAA;;IACzC,gBAAG,CAAC5lB,KAAJ,EAAW;IACX,iBAAKiiB,oBAAL,GAA4B2D,UAA5B;;IAEA,gBAAG5lB,MAAMomB,SAAT,EAAoB;IAChBpmB,sBAAMomB,SAAN,GAAkBrI,IAAlB,CAAwB,UAACwJ,KAAD,EAAW;IAC/B,2BAAKH,yBAAL,CAA+BG,KAA/B,EAAsC3B,UAAtC;IACH,iBAFD;IAIH,aALD,MAKO;IACH,oBAAIloB,YAAYsC,MAAMrC,UAAN,IAAoBqC,MAAMwnB,KAA1C;IACA,oBAAG9pB,SAAH,EACIA,UAAU0E,KAAV,CAAgB4R,OAAhB,GAA0B4R,aAAa,EAAb,GAAkB,MAA5C;IACP;IACJ;;IAID;;;;IAIA;;;;;;;iCAIMvC,UAAU;IACZ,mBAAO,KAAKoE,OAAL,CAAapE,QAAb,CAAP;IACH;;IAED;;;;;;oCAGSqE,IAAI;IAAA;;IAET,gBAAIrE,WAAWqE,MAAM,EAArB;;IAEA;IACA,gBAAMC,YAAY,uDAAlB;IACAtE,qBAASzb,aAAT,GAAyByb,SAASzb,aAAT,IAA0B,EAAnD;IACA,gBAAGyb,SAASzb,aAAT,CAAuBC,OAAvB,CAA+B8f,SAA/B,IAA4C,CAA/C,EACItE,SAASzb,aAAT,CAAuBqI,IAAvB,CAA4B0X,SAA5B;;IAEJ,gBAAIna,UAAU,KAAKoa,qBAAL,CAA2BvE,QAA3B,CAAd;;IAEA;IACA,gBAAG7V,QAAQjM,KAAR,IAAiBiM,QAAQjM,KAAR,KAAkBiM,QAAQvC,KAA9C,EAAqD;IACjDuC,wBAAQvC,KAAR,GAAgBuC,QAAQjM,KAAxB;IACH,aAFD,MAEO,IAAGiM,QAAQvC,KAAR,IAAiB,CAACuC,QAAQjM,KAA7B,EAAoC;IACvCiM,wBAAQjM,KAAR,GAAgBiM,QAAQvC,KAAxB;IACH;;IAED;IACA,mBAAO,KAAK2Z,UAAL,CAAgBrE,UAAUyC,GAA1B,EACN6E,IADM,CACDra,OADC,EAENpF,IAFM,CAEA,kBAAU;;IAEb;IACA,oBAAG,CAAC,QAAKkZ,MAAT,EACI,QAAKA,MAAL,GAAchV,OAAO3N,EAArB;;IAEJ,wBAAK4iB,OAAL,GAAejV,MAAf;IACA,wBAAKoV,cAAL,GAAsBpV,OAAOmX,MAA7B;IACA,wBAAKqE,KAAL;IACA,uBAAOxb,MAAP;IACH,aAZM,EAaN/D,KAbM,CAaA,eAAK;IACRnL,wBAAQsN,GAAR,CAAY,qCACR,gDADQ,GAC2CqM,IAAI3L,OAD3D;IAEA,oBAAIvL,IAAI,IAAI8S,KAAJ,CAAU,6EACdoE,IAAI3L,OADA,CAAR;IAEA,uBAAO5C,EAAEC,MAAF,CAAS5I,CAAT,CAAP;IACH,aAnBM,CAAP;IAqBH;;IAED;;;;;;;;qCAKUkoB,OAAO;IACb;IACA;IACA,mBAAO,KAAKnD,UAAL,CAAgBrE,UAAUyC,GAA1B,EAA+Blb,GAA/B,CAAmCigB,KAAnC,CAAP;IACH;;IAED;;;;;;;;;oCAMSA,OAAO;IAAA;;IAEZ,mBAAO,KAAKC,QAAL,CAAcD,KAAd,EAAqB3f,IAArB,CAA0B,eAAO;;IAEpC,oBAAG,CAAClL,GAAJ,EAAS;IACL,0BAAM,IAAIyV,KAAJ,CAAU,yBAAyBoV,KAAzB,GACZ,mBADE,CAAN;IAGH,iBAJD,MAIO,IAAG,OAAO7qB,GAAP,KAAgB,QAAnB,EAA6B;IAChC,0BAAM,IAAIyV,KAAJ,CAAU,yBAAyBoV,KAAzB,GACZ,0BADE,CAAN;IAGH,iBAJM,MAIA,IAAG7qB,IAAIkO,OAAP,EAAgB;IACnB,0BAAM,IAAIuH,KAAJ,CAAU,oDACZoV,KADY,GACJ,MADI,GACK7qB,IAAIkO,OADnB,CAAN;IAEH;;IAGD;IACA,oBAAG,kBAAkB1D,SAAOugB,GAA5B,EAAiC;;IAE7B5T,+BAAY,UAACnX,GAAD,EAAS;IACjB;IACA,4BAAIgrB,QAAQhrB,IAAIirB,UAAJ,GAAkBjrB,IAAIirB,UAAJ,CAAeC,QAAf,IAAyB,CAA3C,GAAgD,CAA5D;IACA,4BAAIC,QAAQ,CAAE,EAAEC,IAAI,SAAN,EAAiBC,MAAM,sBAAvB,EAA+CthB,OAAOihB,QAAM,CAA5D,EAAF,CAAZ;IACA,gCAAKtD,UAAL,CAAgBrE,UAAUyC,GAA1B,EAA+BqF,KAA/B,CAAqCnrB,IAAIyB,EAAzC,EAA6C0pB,KAA7C;IACA;IADA,yBAECjgB,IAFD,CAEO,mBAAW;IAAElL,gCAAIirB,UAAJ,GAAiBK,QAAQL,UAAzB;IAAsC,yBAF1D,EAGC5f,KAHD,CAGQ,aAAK;IACTnL,oCAAQsN,GAAR,CAAY,iDACR,kBADQ,GACaqd,KADb,GACqB,MADrB,GAC8BloB,CAD1C;IAEH,yBAND;IAOH,qBAXD,EAWG,IAXH,EAWS3C,GAXT;IAaH;;IAED;IACA,wBAAKurB,cAAL,CAAoBvrB,GAApB;;IAEA,uBAAOA,GAAP;IACH,aAtCM,EAuCNqL,KAvCM,CAuCC,eAAO;IACXnL,wBAAQsN,GAAR,CAAY,6BACR,gDADQ,GAC2CqM,IAAI3L,OAD3D;IAEA,oBAAIvL,IAAI,IAAI8S,KAAJ,CAAU,yBAAyBoV,KAAzB,GACd,4DADc,GAEdhR,IAAI3L,OAFA,CAAR;IAGA,uBAAO5C,EAAEC,MAAF,CAAS5I,CAAT,CAAP;IACH,aA9CM,CAAP;IA+CH;;IAGD;;;;;;;;2CAKgB3C,KAAK;IAAA;;IAEjB;IACA;;IAEA,iBAAKokB,MAAL,GAAcpkB,IAAIyB,EAAlB;IACA,iBAAK4iB,OAAL,GAAerkB,GAAf;;IAEAA,gBAAIumB,MAAJ,GAAa,KAAKiF,YAAL,CAAkBxrB,IAAIumB,MAAtB,CAAb;;IAEA;IACA,iBAAK/B,cAAL,GAAsBxkB,IAAIumB,MAA1B;IACA,gBAAIA,SAASvmB,IAAIumB,MAAjB;;IAEA;IACA,iBAAKhC,YAAL,CAAkBhhB,SAAlB,CAA4B,UAACugB,CAAD,EAAO;IAC/B,wBAAKS,YAAL,CAAkBhd,WAAlB,CAA8Buc,CAA9B;IACH,aAFD;IAGA,iBAAKa,WAAL,GAAmB,EAAnB;IACA,iBAAKD,YAAL,GAAoB,EAApB;;IAEA;IACA,iBAAK+G,YAAL,CAAkBzrB,IAAIgmB,SAAtB;;IAEA;IACA,iBAAKpR,SAAL,CAAe5U,IAAIya,MAAnB;;IAEA;IACA,gBAAGza,IAAIomB,WAAJ,IAAmBpmB,IAAIomB,WAAJ,CAAgBC,OAAtC,EAA+C;IAC3C,oBAAIqF,KAAK1rB,IAAIomB,WAAJ,CAAgBC,OAAzB;IACA,oBAAGqF,GAAG1X,QAAN,EACI,KAAKwV,WAAL,CAAiBkC,GAAG1X,QAApB,EADJ,KAGI,KAAKwV,WAAL,CAAiB,CAACkC,EAAD,CAAjB;IACP;;IAED,iBAAKnH,YAAL,CAAkB8D,SAAlB,CAA4B,CACxB,CAAC9B,OAAOG,IAAR,EAAcH,OAAOC,IAArB,CADwB,EAExB,CAACD,OAAOO,IAAR,EAAcP,OAAOK,IAArB,CAFwB,CAA5B;;IAKA,iBAAKgE,KAAL;IACA,iBAAK9C,MAAL,CAAY,YAAZ,EAA0B9nB,GAA1B;IAEH;;IAED;;;;;;;yCAIcumB,QAAS;;IAEnB,gBAAIoF,OAAQ,CAACpF,MAAD,IAAWxP,MAAMwP,OAAOC,IAAb,CAAX,GAAgC,CAAC,KAAjC,GAAyCD,OAAOC,IAAP,GAAY,GAAjE;IACA,gBAAIoF,OAAQ,CAACrF,MAAD,IAAWxP,MAAMwP,OAAOK,IAAb,CAAX,GAAiC,KAAjC,GAAyCL,OAAOK,IAAP,GAAY,GAAjE;IACA,gBAAIiF,QAAQ,CAACtF,MAAD,IAAWxP,MAAMwP,OAAOG,IAAb,CAAX,GAAiC,CAAC,IAAlC,GAAyCH,OAAOG,IAAP,GAAY,GAAjE;IACA,gBAAIoF,QAAQ,CAACvF,MAAD,IAAWxP,MAAMwP,OAAOO,IAAb,CAAX,GAAkC,IAAlC,GAAyCP,OAAOO,IAAP,GAAY,GAAjE;;IAEA;IACA,gBAAIiF,UAAJ;IACA,gBAAGJ,OAAOC,IAAV,EAAgB;IACZG,oBAAIrjB,KAAKsjB,GAAL,CAASL,IAAT,EAAeC,IAAf,CAAJ;IACAA,uBAAOljB,KAAKujB,GAAL,CAASN,IAAT,EAAeC,IAAf,CAAP;IACAD,uBAAOI,CAAP;IACH;IACD,gBAAGF,QAAQC,KAAX,EAAkB;IACdC,oBAAIrjB,KAAKsjB,GAAL,CAASH,KAAT,EAAgBC,KAAhB,CAAJ;IACAA,wBAAQpjB,KAAKujB,GAAL,CAASJ,KAAT,EAAgBC,KAAhB,CAAR;IACAD,wBAAQE,CAAR;IACH;;IAED;IACA,gBAAGJ,OAAO,CAAC,KAAX,EAAkBA,OAAO,CAAC,KAAR;IAClB,gBAAGC,OAAO,KAAV,EAAkBA,OAAQ,KAAR;IAClB,gBAAGC,QAAQ,CAAC,IAAZ,EAAkBA,QAAQ,CAAC,IAAT;IAClB,gBAAGC,QAAQ,IAAX,EAAkBA,QAAS,IAAT;;IAElB,mBAAO,EAAEtF,MAAOmF,IAAT,EAAejF,MAAOmF,KAAtB,EAA6BjF,MAAOgF,IAApC,EAA0C9E,MAAOgF,KAAjD,EAAP;IACH;;IAGD;;;;;;yCAGc;IACV;IACA,iBAAKvH,YAAL,GAAoB,IAApB;IACA,iBAAKI,WAAL,GAAmB,IAAnB;IACA,iBAAKD,YAAL,GAAoB,IAApB;IACA,iBAAKI,aAAL,GAAqB,IAArB;IACH;;IAED;;;;;;;;wCAKaoH,UAAU;IACnB,iBAAK9H,MAAL,GAAc,IAAd;IACA,iBAAKC,OAAL,GAAe6H,YAAY,KAAK5H,uBAAL,EAA3B;IACH;;IAGD;;;;;;yCAIc7iB,IAAI0qB,MAAM;IACpB,iBAAKnH,MAAL,CAAYvjB,EAAZ,IAAkB0qB,IAAlB;IACH;;;2CAEe1qB,IAAI;IAChB,iBAAKujB,MAAL,CAAYvjB,EAAZ,IAAkB,IAAlB;IACH;;;uCAEWA,IAAI2qB,QAAQ;IACpB,gBAAG,CAAC,KAAKpH,MAAL,CAAYvjB,EAAZ,CAAJ,EAAqB,OAAO,KAAP;IACrB,iBAAKujB,MAAL,CAAYvjB,EAAZ,EAAgB4qB,QAAhB,CAAyB,YAAW;IAChC,qBAAKvE,MAAL,CAAY,eAAZ,EAA6BrmB,EAA7B;IACH,aAFD;IAGA,iBAAKqmB,MAAL,CAAY,cAAZ,EAA4BrmB,EAA5B;IACH;;IAGD;;IAEA;;;;uCACY;;IAER,gBAAGwjB,MAAMC,KAAT,EAAgB;IACZ,oBAAIllB,MAAM,KAAK0qB,qBAAL,EAAV;IACA;IACA1qB,oBAAIya,MAAJ,GAAa,KAAKiK,YAAL,CAAkBb,KAAlB,CAAwB,CAAxB,CAAb;IACA;IACH;IACJ;;;yCAEa;IACV;IACA;IACA;IACA;IACA;IACA;IACA;;IAEJ;;;;;MApzCsBN;;ICjD1B,IAAI+I,QAAQ,EAAZ;;AAEA,qBAAe;;IAEX1hB,SAAK,aAAS3I,GAAT,EAAc;IACf,YAAGA,OAAOqqB,MAAMrqB,GAAN,CAAV,EACI,OAAOqqB,MAAMrqB,GAAN,CAAP;;IAEJ,YAAIsqB,WAAW,IAAIvI,WAAJ,CAAgB/hB,GAAhB,CAAf;IACAqqB,cAAMC,SAAS9Y,IAAf,IAAuB8Y,QAAvB;IACA,eAAOA,QAAP;IACH,KATU;;IAWXC,aAAS,iBAASvqB,GAAT,EAAc;IACnB,YAAGA,GAAH,EAAQ;IACJqqB,kBAAMrqB,GAAN,EAAWuqB,OAAX;IACA,mBAAOF,MAAMrqB,GAAN,CAAP;IACH,SAHD,MAGO;IACHqqB,oBAAQ,IAAR;IACH;IACJ;IAlBU,CAAf;;IC8BA,IAAG,OAAOjM,MAAM/e,SAAN,CAAgBuf,IAAvB,KAAiC,WAApC,EAAiD;IAC7CR,UAAM/e,SAAN,CAAgBuf,IAAhB,GAAuB,UAASvc,EAAT,EAAa;IAChC,YAAImoB,MAAM,IAAV;IAAA,YAAgBC,MAAMD,IAAIltB,MAA1B;IACA,aAAI,IAAIqO,IAAE,CAAV,EAAaA,IAAE8e,GAAf,EAAoB,EAAE9e,CAAtB,EAAyB;IACrB,gBAAI;IACAtJ,mBAAGmoB,IAAI7e,CAAJ,CAAH;IACH,aAFD,CAEE,OAAMjL,CAAN,EAAS;IACP,sBAAMA,CAAN;IACH;IACJ;IACJ,KATD;IAUH;;AAMD,gBAAe;;IAEX;IACA;IACA;IACA;IACA;IACA4Q,UAPW;;IASXoZ,kCATW;IAUXC,kCAVW;IAWXC,yCAXW;IAYXphB,sCAZW;IAaX2W,gCAbW;IAcXL,oCAdW;IAeX+K,yCAfW;IAgBX7W,gDAhBW;IAiBXmB,wCAjBW;IAkBXO,4BAlBW;IAmBX9H,8BAnBW;IAoBX7C,YApBW;IAqBXkN,YArBW;IAsBXhN,cAtBW;IAuBXwO,cAvBW;IAwBXzO,cAxBW;IAyBXsT,cAzBW;IA0BXuC,gCA1BW;IA2BXjX,YA3BW;IA4BXmY,4BA5BW;IA6BX+I,0BA7BW;IA8BXlK,uBA9BW;IA+BXmK,uCA/BW;IAgCXC;IAhCW,CAAf;;;;;;;;"}